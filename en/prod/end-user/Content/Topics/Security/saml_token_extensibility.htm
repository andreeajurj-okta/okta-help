<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_okta_html5_topnav_nav_poc" data-mc-search-type="Stem" data-mc-help-system-file-name="okta_help.xml" data-mc-path-to-help-system="../../../" data-mc-has-content-body="True" data-mc-conditions="Primary.review-only" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="">
    <!-- ******************************************************************************** -->
    <!-- IMPORTANT: replicate changes in this file to other master pages, as appropriate. -->
    <!-- ******************************************************************************** -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="robots" content="noindex, nofollow" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Okta SAML Token Extensibility</title>
        <meta charset="utf-8" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, height=device-height" />
        <!-- Google Tag Manager -->
        <script>
			/* <![CDATA[ */
			(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], 
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
			})(window,document,'script','dataLayer','GTM-KXMLV58');
			/* ]]> */
		</script>
        <!-- End Google Tag Manager -->
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/okta-main-nav-poc.css" rel="stylesheet" />
        <style>/*&lt;meta /&gt;*/

.button.expand-all-button
{
	-pie-background: url('../../../Skins/Default/Stylesheets/Images/expand.png') no-repeat center center, linear-gradient(#fff, #fff);
}

.button.previous-topic-button
{
	-pie-background: url('../../../Skins/Default/Stylesheets/Images/navigate-previous.png') no-repeat center center, linear-gradient(#fff, #fff);
}

.button.next-topic-button
{
	-pie-background: url('../../../Skins/Default/Stylesheets/Images/navigate-next.png') no-repeat center center, linear-gradient(#fff, #fff);
}

.button.collapse-all-button
{
	-pie-background: url('../../../Skins/Default/Stylesheets/Images/collapse.png') no-repeat center center, linear-gradient(#fff, #fff);
}

.needs-pie
{
	behavior: url('../../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <style>/*&lt;meta /&gt;*/

.button.previous-topic-button
{
	-pie-background: url('../../../Skins/Default/Stylesheets/Images/navigate-previous.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.next-topic-button
{
	-pie-background: url('../../../Skins/Default/Stylesheets/Images/navigate-next.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.needs-pie
{
	behavior: url('../../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/require.config.js" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/foundation.6.2.3_custom.js" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1024px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-dropdown" style="display:none;" id="#centralSmallScreen"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="https://support.okta.com/help/s/" alt="Okta"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="2" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                    <div class="central-dropdown" style="display:none;" id="#centralTop"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                    <div class="central-dropdown" style="display:none;"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <!-- Google Tag Manager (noscript) -->
                                    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KXMLV58" height="0" width="0" style="display:none;visibility:hidden"></iframe>
                                    </noscript>
                                    <!-- End Google Tag Manager (noscript) -->
                                    <!-- Coveo config parameters -->
                                    <div id="coveo_org_id" style="Display:None"><span class="okta-coveo-configOrgId">oktaproduction9ounvcxa</span>
                                    </div>
                                    <div id="coveo_rest_uri" style="Display:None"><span class="okta-coveo-configPlatformRestUri">https://platform.cloud.coveo.com/rest/search</span>
                                    </div>
                                    <div id="coveo_search_url" style="Display:None"><span class="okta-coveo-configSearchPageUrl">https://support.okta.com/help/s/global-search/%40uri</span>
                                    </div>
                                    <div id="coveo_token_url" style="Display:None"><span class="okta-coveo-configSearchTokenServiceUrl">https://support.okta.com/help/services/apexrest/PublicSearchToken?site=help</span>
                                    </div>
                                    <!-- End Coveo config parameters -->
                                    <!-- ************************* Coveo Search bar ************************************* -->
                                    <!-- set margin and size in /Content/Resources/Scripts/coveo-resources/css/Coveo.Okta.StandaloneSearchbox.min.css to make room for replacing Flare-generated top-nav with HTML code (see below)-->
                                    <div id="OLC_Coveo_Headline" class="coveo-headline-wrapper">
                                        <div class="slds-p-vertical_small">
                                            <!--Search Bar-->
                                            <div class="slds-grid slds-grid_align-center">
                                                <div id="customSelect" class="CoveoCustomSelect slds-float_right">
                                                </div>
                                                <div id="standaloneSearchbox">
                                                    <div class="CoveoAnalytics" data-search-hub="OktaCommunityFullSearch">
                                                    </div>
                                                    <div class="CoveoTab" data-id="Help" data-caption="Help" style="display:none">
                                                    </div>
                                                    <div class="CoveoSearchbox" data-enable-omnibox="true" data-enable-query-suggest-addon="true">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="replace_top_nav">
                                        <!--<div class="title-bar-layout outer-row">-->
                                        <!--<div class="navigation-wrapper nocontent">
					<ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="2" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True" data-mc-chunk="Data/Toc.xml">                               
						<li class="has-children" data-mc-id="0"><a href="javascript:void(0);">Documentation</a></li>
						<li data-mc-id="1"><a href="https://support.okta.com/help/s/documentation">Knowledge base</a></li>
						<li class="has-children" data-mc-id="2"><a href="javascript:void(0);">Community</a></li>
						<li class="has-children" data-mc-id="3"><a href="javascript:void(0);">Product</a></li>
						<li data-mc-id="4"><a href="https://www.okta.com/services/education-services/">Training</a></li>
					</ul>
				</div>-->
                                        <div class="navbar">
                                            <div class="dropdown">
                                                <button class="dropbtn">Documentation <i class="fa fa-caret-down"></i></button>
                                                <div class="dropdown-content">
                                                    <div>Release notes</div>
                                                    <div><a href="../../index.htm">Product documentation</a>
                                                    </div>
                                                    <div><a href="https://developer.okta.com/documentation">Developer documentation</a>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="dropdown"><a href="https://support.okta.com/help/s/knowledge">Knowledge base</a>
                                            </div>
                                            <div class="dropdown">
                                                <button class="dropbtn">Community <i class="fa fa-caret-down"></i></button>
                                                <div class="dropdown-content">
                                                    <div><a href="https://support.okta.com/help/s/questions" target="_blank">Discussions</a>
                                                    </div>
                                                    <div><a href="https://support.okta.com/help/s/group/CollaborationGroup/00BF00000071aM5MAI" target="_blank">Groups</a>
                                                    </div>
                                                    <div><a href="https://support.okta.com/help/s/events" target="_blank">Events</a>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="dropdown">
                                                <button class="dropbtn">Product <i class="fa fa-caret-down"></i></button>
                                                <div class="dropdown-content">
                                                    <div><a href="https://support.okta.com/help/s/ideas" target="_blank">Ideas<img src="../../Resources/Images/okta-assets/external-link-icon.svg" style="margin-left: 8px;" /></a>
                                                    </div>
                                                    <div><a href="https://support.okta.com/help/s/productroadmap">Roadmap</a>
                                                    </div>
                                                    <div><a href="https://support.okta.com/help/s/betas" target="_blank">Betas<img src="../../Resources/Images/okta-assets/external-link-icon.svg" style="margin-left: 8px;" /></a>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="dropdown"><a href="https://www.okta.com/services/education-services/" target="_blank">Training<span><img src="../../Resources/Images/okta-assets/external-link-icon.svg" style="margin-left: 8px;" /></span></a>
                                            </div>
                                        </div>
                                        <div class="logo_container"><a class="logo" href="https://support.okta.com/help/s/"><img src="../../Resources/Images/okta-assets/Logo.png" alt="Okta Support" title="Okta Support" /></a>
                                        </div>
                                    </div>
                                    <!-- **********************  Main content row  ********************** -->
                                    <div class="okta-topics">
                                        <!-- *** Col1: Left Nav Col *** ****commented out, with new left accordion implementation***-->
                                        <!--<div class="is-not-in-mobile">
                <MadCap:menuProxy data-mc-skin="/Project/Skins/okta-left-menu.flskn" mc-linked-toc="/Project/TOCs/left-nav-TOC.fltoc" style="mc-toc-depth: 2;mc-context-sensitive: False;mc-include-parent: True;mc-include-siblings: True;mc-include-children: True;" />
            </div>-->
                                        <!-- *** Col1: Body Col *** -->
                                        <div>
                                            <div class="is-not-in-mobile">
                                                <!-- Breadcrumbs -->
                                            </div>
                                            <div class="toolbar-main">
                                                <!-- Expand/Collapse All for drop-downs, next/prev buttons -->
                                                <div class="buttons popup-container clearfix topicToolbarProxy _Skins_okta_toolbar_nav_poc mc-component nocontent" style="mc-topic-toolbar-items: ;">
                                                    <div class="button-group-container-left">
                                                        <button class="button needs-pie expand-all-button" data-state1-class="expand-all-button" data-state2-class="collapse-all-button" data-state2-title="Collapse all" title="Expand all" data-state1-title="Expand all">
                                                            <img alt="Expand all" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" class="invisible-label" />
                                                        </button>
                                                        <button class="button needs-pie previous-topic-button" title="Previous topic">
                                                            <img alt="Navigate previous" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" class="invisible-label" />
                                                        </button>
                                                        <button class="button needs-pie next-topic-button" title="Next topic">
                                                            <img alt="Navigate next" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" class="invisible-label" />
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="body-main">
                                                <!-- Main content body -->
                                                <div role="main" id="mc-main-content">
                                                    <p class="beta">This is a Beta feature. To see about participating in this Beta program, please refer to the <a href="https://support.okta.com/help/s/betas">Beta Programs page</a>.</p>
                                                    <h1>Okta SAML Token Extensibility</h1>
                                                    <p><b>Important:</b> The released feature may not have the same interfaces, data structures, or limitations as this beta version. Do not use this version in production applications or environments at this time.</p>
                                                    <p>All questions, comments, and concerns should be directed to John Gronberg - <a href="mailto:john.gronberg@okta.com">john.gronberg@okta.com</a>. In addition, all feedback is appreciated. If you have an Okta CSM, include the CSM on the message. Please do not contact Okta Support; the support team does not support beta programs.</p>
                                                    <p>The feedback period for this beta version is expected to end November 2018. Okta appreciates your timely feedback!</p>
                                                    <h2> Functionality</h2>
                                                    <p>This beta version is the first use case built on top of Okta’s extensibility platform, using <em>Callbacks</em>. Callbacks are HTTP POST requests triggered by events in Okta, such as authentication. This allows your application or service to modify the action Okta will take based on the response.</p>
                                                    <p>For this beta, the triggering event is the creation of a SAML assertion, and in the response from an external service, Okta can add to the contents of that assertion to include new attributes.</p>
                                                    <p>As an application developer, this feature allows your Okta-external system to augment SAML assertions dynamically before they are signed and returned to the application. This enables you to pass complex, dynamic, or even sensitive data to an application without storing it in Okta.</p>
                                                    <p>For example, SAML token extensibility could be used for a medical records application where the SAML assertion needs to include identifiers for a doctor’s patients. Instead of storing this dynamic and potentially sensitive data with the doctor’s record in Okta’s Universal Directory, the identifiers can be retrieved as the application supports the doctor throughout their day. Check out this demo video: <a href="https://vimeo.com/286624339" target="_blank">https://vimeo.com/286624339</a> for an example SAML app receiving a callback from an AWS Lambda.</p>
                                                    <p>
                                                    </p>
                                                    <h2>Limitations</h2>
                                                    <p>This beta is limited to adding new SAML attributes to SAML assertions. It </p>
                                                    <ul>
                                                        <li value="1">Does NOT support OpenID Connect (coming soon, in another beta)</li>
                                                        <li value="2">Does NOT support changing the subject statement</li>
                                                        <li value="3">Does NOT support overwriting an existing SAML attribute that would be included in the assertion</li>
                                                        <li value="4">Does NOT support App User or Okta User augmentation</li>
                                                    </ul>
                                                    <p>In addition to the caveats list above, this beta has the following limitations</p>
                                                    <h2>Step-by-step Configuration Guide</h2>
                                                    <p>There are seven parts to the configuration, including prerequisites and testing. Answers to frequently asked questions are also provided.</p>
                                                    <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="#" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage" aria-expanded="false"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" /></a><a name="Part"></a><a href="#" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_" aria-expanded="false"> Part 1 – Prerequisites</a></span>
                                                        <div class="MCDropDownBody dropDownBody">
                                                            <p>To use this beta version, make sure the following items are in place.</p>
                                                            <ol>
                                                                <li value="1">
                                                                    <p>Admin access to an Okta organization</p>
                                                                    <p>You can sign up for a developer org at <a href="https://developer.okta.com/signup/">https://developer.okta.com/signup/</a>, if you don't have one.</p>
                                                                </li>
                                                                <li value="2">
                                                                    <p>A custom SAML app</p>
                                                                    <ul>
                                                                        <li value="1">
                                                                            <p>Use the simple saml sp if you need a sample app: <a href="https://github.com/mcguinness/saml-sp">https://github.com/mcguinness/saml-sp</a></p>
                                                                        </li>
                                                                        <li value="2">
                                                                            <p>The app must be configured in your Okta org. For setup information, see <a href="https://developer.okta.com/standards/SAML/setting_up_a_saml_application_in_okta">https://developer.okta.com/standards/SAML/setting_up_a_saml_application_in_okta</a>.</p>
                                                                        </li>
                                                                    </ul>
                                                                </li>
                                                                <li value="3">
                                                                    <p>The <b>SAML_EXTENSIBILITY</b> and <b>CALLBACKS</b> feature flags</p>
                                                                    <p>Contact your CSM or <a href="mailto:john.gronberg@okta.com">john.gronberg@okta.com</a> to get these flags assigned. Note that the Okta Support Team is not authorized to set up or support beta features.</p>
                                                                </li>
                                                                <li value="4">
                                                                    <p>External service accessible to the internet</p>
                                                                    <ul>
                                                                        <li value="1">The service must be able to respond to an Okta callback request using the Okta callback response pattern</li>
                                                                        <li value="2">Okta can authenticate to the service using an API key in an authorization header</li>
                                                                        <li value="3">An example is provided below using AWS API Gateway</li>
                                                                    </ul>
                                                                    <p>&#160;</p>
                                                                </li>
                                                            </ol>
                                                        </div>
                                                    </div>
                                                    <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="#" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage" aria-expanded="false"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" /></a><a name="Part3"></a><a href="#" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_" aria-expanded="false"> Part 3 – Create External Service</a></span>
                                                        <div class="MCDropDownBody dropDownBody">
                                                            <p>You will need an internet accessible service that can respond to an HTTP POST request with a JSON document describing the information to add to the assertion. </p>
                                                            <h4>Callback Request</h4>
                                                            <p>The callback request will contain information about the original authentication request, the event time, the session, user, authentication, and the SAML assertion that will be generated including its existing claims. The callback request will contain the SAML assertion Okta will return to the app (SP). The AttributeStatement in the assertion is represented as the <code style="font-size: 11pt;">claim</code> JSON object in the request. Here is an example:</p>
                                                            <p><a href="https://gist.github.com/johngronberg-okta/fe951ee07efd00e5af8c06fcc9e32d3c">https://gist.github.com/johngronberg-okta/fe951ee07efd00e5af8c06fcc9e32d3c</a>
                                                            </p>
                                                            <h4>Claim object</h4>
                                                            <p>This is one of the critical components of the callback requests, as it will inform you of the AttributeStatement Okta will include in the SAML assertion. Your callback response can add new attributes to this statement. The claim object represents the AttributeStatement SAML object. Each property represents an Attribute SAML object:</p>
                                                            <ul>
                                                                <li value="1">The property name is the value of the Name attribute of the Attribute SAML object;</li>
                                                                <li value="2">The property value contains all other attributes of the SAML object, as well as the AttributeValues child elements</li>
                                                            </ul>
                                                            <p>For example, the following Attribute SAML object:</p>
                                                            <p><pre xml:space="preserve">
{

&lt;saml:Attribute Name="uid" 
NameFormat="urn:oasis:names:tc:SAML:2.0:attrname-format:basic"&gt;  
  &lt;saml:AttributeValue xsi:type="xs:string"&gt;test&lt;/saml:AttributeValue&gt;&gt;
&lt;/saml:Attribute&gt;

}
</pre>
                                                            </p>
                                                            <p>is translated to:</p>
                                                            <p><pre>
"uid":{ // value of Name attribute for saml:Attribute object
   "attributes":{  // name-value pairs for other attributes of saml:Attribute object
      "NameFormat":"urn:oasis:names:tc:SAML:2.0:attrname-format:basic"
   },
   "attributeValues":[  // array of saml:AttributeValue objects
      {  
         "attributes":{  // name-value pairs for attributes of saml:AttributeValue object
            "xsi:type":"xs:string"
         },
         "value":"test"  // value of saml:AttributeValue object
      }
   ]
}						
</pre>
                                                            </p>
                                                            <h4>Callback Request Example</h4>
                                                            <p><pre style="font-size: 10pt;" xml:space="preserve">

{
    "eventTypeVersion": "1.0",
    "cloudEventVersion": "0.1",
    "contentType": "application/json",
    "eventType": "com.okta.tokens.transform",
    "source": "http://oauth.okta1.com:1802/app/oauth_samlsp_1/exk2i7aJ1R9v631PM0g4/sso/saml", // the SAML IDP URL generates the assertion
    "eventId": "IxyGfzHoQOKmtVUgEXwOoA",
    "eventTime": "2018-06-26T22:26:07.000Z",
    "data": {
        "context": {
            // information about the original HTTP request
            "request": {
                "id": "reqLmhh_4uUTGG2QxwSfqFQtw",
                "method": "GET",
                "url": {
                    "value": "http://oauth.okta1.com:1802/app/oauth_samlsp_1/exk2i7aJ1R9v631PM0g4/sso/saml"
                },
                "ipAddress": "127.0.0.1"
            },
            // information about the session, please refer to 
            // https://developer.okta.com/docs/api/resources/sessions#session-properties
            "session": {
                "id": "102Cwvn6kJASAulhAwgLdlVag",
                "userId": "00u12j7vjWt0T9um60g4",
                "login": "admin@test.com",
                "createdAt": "2018-06-26T22:15:25.000Z",
                "expiresAt": "2018-06-27T00:26:07.000Z",
                "status": "ACTIVE",
                "lastPasswordVerification": "2018-06-26T22:15:25.000Z",
                "amr": [
                    "PASSWORD"
                ],
                "idp": {
                    "id": "00o12ich7X7pNrCO70g4",
                    "type": "OKTA"
                },
                "mfaActive": false
            },
            // information about the user, please refer to 
https://    // developer.okta.com/docs/api/resources/authn#user-object
            "user": {
                "id": "00u12j7vjWt0T9um60g4",
                "passwordChanged": "2018-05-03T20:01:35.000Z",
                "profile": {
                    "login": "admin@test.com",
                    "firstName": "admin",
                    "lastName": "oauth",
                    "locale": "en",
                    "timeZone": "America/Los_Angeles"
                },
                "_links": {
                    "groups": {
                        "href": "http://oauth.okta1.com:1802/00u12j7vjWt0T9um60g4/groups"
                    },
                    "factors": {
                        "href": "http://oauth.okta1.com:1802/api/v1/users/00u12j7vjWt0T9um60g4/factors"
                    }
                }
            },
            // information about the authentication protocol, please refer to 
            // https://developer.okta.com/docs/api/resources/authn#authentication-object
            "authentication": {
                // the SAML authn request
                "request": {
                    "id": "_1cf5518445236d11eae4",
                    "version": "2.0",
                    "issuerInstant": "2018-06-26T22:26:06.000Z",
                    "destination": "http://oauth.okta1.com:1802/app/oauth_samlsp_1/exk2i7aJ1R9v631PM0g4/sso/saml",
                    "providerName": "Simple SAML Service Provider",
                    "forceAuthn": false,
                    "passive": false,
                    "issuer": "urn:example:sp",
                    "assertionConsumerServiceURL": "http://localhost:7070/saml/sso",
                    "protocolBinding": "urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect",
                    "nameIdPolicy": {
                        "format": "urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress",
                        "allowCreate": true
                    },
                    "requestedAuthnContext": {
                        "comparison": "exact",
                        "authnContextClassRefs": [
                            "urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport"
                        ]
                    }
                },
                "protocol": "SAML2.0",
                "issuer": {
                    "id": "0oa2i7brpuFcaE81T0g4",
                    "name": "SAML SP",
                    "uri": "http://www.okta.com/exk2i7aJ1R9v631PM0g4"
                }
            }
        },
        "tokens": {
            // the SAML assertion will be returned to the SP
            "assertion": {
                "subject": {
                    "nameId": "admin@test.com",
                    "format": "urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified",
                    "confirmation": {
                        "method": "urn:oasis:names:tc:SAML:2.0:cm:bearer",
                        "data": {
                            "inResponseTo": "_1cf5518445236d11eae4",
                            "recipient": "http://localhost:7070/saml/sso"
                        }
                    }
                },
                "authentication": {
                    "sessionIndex": "_1cf5518445236d11eae4",
                    "authnContext": {
                        "authnContextClassRef": "urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport"
                    }
                },
                "conditions": {
                    "audienceRestrictions": [
                        "urn:example:sp"
                    ]
                },
                // the AttributeStatement
                "claims": {
                    "email": {
                        "attributes": {
                            "NameFormat": "urn:oasis:names:tc:SAML:2.0:attrname-format:unspecified"
                        },
                        "attributeValues": [
                            {
                                "attributes": {
                                    "xsi:type": "xs:string"
                                },
                                "value": "admin@test.com"
                            }
                        ]
                    },
                    "trust-groups": {
                        "attributes": {
                            "NameFormat": "urn:oasis:names:tc:SAML:2.0:attrname-format:unspecified"
                        },
                        "attributeValues": [
                            {
                                "attributes": {
                                    "xsi:type": "xs:string"
                                },
                                "value": "Groups.contains(\"0oa2yp4BGz8oSYxjM0g4\", \"Admin\", 100)"
                            }
                        ]
                    },
                    "filtered-groups": {
                        "attributes": {
                            "NameFormat": "urn:oasis:names:tc:SAML:2.0:attrname-format:unspecified"
                        },
                        "attributeValues": [
                            {
                                "attributes": {
                                    "xsi:type": "xs:string"
                                },
                                "value": ""
                            }
                        ]
                    }
                },
                "lifetime": {
                    "expiration": 300 // SAML assertion returned to SP will be valid for 300 seconds
                }
            }
        }
    }
}

</pre>
                                                            </p>
                                                            <h4>Callback Response</h4>
                                                            <p>To add information to the pending SAML assertion:</p>
                                                            <ul>
                                                                <li value="1">Return HTTP status code `200 OK`</li>
                                                                <li value="2">The response should follow the example below, including “result”: “SUCCESS”</li>
                                                                <li value="3">n array of commands and operations to update the SAML Assertion</li>
                                                            </ul>
                                                            <p>Currently, the only supported command is <code style="font-size: 10pt;">"com.okta.tokens.assertion.patch"</code> and the only supported operation for Beta is <code style="font-size: 11pt;">"op”: “add”</code> which will add a new attribute. If the command attempts to add an attribute which already exists in Okta, it will be silently dropped. Only new attributes can be added; existing attributes cannot be overwritten.</p>
                                                            <p>Further, since these additional attributes are not logged in the Okta System Log, you can optionally include debug information as <code style="font-size: 11pt;">debugContext</code> with a series of key value pairs. This data will be stored into the Okta System Log and should never include sensitive data.</p>
                                                            <h4>Callback Response Example</h4>
                                                            <p>This response returns a <code style="font-size: 11pt;">“SUCCESS”</code> and performs an add operation to patch the <code style="font-size: 11pt;">/claims/externalData</code> path with a SAML attribute value of <code style="font-size: 11pt;">NOT_STORED_IN_OKTA</code>. This data will be stamped into the XML of the SAML assertion generated by Okta and passed to the downstream SAML app.</p>
                                                            <p><pre style="font-size: 11pt;">				
{
  "result": "SUCCESS",  //SUCCESS must be included
    "commands": [{
      "type": "com.okta.tokens.assertion.patch",
      "value": [{
        "op": "add",
        "path": "/claims/externalData", // your claim name
        "value": {
          "attributes": {
            "NameFormat": "urn:oasis:names:tc:SAML:2.0:attrname-format:basic"
          },
          "attributeValues": [{
            "attributes": {
              "xsi:type": "xs:string"
            },
            "value": "NOT_STORED_IN_OKTA" // your claim value
          }]
        }
      }]
    }],
    "debugContext": {
      "stuff": "hitTheFan"
    }
  };				
				
				
</pre>
                                                            </p>
                                                            <p>The resulting SAML attribute is:</p>
                                                            <p><pre>				
{
  "result": "SUCCESS",  //SUCCESS must be included
    "commands": [{
      "type": "com.okta.tokens.assertion.patch",
      "value": [{
        "op": "add",
        "path": "/claims/externalData", // your claim name
        "value": {
          "attributes": {
            "NameFormat": "urn:oasis:names:tc:SAML:2.0:attrname-format:basic"
          },
          "attributeValues": [{
            "attributes": {
              "xsi:type": "xs:string"
            },
            "value": "NOT_STORED_IN_OKTA" // your claim value
          }]
        }
      }]
    }],
    "debugContext": {
      "stuff": "hitTheFan"
    }
  };
				
				
				
</pre>
                                                            </p>
                                                        </div>
                                                    </div>
                                                    <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="#" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage" aria-expanded="false"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" /></a><a name="Part4"></a><a href="#" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_" aria-expanded="false"> Part 4 – Example</a></span>
                                                        <div class="MCDropDownBody dropDownBody">
                                                            <p>In this example, there isan AWS API Gateway endpoint that invokes a Lambda function when it receives a POST. The Lambda generates the response to return to Okta. Here is a cloud formation template that will configure your gateway and a lambda to provide a response to Okta’s request: <a href="https://github.com/omgitstom/cloudformation/blob/master/saml_extension_callback.yaml">https://github.com/omgitstom/cloudformation/blob/master/saml_extension_callback.yaml </a></p>
                                                            <p>This template does the following:</p>
                                                            <ol>
                                                                <li value="1">Configure an API Gateway Endpoint called ‘Commands’</li>
                                                                <li value="2">Create an AWS Lambda called ‘Commands’ to generate a response</li>
                                                                <li value="3">Associate the Lambda with the Gateway Endpoint</li>
                                                                <li value="4">Add cloudwatch logging</li>
                                                                <li value="5">Assign the appropriate roles to orchestrate the flow</li>
                                                            </ol>
                                                            <p>Create the Callback Using the URL for your External Service</p>
                                                            <p>This example posts to Callbacks API. Details on this API can be found at:</p>
                                                            <p><a href="https://gist.github.com/alandry-okta/7c80ebe1a99982dfebf54a5fffc85a7d#callback-model">https://gist.github.com/alandry-okta/7c80ebe1a99982dfebf54a5fffc85a7d#callback-model</a>
                                                            </p>
                                                            <h4>Request</h4>
                                                            <p>POST to <code style="font-size: 11pt;">&lt;orgUrl&gt;/api/v1/callbacks/</code></p>
                                                            <p><pre>
{
    "status" : "ACTIVE",
    "name" : "My Callback",
    "type" : "com.okta.tokens.transform",
    "version" : "1.0.0",
    "channel" : {      
        "type" : "HTTP",
        "version" : "1.0.0",
        "config" : {
            "uri" : 
 "https://&lt;your-api-gateway-subdomain&gt;.us-west-2.amazonaws.com/LATEST/commands",  
            "method" : "POST",
            "authScheme" : {
                "type" : "HEADER",
                "key" : "Authorization",
                "value" : "some-api-key"
            }
        }
    }
}
													
</pre>
                                                            </p>
                                                            <p><b>Note:</b> The “name” value will be shown in the Okta Admin UI when selecting a callback to associate with an application. The name must be unique within your Okta org.</p>
                                                            <p>The “uri” value is the endpoint that Okta should POST to for the callback request. If you’re using the AWS API Gateway/Lamb</p>
                                                            <p>&#160;</p>
                                                            <p>Associate callback with SAML app</p>
                                                            <p>Navigate to your SAML application in the Okta admin UI. Click ‘edit’ and go to the settings step. Under advanced settings, you’ll find the “Assertion Callback” dropdown. Click on this and select the callback you created in step 2. In the UI, callbacks will be listed by their name. This can also be completed by updating the App through the API.</p>
                                                            <p>
                                                            </p>
                                                            <p>&#160;</p>
                                                            <p>&#160;</p>
                                                        </div>
                                                    </div>
                                                    <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="#" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage" aria-expanded="false"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" /></a><a name="Part5"></a><a href="#" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_" aria-expanded="false"> Part 5 – Test the Callback</a></span>
                                                        <div class="MCDropDownBody dropDownBody">
                                                            <p>Navigate to the General tab for your SAML app and scroll down to the app embed link. That link should look like:</p>
                                                            <p><code style="font-size: 11pt;">https://&lt;orgname&gt;.oktapreview.com/home/orgexample_samplesamlapp_1/0oad5dag79eJrqajW0h7/alnd5dcfniHGb6CWc0h7</code> </p>
                                                            <p>Paste the link in a new browser tab. For an existing SAML application, you can use a <a href="https://chrome.google.com/webstore/detail/saml-message-decoder/mpabchoaimgbdbbjjieoaeiibojelbhm">SAML Tracer Extension</a>, or if you want to use a sample app, you can try the <a href="https://github.com/mcguinness/saml-sp">simple SAML sp</a>, which will display an easy to read version of your SAML assertion. After you authenticate and get the SAML assertion, review it to ensure your data was added.</p>
                                                            <p>In the example below, <code style="font-size: 11pt;">externalData</code> was added by the external service.</p>
                                                            <p> </p>
                                                            <p>&#160;</p>
                                                        </div>
                                                    </div>
                                                    <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="#" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage" aria-expanded="false"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" /></a><a name="Part6"></a><a href="#" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_" aria-expanded="false">Part 6 – Frequently Asked Questions</a></span>
                                                        <div class="MCDropDownBody dropDownBody">
                                                            <ol>
                                                                <li value="1">
                                                                    <p>What happens if the callback includes a SAML attribute that already exists in Okta?</p>
                                                                    <p>The service-defined attribute is ignored in favor of the Okta-defined attribute.</p>
                                                                </li>
                                                                <li value="2">
                                                                    <p>Whom should I contact with feedback?</p>
                                                                    <p>You may email <a href="mailto:john.gronberg@okta.com">john.gronberg@okta.com</a>. If you have an Okta CSM, include the CSM on the message.</p>
                                                                    <p><b>Note:</b> The Support Team does not support Beta programs.</p>
                                                                </li>
                                                            </ol>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- Back to Top button --><a href="#" class="sf-back-to-top"><span class="arrow"></span>Top</a>
                                            </div>
                                        </div>
                                        <!-- *** Col2: Right menu Col ***  ****commented out temporarily until redesign for "on this page" implementation, redundant to new left accordion implementation***-->
                                        <!--<div class="is-not-in-mobile">
                <MadCap:menuProxy data-mc-skin="/Project/Skins/okta-right-menu.flskn" mc-linked-toc="/Project/TOCs/okta-TOC.fltoc" style="mc-context-sensitive: True;mc-include-parent: True;mc-include-siblings: False;mc-include-children: True;" />
            </div>-->
                                    </div>
                                    <div class="toolbar-bottom">
                                        <!-- Expand/Collapse All for drop-downs -->
                                        <div class="buttons popup-container clearfix topicToolbarProxy _Skins_okta_toolbar_no_expand mc-component nocontent" style="mc-topic-toolbar-items: ;">
                                            <div class="button-group-container-left">
                                                <button class="button needs-pie previous-topic-button" title="Previous topic">
                                                    <img alt="Navigate previous" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" class="invisible-label" />
                                                </button>
                                                <button class="button needs-pie next-topic-button" title="Next topic">
                                                    <img alt="Navigate next" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" class="invisible-label" />
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- ***************************** Footer rows ********************************* -->
                                    <!--         <div class="footer2">
            <div>
                <ul>
                    <li><a href="https://fulluat-okta.cs67.force.com/help/s/article/Okta-Community-FAQs">Community FAQ</a>
                    </li>
                    <li><a href="https://support.okta.com/help/s/article/Okta-Community-Terms-and-Conditions">Terms &amp; Conditions</a>
                    </li>
                    <li>Trust</li>
                    <li><a href="https://www.okta.com/contact/">Contact</a>
                    </li>
                    <li>Feedback</li>
                </ul>
            </div>
            <div>
                <p class="try-okta-button"><a role="button" href="https://www.okta.com/free-trial/">Try Okta For Free</a>
                </p>
            </div>
        </div> -->
                                    <div class="footer2">
                                        <div>
                                            <p class="copyright">©  <span class="okta-variablesYear">2020</span> <span class="okta-variablesCompanyName">Okta, Inc</span> All Rights Reserved. Various trademarks held by their respective owners.</p>
                                        </div>
                                        <!--             <div>
                <ul>
                    <li><a href="https://twitter.com/okta"><img src="../Images/okta-assets/twitter.png" /></a>
                    </li>
                    <li><a href="https://www.facebook.com/OktaIdentity"><img src="../Images/okta-assets/facebook.png" /></a>
                    </li>
                    <li><a href="https://www.linkedin.com/company/okta-inc-/"><img src="../Images/okta-assets/linkedin.png" /></a>
                    </li>
                    <li><a href="https://www.youtube.com/user/OktaInc"><img src="../Images/okta-assets/youtube.png" /></a>
                    </li>
                    <li><a href="https://www.okta.com"><img src="../Images/okta-assets/okta.png" /></a>
                    </li>
                </ul>
            </div> -->
                                    </div>
                                    <!-- Qualtrics setup to use with script below, replacing getfeedback -->
                                    <div id="ZN_6fGBJ8J3VcIBymN">
                                        <!--DO NOT REMOVE-CONTENTS PLACED HERE-->
                                    </div>
                                    <!-- ***************************** Scripts ************************************* -->
                                    <!-- Foundation -->
                                    <script src="../../Resources/Scripts/js/app.js">
                                    </script>
                                    <script src="../../Resources/Scripts/js/vendor/what-input.js">
                                    </script>
                                    <script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/6.4.4-rc1/js/foundation.min.js">
                                    </script>
                                    <!-- Ours -->
                                    <script type="text/javascript" src="../../Resources/Scripts/back-to-top.js">
                                    </script>
                                    <!--         <script type="text/javascript" src="../Scripts/get-feedback.js">
        </script> -->
                                    <script type="text/javascript" src="../../Resources/Scripts/js/vendor/qualtrics.js">
                                    </script>
                                    <!-- Coveo -->
                                    <script src="https://static.cloud.coveo.com/searchui/v2.5395/js/CoveoJsSearch.Lazy.min.js" defer="defer">
                                    </script>
                                    <script src="../../Resources/Scripts/coveo-resources/js/cultures/en.js" id="coveoCultureScript" defer="defer">
                                    </script>
                                    <script src="../../Resources/Scripts/coveo-resources/js/Coveo.MadcapFlare.RequireJS.js" id="coveoRequireScript" defer="defer">
                                    </script>
                                    <script src="../../Resources/Scripts/coveo-resources/js/Coveo.MadcapFlare.Okta.js" id="coveoInitscript" defer="defer">
                                    </script>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>