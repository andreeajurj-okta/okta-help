<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_okta_html5_topnav" data-mc-search-type="Stem" data-mc-help-system-file-name="okta_help.xml" data-mc-path-to-help-system="../../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="typeofcontent" content="documentation" />
        <meta name="audience" content="admin" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Configure High Availability | Okta</title>
        <meta charset="utf-8" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, height=device-height" />
        <link rel="shortcut icon" href="../../Resources/Images/favicon.ico" type="image/x-icon" />
        <!-- Google Tag Manager -->
        <script>
			/* <![CDATA[ */
			(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], 
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
			})(window,document,'script','dataLayer','GTM-TJ45R6');
			/* ]]> */
		</script>
        <!-- End Google Tag Manager -->
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/okta-main.css" rel="stylesheet" />
        <link href="https://static.cloud.coveo.com/searchui/v2.5395/css/CoveoFullSearchNewDesign.css" rel="stylesheet" />
        <style>/*&lt;meta /&gt;*/

.button.expand-all-button
{
	-pie-background: url('../../../Skins/Default/Stylesheets/Images/expand-all-non-hover-sm.png') no-repeat center center, linear-gradient(#fff, #fff);
}

.button.collapse-all-button
{
	-pie-background: url('../../../Skins/Default/Stylesheets/Images/collapse-all-non-hover-sm.png') no-repeat center center, linear-gradient(#fff, #fff);
}

.needs-pie
{
	behavior: url('../../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/foundation.6.2.3_custom.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="small" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="https://support.okta.com/help/s/" alt="Okta"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="2" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <main id="main" class="body-container">
                                <div data-mc-content-body="True">
                                    <!-- Google Tag Manager (noscript) -->
                                    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TJ45R6" height="0" width="0" style="display:none;visibility:hidden"></iframe>
                                    </noscript>
                                    <!-- End Google Tag Manager (noscript) -->
                                    <!-- Coveo config parameters -->
                                    <div id="coveo_org_id" style="Display:None"><span class="okta-coveo-configOrgId">oktaproduction9ounvcxa</span>
                                    </div>
                                    <div id="coveo_rest_uri" style="Display:None"><span class="okta-coveo-configPlatformRestUri">https://platform.cloud.coveo.com/rest/search</span>
                                    </div>
                                    <div id="coveo_search_url" style="Display:None"><span class="okta-coveo-configSearchPageUrl">https://support.okta.com/help/s/global-search/%40uri</span>
                                    </div>
                                    <div id="coveo_token_url" style="Display:None"><span class="okta-coveo-configSearchTokenServiceUrl">https://support.okta.com/help/services/apexrest/PublicSearchToken?site=help</span>
                                    </div>
                                    <!-- End Coveo config parameters -->
                                    <!-- ************************* Coveo Search bar ************************************* -->
                                    <div id="OLC_Coveo_Headline" class="coveo-headline-wrapper">
                                        <div class="slds-p-vertical_small">
                                            <!--Search Bar-->
                                            <div class="slds-grid slds-grid_align-center">
                                                <div id="customSelect" class="CoveoCustomSelect slds-float_right">
                                                </div>
                                                <div id="standaloneSearchbox">
                                                    <div class="CoveoAnalytics" data-search-hub="OktaCommunityFullSearch">
                                                    </div>
                                                    <div class="CoveoTab" data-id="Help" data-caption="Help" style="display:none">
                                                    </div>
                                                    <div class="CoveoSearchbox" data-enable-omnibox="true" data-enable-query-suggest-addon="true">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- **********************  Main content row  ********************** -->
                                    <div class="okta-topics">
                                        <!-- *** Col1: Left Nav Col *** -->
                                        <div class="is-not-in-mobile">
                                            <div data-sticky-container="" id="zweHQDPhLE-KSTFjpZmgXg">
                                                <div class="sticky sticky-menu" style="width:100%" data-sticky="" data-top-anchor="zweHQDPhLE-KSTFjpZmgXg:top" data-bottom-anchor="contentBody:bottom" data-sticky-on="small" data-scroll-container-on="small">
                                                    <ul class="nocontent menu _Skins_okta_left_menu mc-component" data-mc-linked-toc="Data/Tocs/left_nav_TOC.js" data-mc-side-menu="True" data-mc-max-depth="2" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- *** Col2: Body Col *** -->
                                        <div>
                                            <div class="is-not-in-mobile">
                                                <!-- Breadcrumbs -->
                                            </div>
                                            <div class="toolbar-main">
                                                <!-- Expand/Collapse All for drop-downs -->
                                                <div class="buttons popup-container clearfix topicToolbarProxy _Skins_okta_toolbar mc-component nocontent" style="mc-topic-toolbar-items: ;">
                                                    <div class="button-group-container-left">
                                                        <button class="button needs-pie expand-all-button" data-state1-class="expand-all-button" data-state2-class="collapse-all-button" data-state2-title="Collapse all" title="Expand all" data-state1-title="Expand all">
                                                            <img alt="Expand all" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" class="invisible-label" />
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="body-main">
                                                <!-- Main content body -->
                                                <h1>Configure High Availability</h1>
                                                <div>
                                                    <hr width="100%" size="0" align="center" />
                                                    <h2><a name="Overview"></a>Overview</h2>
                                                    <p><b>The purpose of guide is to describe Access Gateway high availability, including what it is, and how it is configured and managed. </b>
                                                    </p>
                                                </div>
                                                <div>
                                                    <hr width="100%" size="0" align="center" />
                                                    <h2><a name="What’s"></a>What’s covered in this guide</h2>
                                                    <ol>
                                                        <li value="1"><a href="#Concepts" class="MCXref xref">Concepts &amp;&#160;Architecture</a>
                                                        </li>
                                                        <li value="2"><a href="#ConfigureHA" class="MCXref xref">Configuring High Availability</a>
                                                            <ul>
                                                                <li value="1"><a href="#AddWorker" class="MCXref xref">Add a worker node to an Access Gateway&#160;Cluster</a>
                                                                </li>
                                                                <li value="2"><a href="#ListWorkers" class="MCXref xref">List all worker nodes in an Access Gateway Cluster</a>
                                                                </li>
                                                                <li value="3"><a href="#RemoveWorker" class="MCXref xref">Remove a worker node from an Access Gateway&#160;cluster</a>
                                                                </li>
                                                                <li value="4"><a href="#ResetKey" class="MCXref xref">Reset the key associated with an Access Gateway Node</a>
                                                                </li>
                                                            </ul>
                                                        </li>
                                                    </ol>
                                                </div>
                                                <hr width="100%" size="0" align="center" />
                                                <div>
                                                    <h2><a name="Concepts"></a>Concepts &amp;&#160;Architecture</h2>
                                                    <div>
                                                        <p>Access Gateway high availability consists of:

</p>
                                                        <ul>
                                                            <li value="1">A single administration instance of Access Gateway. The Administration instance, typically referred to as the <span class="disableGlossary">admin</span> node, is used to maintain and propagate configuration changes to worker instances. In addition the <a href="#" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">admin<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>An abbreviation of administrator. This is the individual(s) who have access to the Okta Administrator Dashboard. They control the provisioning and deprovisioning of end users, the assigning of apps, the resetting of passwords, and the overall end user experience. Only administrators have the Administration button on the upper right side of the My Applications page.</span></a> node can be used a normal Access Gateway instance. </li>
                                                            <li value="2">One or more worker instances, bound to the admin node, which service requests.</li>
                                                            <li value="3">A customer provided load balancer, routing requests to the Access Gateway High Availability&#160;cluster. </li>
                                                        </ul>
                                                        <p>Access Gateway high availability instance life-cycle overview:</p>
                                                        <ul>
                                                            <li value="1">An instance of Access Gateway is provisioned. This instance, referred to as the <i>Admin </i>node or instance is configured normally, including defining protected applications. Note that is not a requirement to configure applications or <a href="#" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">IDP<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>An acronym for Identity Provider. It is a service that manages end user accounts analogous to user directories such as LDAP and Active Directory, and can send SAML responses to SPs to authenticate end users. Within this scenario, the IdP is Okta.</span></a>&#160;support before configuring high availability. </li>
                                                            <li value="2">Second and subsequent instances of Access Gateway are provisioned. These instances, typically referred to as <i>Worker</i> nodes or instances are not configured with applications, but rather obtain all configuration from the Admin node.</li>
                                                            <li value="3">Worker nodes are then specifically configured to use the Admin node for all configuration. Once configured, worker nodes no longer surface the admin UI but can only be accessed using the command line interface.</li>
                                                        </ul>
                                                        <img src="../../Resources/Images/access-gateway/configure-high-availability.01_1200x1002.png" id="img_new" alt="Access Gateway High Availability architecture" style="width: 1200;height: 1002;" />
                                                    </div>
                                                </div>
                                                <div>
                                                    <hr width="100%" size="0" align="center" />
                                                    <h2><a name="ConfigureHA"></a>Configuring High Availability</h2>
                                                    <div>
                                                        <p>Configuring high availability includes the following overall process:</p>
                                                        <ol>
                                                            <li value="1">Configuring an Admin node.<br />During this step the Administration node is configured normally.</li>
                                                            <li value="2">Configuring a Worker node.<br />During this step worker nodes are configured without any applications. </li>
                                                            <li value="3">Preparing the Admin node.<br />During this step the command line interface is used on the Admin node to alert or <i>prepare</i> the admin node for the addition of one or more worker nodes. </li>
                                                            <li value="4">Preparing the worker node.<br />During this step the command line interface is used on the Worker not to prepare the worker to become part of the Access Gateway cluster.</li>
                                                            <li value="5">Worker integration into cluster.<br />After the prior two steps, the worker is automatically integrated into the cluster. During this phase the worker Admin UI is disabled and worker exchanges keys and is provided configuration from the Admin node.</li>
                                                        </ol>
                                                        <img src="../../Resources/Images/access-gateway/configure-high-availability.02.png" alt="Access Gateway High Availability add worker node sequence diagram" />
                                                    </div>
                                                    <p>&#160;</p>
                                                    <div>
                                                        <div>
                                                            <p>The following high availability management operations are supported:</p>
                                                            <ol>
                                                                <li value="1"><a href="#AddWorker" class="MCXref xref">Add a worker node to an Access Gateway&#160;Cluster</a>
                                                                </li>
                                                                <li value="2"><a href="#ListWorkers" class="MCXref xref">List all worker nodes in an Access Gateway Cluster</a>
                                                                </li>
                                                                <li value="3"><a href="#RemoveWorker" class="MCXref xref">Remove a worker node from an Access Gateway&#160;cluster</a>
                                                                </li>
                                                                <li value="4"><a href="#ResetKey" class="MCXref xref">Reset the key associated with an Access Gateway Node</a>
                                                                </li>
                                                                <li value="5"><a href="#CheckCluster" class="MCXref xref">Check Cluster Configuration</a>
                                                                </li>
                                                            </ol>
                                                            <p>&#160;</p>
                                                        </div>
                                                        <div>
                                                            <h3><a name="AddWorker"></a>Add a worker node to an Access Gateway&#160;Cluster</h3>
                                                            <div class="noteOkta">
                                                                <img src="../../Resources/Images/assets/Icons/Notes/Help.png" class="noteImgFloat" title="Info" alt="Info" />
                                                                <p class="noteHeading">Note</p>
                                                                <p class="noteContent">When adding a worker node, both the Administration node and the worker node: </p>
                                                                <ul>
                                                                    <li value="1">Must have been previously provisioned. </li>
                                                                    <li value="2">Must be reachable using SSH.</li>
                                                                    <li value="3">Must have had their keys reset. &#160;<br />See <a href="#ResetKey" class="MCXref xref">Reset the key associated with an Access Gateway Node</a> for more information on resetting keys. </li>
                                                                </ul>
                                                            </div>
                                                            <p><b>To add a worker node to a cluster:</b>
                                                            </p>
                                                            <ol>
                                                                <li value="1">
                                                                    <p>On the Admin node</p>
                                                                    <ol style="list-style-type: lower-alpha;">
                                                                        <li value="1">Connect to the instance.<br /><pre xml:space="preserve" id="code">ssh oag-mgmt@[admin.tld]</pre></li>
                                                                        <li value="2">Select <b>5 - System</b></li>
                                                                        <li value="3">Select <b>8- High Availability Configuration</b><br />The High Availability Configuration menu will display.<br /><pre xml:space="preserve" id="code">Access Gateway High Availability Setup <b style="text-decoration: none; font-style: italic;">(role)</b>
1 - Reset Key
2 - Prepare Admin
3 - Prepare Worker
4 - List Nodes
5 - Remove Node
6 - Check Status

X- Exit
Choice:&#160;</pre><br /><div class="noteOkta"><img src="../../Resources/Images/assets/Icons/Notes/Help.png" class="noteImgFloat" title="Info" alt="Info" /><p class="noteHeading">Note</p><p>The High Availability menu displays the current role of a Access Gateway node. <br />Roles can be:</p><ul><li value="1">Single - The node has not yet been configured as either a Worker or an Admin.</li><li value="2">Admin - The node has been configured as an administrator for High Availability.</li><li value="3">Worker - The node has been configured as a worker for High Availability).<br /></li></ul></div></li>
                                                                        <li value="4">Select <b>2 - Prepare Admin</b><br /><div class="noteOkta"><img src="../../Resources/Images/assets/Icons/Notes/Help.png" class="noteImgFloat" title="Info" alt="Info" /><p class="noteHeading">Note</p><p class="noteContent">The first time the Admin Node is configured for high availability option <b>1 - Reset Keys</b> should be executed to reset the instance's SSH keys. <br />Reset Keys need only be executed a single time per instance. See <a href="command-line-console-reference.htm" class="MCXref xref"> Command Line Management Console Reference</a> for complete details.<br /></p></div><div class="noteOkta"><img src="../../Resources/Images/assets/Icons/Notes/Help.png" class="noteImgFloat" title="Important Note" alt="Important Note" /><p class="noteHeading">Important</p><p class="noteContent">Access Gateway Replication users the hostname setting from the command line console.  <br />Please be sure to update the hostname for both Admin and Worker nodes using the command line console <b>System (5) &gt; Change Hostname (1)</b>.</p></div><p>. . . </p></li>
                                                                        <li value="5">The Admin node will go authorize worker mode and display an authorization code which must be provided to the Worker node. <br />Copy the authorization code shown in&#160;<i style="font-weight: bold;">bold italic</i> below.<br /><pre id="code">
Authorization token required to initiate setup from worker nodes is given
below. Copy the text below this line and paste it on worker node when prompted.
<b style="font-style: italic;">oag.okta.com:8ba1c123-715d-4b70-ab5d-0e41493bef73</b>
Worker nodes available so far:
. . . 
Press X to exit								</pre></li>
                                                                        <li value="6">Enter <b>X</b> to continue.  <br />The Admin node will wait for the worker node.</li>
                                                                        <li value="7">Return to the command prompt on the instance which is being attached as a worker node</li>
                                                                    </ol>
                                                                </li>
                                                                <li value="2">On the Worker node<ol style="list-style-type: lower-alpha;"><li value="1">Connect to the instance.<br /><pre xml:space="preserve" id="code">ssh oag-mgmt@[worker.tld]</pre></li><li value="2">Select <b>5 - System</b></li><li value="3">Select <b>8- High Availability Configuration</b><br />The HA Configuration menu will display.<br /></li><li value="4">Select <b>3 - Prepare Worker</b><br /><div class="noteOkta"><img src="../../Resources/Images/assets/Icons/Notes/Help.png" class="noteImgFloat" title="Info" alt="Info" /><p class="noteHeading">Note</p><p class="noteContent">The first time the worker Node is configured for high availability option <b>1 - Reset Keys</b> should be executed to reset the instance's SSH keys. <br />Reset Keys need only be executed a single time per instance. See <a href="command-line-console-reference.htm" class="MCXref xref"> Command Line Management Console Reference</a> for complete details.</p></div></li><li value="5">The worker will then display<br /><pre xml:space="preserve" id="code">
Checking HA readiness for host worker. . .   

NOTE: Please ensure that admin node is ready for setup and you have the
authorization token displayed on admin node.

Enter the authorization token displayed on admin node: <b style="font-style: italic;">admin.. . . .com:927da506-7efb-4520-bd32-dd03b86f2a9b
</b></pre><br />								Once entered the Worker node will then connect to the Admin node and exchange authorization and confirmation information resembling:<br /><pre xml:space="preserve" id="code">
Requesting admin  node <b style="font-style: italic;">admin. . . .com</b> to allow connection  
Node <b style="font-style: italic;">worker. . .com</b> successfully added on admin node
Synchronizing current configuration  
 
Press enter to continue ....
</pre></li><li value="6">When prompted press any key to continue.</li><li value="7">Enter <b>X</b> to exit or any other menu item to continue.<br /></li></ol><p>The worker instance is now configured and ready for use.</p></li>
                                                            </ol>
                                                            <p>On the Admin node:<br /></p>
                                                            <ol>
                                                                <li value="1">Return to the Admin instance.<br /></li>
                                                                <li value="2">Examine results of adding the new worker node which should resemble:<br /><pre xml:space="preserve" id="code">
Authorization token required to initiate setup from worker nodes is given
below. Copy the text below this line and paste it on worker node when prompted.

admin. . .com:927da506-7efb-4520-bd32-dd03b86f2a9b
Worker nodes available so far:
<b style="font-style: italic;">worker1. . .com</b>
<b style="font-style: italic;">worker2. . .com</b>
<b style="font-style: italic;">worker3. . .com</b></pre><br />Note the addition of the new worker node.<br /></li>
                                                                <li value="3">Enter <b>X</b> to exit or any other menu item to continue.<br /></li>
                                                            </ol>
                                                        </div>
                                                        <p>&#160;</p>
                                                        <div>
                                                            <h3><a name="ListWorkers"></a>List all worker nodes in an Access Gateway Cluster</h3>
                                                            <p><b>To list all currently enabled worker nodes:</b>
                                                            </p>
                                                            <ol>
                                                                <li value="1">Connect to the instance.<br /><pre xml:space="preserve" id="code">ssh oag-mgmt@[admin.tld]</pre></li>
                                                                <li value="2">Select <b>8- HA Configuration</b><br />The HA Configuration menu will display.<br /></li>
                                                                <li value="3">Select <b>4 - List</b> nodes</li>
                                                                <li value="4">A&#160;list of all currently enabled Worker nodes are displayed, which should resemble:<br /><pre id="code">
Admin Node:
admin. . .com

Worker Nodes:
worker1. . .com
. . . 
workern. . .com
Press enter to continue ....
</pre></li>
                                                                <li value="5">Enter X to exit or any other menu item to continue.<br /></li>
                                                            </ol>
                                                        </div>
                                                        <p>&#160;</p>
                                                        <div>
                                                            <h3><a name="RemoveWorker"></a>Remove a worker node from an Access Gateway&#160;cluster</h3>
                                                            <p><b>To remove an existing worker node from an Access Gateway cluster:</b>
                                                            </p>
                                                            <div class="noteOkta">
                                                                <img src="../../Resources/Images/assets/Icons/Notes/Help.png" class="noteImgFloat" title="Info" alt="Info" />
                                                                <p class="noteHeading">Note</p>
                                                                <p class="noteContent">When a worker node is removed from an Access Gateway cluster is still exists but no longer receives updates from the Admin instance. In addition the Access Gateway UI continues to be disabled. <br /><br />Nodes removed from the Access Gateway High availability cluster should be removed from any load balancer and otherwise decomissioned. <br />Once removed a worker node is no longer considered viable.<br /><br /></p>
                                                            </div>
                                                            <ol>
                                                                <li value="1">Connect to the instance.<br /><pre xml:space="preserve" id="code">ssh oag-mgmt@[admin.tld]</pre></li>
                                                                <li value="2">Select <b>5 - System</b></li>
                                                                <li value="3">Select <b>8- High Availability Configuration</b><br />The HA Configuration menu will display.<br /><pre xml:space="preserve" id="code">Access Gateway Services...
1 - Reset Key
2 - Prepare Admin
3 - Prepare Worker
4 - List Nodes
5 - Remove Node

X- Exit
Choice:&#160;</pre></li>
                                                                <li value="4">Select <b>5 - Remove</b> node</li>
                                                                <li value="5">From the list of known nodes, enter the name of the worker node to be removed and press enter.</li>
                                                                <li value="6">Confirm the removal of the node.</li>
                                                                <li value="7">Enter X to exit or any other menu item to continue.<br /></li>
                                                            </ol>
                                                        </div>
                                                        <p>&#160;</p>
                                                        <div>
                                                            <h3><a name="ResetKey"></a>Reset the key associated with an Access Gateway Node</h3>
                                                            <p>Access Gateway nodes use various keys to intercommunicate. &#160;Keys must be regenerated if an instance is to be used as part of a Access Gateway High Availability cluster. <br />Each instance need regenerate its keys only once.<br /></p>
                                                            <p><b>To reset a nodes keys:</b>
                                                            </p>
                                                            <ol>
                                                                <li value="1">Connect to the instance.<br /><pre xml:space="preserve" id="code">ssh oag-mgmt@[admin or worker]</pre></li>
                                                                <li value="2">Select <b>5 - System</b></li>
                                                                <li value="3">Select <b>8- High Availability Configuration</b><br />The High Availability Configuration menu will display.</li>
                                                                <li value="4">Select <b>1 - Reset Key</b> node.					
					
                    Confirm the key reset will be displayed.<br /><pre id="code">
This will reset keys being used by high availability sync process.
If high availability is already setup, this option should not be used.
Proceed with reset? [y/N]: </pre></li>
                                                                <li value="5">Enter <b>y</b> to reset or <b>N</b> to abort the reset process.<br />The reset of either abort, or display a success message.<br /></li>
                                                                <li value="6">Enter x to exit or any other menu item to continue.<br /></li>
                                                            </ol>
                                                        </div>
                                                        <p>&#160;</p>
                                                        <div>
                                                            <h3><a name="CheckCluster"></a>Check Cluster Configuration</h3>
                                                            <p>To review or check the status of an Access Gateway High Availability Cluster:</p>
                                                            <ol>
                                                                <li value="1">Connect to the instance.<br /><pre xml:space="preserve" id="code">ssh oag-mgmt@[admin or worker]</pre></li>
                                                                <li value="2">Select <b>5 - System</b></li>
                                                                <li value="3">Select <b>8- High Availability Configuration</b><br />The High Availability Configuration menu will display.</li>
                                                                <li value="4">Select <b>6 -Check&#160;Status </b>.					
					
          </li>
                                                                <li value="5">A list of cluster instances is displayed with their associated status.<br />Use the <b>Up/Down/Page Up/Page Down/Home/End</b> keys to scroll through the list. Which will resemble:
                    <br /><pre id="code"> 
HA Synch Status    Up/Down/Page Up/Page Down/Home/End - Scroll    x-exit
worker1.yourdoman.tld:    Pass
worker2.yourdoman.tld:    Pass
. . . 
workern.yourdoman.tld:    Fail										
					</pre>
					Where:
<br /><ul><li value="1"><b>Pass</b>: Reachable functioning worker node</li><li value="2"><b>Fail</b>: Non-functional worker.  See node log for details.</li></ul></li>
                                                                <li value="6">Enter <b>x</b> to exit.<br /></li>
                                                            </ol>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div>
                                                    <hr width="100%" size="0" align="center" />
                                                    <h2><a name="BestPractices"></a>Best Practices and Considerations</h2>
                                                    <p>The following are a list of best practices and considerations for configuring High Availability:</p>
                                                    <ul>
                                                        <li value="1">Before configuring a High Availability cluster, be sure to reset keys for all cluster members, including admin and worker instances, using <b>System &gt; High Availability &gt; Reset Keys.</b> </li>
                                                        <li value="2">Always ensure that new Access Gateway instances have set their hostname. Instances default to <span style="font-family: 'Courier New';">oag.okta.com</span> as hostname. Use the Access Gateway command line interface <b>System &gt; Hostname</b> command to change or verify the current hostname. </li>
                                                        <li value="3">When initially configuring an Access Gateway instance use the <b>System &gt;&#160;Reset</b> command to reset the instance to an initial state. </li>
                                                    </ul>
                                                    <p>See <a href="command-line-console-reference.htm" class="MCXref xref"> Command Line Management Console Reference</a> for complete details of all Access Gateway command line operations.</p>
                                                    <div class="noteOkta">
                                                        <img src="../../Resources/Images/assets/Icons/Notes/Help.png" class="noteImgFloat" title="Info" alt="Info" />
                                                        <p class="noteHeading">Note</p>
                                                        <p class="noteContent">When configuring an Access Gateway high availability cluster, you may add your Okta tenant as an idP at any time. In addition, you may also add applications any time.</p>
                                                    </div>
                                                </div>
                                                <div>
                                                    <hr width="100%" size="0" align="center" />
                                                    <h2><a name="Next_Steps"></a>Next Steps</h2>
                                                    <ul>
                                                        <li value="1">Manage Authorization Modules. For more information see <a href="admin-settings-authmod.htm" class="MCXref xref">Administer Auth Modules</a>.</li>
                                                        <li value="2">Manage Identity Providers. For more information see, <a href="admin-settings-identity.htm" class="MCXref xref">Administer Identity Providers</a>.</li>
                                                        <li value="3"><a href="configure-idp-okta.htm" class="MCXref xref">Configure your Okta tenant as an Identity Provider</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                                <!-- Back to Top button --><a href="#" class="sf-back-to-top"><span class="arrow"></span>Top</a>
                                            </div>
                                        </div>
                                        <!-- *** Col3: Right menu Col *** -->
                                        <div class="is-not-in-mobile">
                                        </div>
                                    </div>
                                    <!-- ***************************** Footer rows ********************************* -->
                                    <div class="footer-temp">
                                        <div class="is-not-in-mobile">
                                            <p> </p>
                                        </div>
                                        <div>
                                            <p class="copyright">©  <span class="okta-variablesYear">2020</span> <span class="okta-variablesCompanyName">Okta, Inc</span> All Rights Reserved. Various trademarks held by their respective owners.</p>
                                        </div>
                                    </div>
                                    <!-- ***************************** Scripts ************************************* -->
                                    <!-- Foundation -->
                                    <script src="../../Resources/Scripts/js/app.js">
                                    </script>
                                    <script src="../../Resources/Scripts/js/vendor/what-input.js">
                                    </script>
                                    <script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/6.4.4-rc1/js/foundation.min.js">
                                    </script>
                                    <!-- Ours -->
                                    <script type="text/javascript" src="../../Resources/Scripts/back-to-top.js">
                                    </script>
                                    <script type="text/javascript" src="../../Resources/Scripts/get-feedback.js">
                                    </script>
                                    <!-- Coveo -->
                                    <script src="https://static.cloud.coveo.com/searchui/v2.5395/js/CoveoJsSearch.Lazy.min.js" defer="defer">
                                    </script>
                                    <script src="../../Resources/Scripts/coveo-resources/js/cultures/en.js" id="coveoCultureScript" defer="defer">
                                    </script>
                                    <script src="../../Resources/Scripts/coveo-resources/js/Coveo.MadcapFlare.RequireJS.js" id="coveoRequireScript" defer="defer">
                                    </script>
                                    <script src="../../Resources/Scripts/coveo-resources/js/Coveo.MadcapFlare.Okta.js" id="coveoInitscript" defer="defer">
                                    </script>
                                </div>
                            </main>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
