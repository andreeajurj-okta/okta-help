<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_okta_html5_topnav" data-mc-search-type="Stem" data-mc-help-system-file-name="okta_help.xml" data-mc-path-to-help-system="../../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="typeofcontent" content="documentation" />
        <meta name="audience" content="admin" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Deploy Access Gateway into Amazon Web Services | Okta</title>
        <meta charset="utf-8" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, height=device-height" />
        <link rel="shortcut icon" href="../../Resources/Images/favicon.ico" type="image/x-icon" />
        <!-- Google Tag Manager -->
        <script>
			/* <![CDATA[ */
			(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], 
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
			})(window,document,'script','dataLayer','GTM-TJ45R6');
			/* ]]> */
		</script>
        <!-- End Google Tag Manager -->
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/okta-main.css" rel="stylesheet" />
        <link href="https://static.cloud.coveo.com/searchui/v2.5395/css/CoveoFullSearchNewDesign.css" rel="stylesheet" />
        <style>/*&lt;meta /&gt;*/

.button.expand-all-button
{
	-pie-background: url('../../../Skins/Default/Stylesheets/Images/expand-all-non-hover-sm.png') no-repeat center center, linear-gradient(#fff, #fff);
}

.button.collapse-all-button
{
	-pie-background: url('../../../Skins/Default/Stylesheets/Images/collapse-all-non-hover-sm.png') no-repeat center center, linear-gradient(#fff, #fff);
}

.needs-pie
{
	behavior: url('../../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.6.2.3_custom.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="small" data-mc-ignore="true">
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <button class="menu-icon" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="https://support.okta.com/help/s/" alt="Okta"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="2" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" placeholder="Search" />
                                                <div class="search-filter-wrapper">
                                                    <div class="search-filter">
                                                        <div class="search-filter-content">
                                                            <ul>
                                                                <li>All Files</li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search">
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <section class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <div class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </div>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <!-- Google Tag Manager (noscript) -->
                                    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TJ45R6" height="0" width="0" style="display:none;visibility:hidden"></iframe>
                                    </noscript>
                                    <!-- End Google Tag Manager (noscript) -->
                                    <!-- Coveo config parameters -->
                                    <div id="coveo_org_id" style="Display:None"><span class="okta-coveo-configOrgId">oktaproduction9ounvcxa</span>
                                    </div>
                                    <div id="coveo_rest_uri" style="Display:None"><span class="okta-coveo-configPlatformRestUri">https://platform.cloud.coveo.com/rest/search</span>
                                    </div>
                                    <div id="coveo_search_url" style="Display:None"><span class="okta-coveo-configSearchPageUrl">https://support.okta.com/help/s/global-search/%40uri</span>
                                    </div>
                                    <div id="coveo_token_url" style="Display:None"><span class="okta-coveo-configSearchTokenServiceUrl">https://support.okta.com/help/services/apexrest/PublicSearchToken?site=help</span>
                                    </div>
                                    <!-- End Coveo config parameters -->
                                    <!-- ************************* Coveo Search bar ************************************* -->
                                    <div id="OLC_Coveo_Headline" class="coveo-headline-wrapper">
                                        <div class="slds-p-vertical_small">
                                            <!--Search Bar-->
                                            <div class="slds-grid slds-grid_align-center">
                                                <div id="customSelect" class="CoveoCustomSelect slds-float_right">
                                                </div>
                                                <div id="standaloneSearchbox">
                                                    <div class="CoveoAnalytics" data-search-hub="OktaCommunityFullSearch">
                                                    </div>
                                                    <div class="CoveoTab" data-id="Help" data-caption="Help" style="display:none">
                                                    </div>
                                                    <div class="CoveoSearchbox" data-enable-omnibox="true" data-enable-query-suggest-addon="true">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- **********************  Main content row  ********************** -->
                                    <div class="okta-topics">
                                        <!-- *** Col1: Left Nav Col *** -->
                                        <div class="is-not-in-mobile">
                                            <div data-sticky-container="" id="ULv9_LqXGkuvZcPYaz4A5A">
                                                <div class="sticky sticky-menu" style="width:100%" data-sticky="" data-top-anchor="ULv9_LqXGkuvZcPYaz4A5A:top" data-bottom-anchor="contentBody:bottom" data-sticky-on="small" data-scroll-container-on="small">
                                                    <ul class="nocontent menu _Skins_okta_left_menu mc-component" data-mc-linked-toc="Data/Tocs/left_nav_TOC.js" data-mc-side-menu="True" data-mc-max-depth="2" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- *** Col2: Body Col *** -->
                                        <div>
                                            <div class="is-not-in-mobile">
                                                <!-- Breadcrumbs -->
                                            </div>
                                            <div class="toolbar-main">
                                                <!-- Expand/Collapse All for drop-downs -->
                                                <div class="buttons popup-container clearfix topicToolbarProxy _Skins_okta_toolbar mc-component nocontent" style="mc-topic-toolbar-items: ;">
                                                    <div class="button-group-container-left">
                                                        <button class="button needs-pie expand-all-button" data-state1-class="expand-all-button" data-state2-class="collapse-all-button" data-state2-title="Collapse all" title="Expand all" data-state1-title="Expand all">
                                                            <img src="../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="expand all" />
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="body-main">
                                                <!-- Main content body -->
                                                <h1>Deploy Access Gateway into Amazon Web Services</h1>
                                                <hr width="100%" size="0" align="center" />
                                                <h2><a name="Overview"></a>Overview</h2>
                                                <p>The purpose of this guide is to walk through the process of deploying the Access Gateway software appliance into an&#160;Amazon Web Services (AWS)&#160;EC2 virtualization environment. </p>
                                                <hr width="100%" size="0" align="center" />
                                                <h2><a name="Prerequisites"></a>Prerequisites</h2>
                                                <ul style="list-style-type: square;">
                                                    <li value="1">You have reviewed all <a href="pre-install-requirements.htm" class="MCXref xref">Prerequisites for Deploying Access Gateway</a></li>
                                                    <li value="2">You have the <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-install.html">aws-cli</a> installed and configured on your local machine. Note that many of the commands also have a GUI equivalent.</li>
                                                    <li value="3">You have access rights in AWS to define IAM policies, create S3 buckets, and AMI images.  </li>
                                                    <li value="4">You are familiar with AWS S3, EC2, cli, and AMIs commands and concepts.</li>
                                                </ul>
                                                <hr width="100%" size="0" align="center" />
                                                <h2><a name="What’s"></a>What’s covered in this guide</h2>
                                                <div>
                                                    <p>AWS can import and use the Okta Access Gateway virtual appliance. In order to use the OVA&#160;with AWS&#160;we must:</p>
                                                    <ul>
                                                        <li value="1">Create an S3 bucket to store the OVA and converted image. AWS stores files in buckets. &#160;Typically an import uses one bucket to store the original import and a second as the target of the convert to AMI process. During this procedure will use the same bucket for import and convert.</li>
                                                        <li value="2">Create the <b style="font-style: italic;">vmimport</b> identity. AWS requires the use of this special identity for OVA&#160;imports.</li>
                                                        <li value="3">Assign privileges to the <b style="font-style: italic;">vmimport</b> identity. AWS&#160;requires a variety of privileges in order to access an S3 bucket. </li>
                                                        <li value="4">Convert an OVA to an AMI. &#160;Once configured, the <b style="font-style: italic;">vmimport</b> account, and S3 bucket can be used to convert an image. </li>
                                                    </ul>
                                                    <p>The process includes:</p>
                                                    <ol style="list-style-type: square;">
                                                        <li value="1"><a href="#Download_OVA" class="MCXref xref">Download the latest OVA&#160;image</a>
                                                        </li>
                                                        <li value="2"><a href="#Determine_Region" class="MCXref xref">Determine your region</a>
                                                        </li>
                                                        <li value="3"><a href="#Upload_2_AWS" class="MCXref xref">Upload Access Gateway OVA&#160;image to AWS.</a>
                                                        </li>
                                                        <li value="4"><a href="#Convert_2_AMI" class="MCXref xref">Convert and import the OVA&#160;Image to an Amazon Image (AMI)</a>
                                                        </li>
                                                    </ol>
                                                </div>
                                                <hr width="100%" size="0" align="center" />
                                                <div>
                                                    <h2><a name="Download_OVA"></a>Download the latest OVA&#160;image</h2>
                                                    <p>To download the latest Okta Access Gateway OVA Image:</p>
                                                    <ol>
                                                        <li value="1">
                                                            <p>Login to your Okta <a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">Org<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>The Okta container that represents a real-world organization.</span></a> as <a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">Admin<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>An abbreviation of administrator. This is the individual(s) who have access to the Okta Administrator Dashboard. They control the provisioning and deprovisioning of end users, the assigning of apps, the resetting of passwords, and the overall end user experience. Only administrators have the Administration button on the upper right side of the My Applications page.</span></a>. </p>
                                                        </li>
                                                        <li value="2">
                                                            <p>Download the Okta Access Gateway image from the <b>Settings &gt; Downloads</b> page.</p>
                                                        </li>
                                                        <li value="3">
                                                            <p>When prompted save the file to an appropriate location.</p>
                                                        </li>
                                                    </ol>
                                                </div>
                                                <hr width="100%" size="0" align="center" />
                                                <div>
                                                    <h2><a name="Determine_Region"></a>Determine your region</h2>
                                                    <p>Your AWS region is required to convert an OVA image to an AWS AMI&#160;image.<br />To determine your region:</p>
                                                    <ol>
                                                        <li value="1">
                                                            <p>Open a terminal. </p>
                                                        </li>
                                                        <li value="2">
                                                            <p>Use the <span style="font-family: 'Courier New';">aws configure list</span> command to determine your current region. <br />For example:<br /><pre xml:space="preserve" id="code"><code><b>aws configure list </b>
. . . 
region		<b style="font-style: italic;">us-east-1</b>	config file	~/.aws/config
. . .
</code></pre></p>
                                                        </li>
                                                        <li value="3">
                                                            <p>Note the region as it will be required to convert the OVA to an AWS&#160;AMI file</p>
                                                            <div class="noteOkta">
                                                                <img src="../../Resources/Images/assets/Icons/Notes/Help.png" class="noteImgFloat" title="Info" alt="Info" />
                                                                <p class="noteHeading">Note</p>
                                                                <p class="noteContent">Region can also be identified by logging into the AWS console, where the default region is shown to the right of account information.<br /><img src="../../Resources/Images/access-gateway/setup-using-ovf.aws-region.png" alt="Default region" id="img_new" /></p>
                                                            </div>
                                                        </li>
                                                    </ol>
                                                </div>
                                                <hr width="100%" size="0" align="center" />
                                                <div>
                                                    <h2><a name="Upload_2_AWS"></a>Upload Access Gateway OVA&#160;image to AWS.</h2>
                                                    <p>An AWS&#160;S3 bucket can be created using either the AWS&#160;CLI or via AWS UI. Note that this procedure uses the same bucket for import and convert. </p>
                                                    <h3>To create an S3 bucket using the UI</h3>
                                                    <ol>
                                                        <li value="1">
                                                            <p>Login to AWS as root.</p>
                                                        </li>
                                                        <li value="2">
                                                            <p>Select <b>Services</b>.</p>
                                                        </li>
                                                        <li value="3">
                                                            <p>In the <b>Storage</b> section click <b>S3</b>.</p>
                                                        </li>
                                                        <li value="4">
                                                            <p>Click <b>+ Create Bucket</b>. </p>
                                                        </li>
                                                        <li value="5">
                                                            <p>Enter an appropriate name, for example <b>my-access-gateway-bucket.</b></p>
                                                        </li>
                                                        <li value="6">
                                                            <p>From the Region drop down select the correct region.</p>
                                                        </li>
                                                        <li value="7">
                                                            <p>Follow the wizard steps finish creating the bucket.</p>
                                                        </li>
                                                    </ol>
                                                    <div>
                                                        <blockquote>
                                                            <p><b>Note</b>: Buckets can be created at the command line using the <span style="font-family: 'Courier New';">aws s3api create-bucket</span> command. For example:<br /><pre xml:space="preserve" id="code"><code style="font-weight: bold;">aws s3api create-bucket --bucket okta-access-gateway-ova-bucket --region us-east-1 --create-bucket-configuration LocationConstraint=us-east-1</code></pre>			Which will return something similar to:<br /><pre xml:space="preserve" id="code"><code>{
    "Location": "/my-access-gateway-bucket"
}</code></pre></p>
                                                        </blockquote>
                                                    </div>
                                                    <h3>Upload the Okta Access Gateway OVA to the bucket</h3>
                                                    <p>To upload the OVA to the bucket using the UI:</p>
                                                    <ol>
                                                        <li value="1">
                                                            <p>In the <b>Storage</b> section click <b>S3</b>.</p>
                                                        </li>
                                                        <li value="2">
                                                            <p>In the bucket list click the bucket name.</p>
                                                        </li>
                                                        <li value="3">
                                                            <p>Click <b>Upload</b>. </p>
                                                        </li>
                                                        <li value="4">
                                                            <p>Click  <b>Add Files</b>. </p>
                                                        </li>
                                                        <li value="5">
                                                            <p>Navigate to the OVA file, select it and click <b>Next</b>.</p>
                                                        </li>
                                                        <li value="6">
                                                            <p>Click <b>Next</b> thru the follow on upload steps. <br />When complete the OVA will be uploaded to the bucket.</p>
                                                        </li>
                                                    </ol>
                                                    <div>
                                                        <blockquote>
                                                            <p><b>Note</b>: Files can be uploaded to an existing bucket using the <span style="font-family: 'Courier New';">aws s3 cp</span> command. For example,<br /><pre xml:space="preserve" id="code"><code><b>aws s3 cp Okta-Access-Gateway.ova s3://my-access-gateway-bucket</b>
<b>aws s3 ls s3://my-access-gateway-bucket</b>
2019-09-11 12:36:00   . . .  Okta-AccessGateway.ova</code></pre><br /></p>
                                                        </blockquote>
                                                    </div>
                                                </div>
                                                <hr width="100%" size="0" align="center" />
                                                <div>
                                                    <h2><a name="Convert_2_AMI"></a>Convert and import the OVA&#160;Image to an Amazon Image (AMI)</h2>
                                                    <p>Importing an OVA&#160;to AWS is a multi-step process.</p>
                                                    <ol>
                                                        <li value="1">
                                                            <p>Open a terminal window.</p>
                                                        </li>
                                                        <li value="2">
                                                            <p>Create the required <b style="font-style: italic;">vmimport</b> IAM identity role to import images<br />Note: AWS requires the use of the <b style="font-style: italic;">vmimport</b> identity role when importing an OVA.</p>
                                                            <ol style="list-style-type: lower-alpha;">
                                                                <li value="1">
							Create a json file, representing the trust policy for the <b style="font-style: italic;">vmimport</b> IAM identity role as follows:
							<figure><pre xml:space="preserve" id="code"><code>{
    "Version": "2012-10-17",
    "Statement":[ {
        "Effect": "Allow",
        "Principal": { "Service": "vmie.amazonaws.com" },
        "Action": "sts:AssumeRole",
        "Condition": {
        "StringEquals":{ "sts:Externalid": "vmimport"}
            }
      }]
}</code></pre><p><b>trust-policy.json</b></p></figure></li>
                                                                <li value="2">
                                                                    <p>
								In a terminal window create the IAM&#160;identity role using the <span style="font-family: 'Courier New';">aws iam create-role</span> command using the new trust policy, as shown:<br /><pre xml:space="preserve" id="code"><code><b>aws iam create-role --role-name vmimport --assume-role-policy-document "file://~/Downloads/trust-policy.json</b></code></pre><br />Which should return a result similar to:<br /><pre xml:space="preserve" id="code"><code>{
    "Role": {
        AssumeRolePolicyDocument": {. . . }
        ...
	"Arn": "arn:aws:iam::809227661992:role/vmimport"
    }
}</code></pre></p>
                                                                </li>
                                                                <li value="3">
                                                                    <p>Create a role policy to associate the new IAM identity with the previously created bucket.<br /><figure><pre xml:space="preserve" id="code"><code>{
    "Version":"2012-10-17",
    "Statement":[{
        "Effect":"Allow",
                 "Action":[
                  "s3:GetBucketLocation",
                  "s3:GetObject",
                  "s3:ListBucket" 
                  ],
         "Resource":[
             "arn:aws:s3:::<b style="font-style: italic;">BUCKET_NAME</b>",
             "arn:aws:s3:::<b style="font-style: italic;">BUCKET_NAME</b>/*"
          ]
       }, {
        "Effect":"Allow",
                "Action":[
                  "s3:GetBucketLocation",
                  "s3:GetObject",
                  "s3:ListBucket",
                  "s3:PutObject",
                  "s3:GetBucketAcl"
                  ],
            "Resource":[
             "arn:aws:s3:::<b style="font-style: italic;">BUCKET-NAME</b>",
             "arn:aws:s3:::<b style="font-style: italic;">BUCKET-NAME</b>/*"
             ]
       }, {
         "Effect":"Allow",
                  "Action":[
                   "ec2:ModifySnapshotAttribute",
                   "ec2:CopySnapshot",
                   "ec2:RegisterImage",
                   "ec2:Describe*"],
            "Resource":"*"
        }
    ]
}</code></pre><figcaption><b>role-policy.json</b></figcaption></figure><br />								Replacing <b style="font-style: italic;">BUCKET_NAME</b> with the previously created buckets name.</p>
                                                                </li>
                                                                <li value="4">
                                                                    <p>Grant an inline role policy to <b>vmimport</b> identity granting various rights to access S3 bucket and perform ec2 operations using the <span style="font-family: 'Courier New';">aws iam put-role-policy</span>y command. For example: <br /><pre xml:space="preserve" id="code"><code style="font-weight: bold;">aws iam put-role-policy --role-name vmimport --policy-name vmimport --policy-document "file://~/Downloads/role-policy.json"</code></pre><br />Note the <span style="font-family: 'Courier New';">aws iam put-role-policy</span> command does not return any value on success.</p>
                                                                </li>
                                                            </ol>
                                                        </li>
                                                        <li value="3">
                                                            <p>Using the <b style="font-style: italic;">vmimport</b> identity to convert the OVA image to an AMI image</p>
                                                            <ol style="list-style-type: lower-alpha;">
                                                                <li value="1">Create a json file representing the locations for the containers used during the import.<br /><figure><pre xml:space="preserve" id="code"><code>
[
    {
        "Description": "<b>DESCRIPTION</b>",
        "Format": "ova",
        "UserBucket": {
            "S3Bucket": "<b>BUCKET_NAME</b>",
            "S3Key": "<b>FILE_NAME</b>"
        }
    }
]</code></pre><figcaption>containers.json</figcaption></figure><br /><p>Replacing:<br /><b>BUCKET_NAME</b> with the bucket name. For example "<b style="font-style: italic;">access-gateway-bucket</b>".<br /><b>DESCRIPTION</b> with an appropriate description. For example, "<b style="font-style: italic;">Okta Access Gateway</b>".<br /><b>FILE_NAME</b> with the specific name of the OVA file. For example "<b style="font-style: italic;">Okta-AccessGateway.ova</b>".</p></li>
                                                                <li value="2">Begin the import process using a command similar to: : <br /><pre xml:space="preserve" id="code"><code><b>aws ec2 import-image --description "Okta Access Gateway" --license-type "BYOL" --disk-containers "file://~/Downloads/containers.json"</b> </code></pre></li>
                                                                <li value="3">
                                                                    <p>Examine the output of command and note the task id associated with the import process. <br /><pre id="code"><code>
{
	"Status": "active", 
	"LicenseType": "BYOL", 
	"Description": "AG2019.ova.", 
	"SnapshotDetails": [...], 
	"Progress": "2", 
	"StatusMessage": "pending", 
	    "<b>ImportTaskId": "import-ami-08800a79da64acae7"</b>
}
</code></pre></p>
                                                                </li>
                                                                <li value="4">
                                                                    <p>Examine the progress of the import using the task id <br /><span style="font-family: 'Courier New';">aws ec2 describe-import-image-tasks --import-task-ids <b style="font-style: italic;">TASK_ID</b></span><![CDATA[
]]><br />Where task id is the value from the prior step. For example:<br /><span style="font-family: 'Courier New';"><b>aws ec2 describe-import-image-tasks --import-task-ids import<i>-ami-08800a79da64acae7</i></b></span></p>
                                                                    <p>Import progress is noted in the Progress json element and represents a percentage from 0-100%.<br /></p>
                                                                    <ol style="list-style-type: lower-alpha;">
                                                                        <li value="1">
                                                                            <p>Monitor the import until it reaches status completed.  For example:<br /><pre xml:space="preserve" id="code"><code>{
    "ImportImageTasks": [
	{
		"Status": "completed", 
		"LicenseType": "BYOL", 
		"Description": "AG2019.ova.",
		ImageId": "<b>ami-0c20c537e7f8dd6a5</b>"
}</code></pre><br />Note the <b style="font-style: italic;">ImageId</b> field, it will be used to confirm the image import in the AWS console.</p>
                                                                        </li>
                                                                    </ol>
                                                                </li>
                                                            </ol>
                                                        </li>
                                                        <li value="4">
                                                            <p>Confirm that the import completed in the AWS console<br /><ol style="list-style-type: lower-alpha;"><li value="1"><p>Return to the AWS&#160;console</p></li><li value="2"><p>Navigate to <b>Services &gt; EC2</b>.</p></li><li value="3"><p>In the left hand navigation pane select <b>Images &gt; AMI</b>. </p></li><li value="4"><p>Examine the image list, searching for the image with matching id.<br /><br /><br /><img src="../../Resources/Images/access-gateway/okta-aws-import.1_902x121.png" alt="AWS AMI Image list" id="img_new" style="width: 902;height: 121;" /><br /></p></li></ol></p>
                                                        </li>
                                                    </ol>
                                                </div>
                                                <hr width="100%" size="0" align="center" />
                                                <h2>AWS Specific Post Installation</h2>
                                                <p> The following AWS post installation steps are required to complete the deployment of Okta Access Gateway in an AWS environment.</p>
                                                <ul>
                                                    <li value="1"><a href="setup-post-install-aws.htm">Deploy the imported AMI instance</a>
                                                    </li>
                                                </ul>
                                                <p> </p>
                                                <hr width="100%" size="0" align="center" />
                                                <div>
                                                    <h2><a name="Related_Topics"></a>Next Steps</h2>
                                                    <p>After Okta Access Gateway has been installed there are a number of common post installation tasks that should be performed. <br />		Including:
			</p>
                                                    <ul>
                                                        <li value="1"><a href="setup-post-install.htm#Determine_IPAddress">Determine the IP Address of the Okta Access Gateway virtual application.</a>
                                                        </li>
                                                        <li value="2"><a href="setup-post-install.htm#ConfigureLocal">Configure admin <span style="font-family: 'Courier New';">/etc/hosts</span> entry</a>
                                                        </li>
                                                        <li value="3"><a href="setup-post-install.htm#Initialize_Verify">Initialize the Command Line console</a>
                                                        </li>
                                                        <li value="4"><a href="setup-post-install.htm#Reset_Passwords">Reset Passwords</a>
                                                        </li>
                                                        <li value="5"><a href="setup-post-install.htm#InitializeUI">Initialize Access Gateway Admin UI&#160;Console</a>
                                                        </li>
                                                        <li value="6"><a href="setup-post-install.htm#ConfigureDNS">Configure DNS</a>
                                                        </li>
                                                        <li value="7"><a href="setup-post-install.htm#Add_Applications">Add Applications</a>
                                                        </li>
                                                    </ul>
                                                    <div>
                                                        <h2><a name="More_Information"></a>For More Information</h2>
                                                        <ul>
                                                            <li value="1">See <a href="setup-post-install.htm" class="MCXref xref">Okta Access Gateway Post Installation</a> for a complete task list.</li>
                                                            <li value="2">See  <a href="command-line-console-reference.htm" class="MCXref xref"> Command Line Management Console Reference</a> for a complete list of management console commands.</li>
                                                            <li value="3">See <a href="admin-ui-console-overview.htm" class="MCXref xref">Admin UI Console Overview</a> for an overview of the Access Gateway UI&#160;console.</li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <!-- Back to Top button --><a href="#" class="sf-back-to-top"><span class="arrow"></span>Top</a>
                                            </div>
                                        </div>
                                        <!-- *** Col3: Right menu Col *** -->
                                        <div class="is-not-in-mobile">
                                        </div>
                                    </div>
                                    <!-- ***************************** Footer rows ********************************* -->
                                    <div class="footer-temp">
                                        <div class="is-not-in-mobile">
                                            <p> </p>
                                        </div>
                                        <div>
                                            <p class="copyright">©  <span class="okta-variablesYear">2020</span> <span class="okta-variablesCompanyName">Okta, Inc</span> All Rights Reserved. Various trademarks held by their respective owners.</p>
                                        </div>
                                    </div>
                                    <!-- ***************************** Scripts ************************************* -->
                                    <!-- Foundation -->
                                    <script src="../../Resources/Scripts/js/app.js">
                                    </script>
                                    <script src="../../Resources/Scripts/js/vendor/what-input.js">
                                    </script>
                                    <script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/6.4.4-rc1/js/foundation.min.js">
                                    </script>
                                    <!-- Ours -->
                                    <script type="text/javascript" src="../../Resources/Scripts/back-to-top.js">
                                    </script>
                                    <script type="text/javascript" src="../../Resources/Scripts/get-feedback.js">
                                    </script>
                                    <!-- Coveo -->
                                    <script src="https://static.cloud.coveo.com/searchui/v2.5395/js/CoveoJsSearch.Lazy.min.js">
                                    </script>
                                    <script src="../../Resources/Scripts/coveo-resources/js/cultures/en.js" id="coveoCultureScript">
                                    </script>
                                    <script src="../../Resources/Scripts/coveo-resources/js/Coveo.MadcapFlare.RequireJS.js" id="coveoRequireScript">
                                    </script>
                                    <script src="../../Resources/Scripts/coveo-resources/js/Coveo.MadcapFlare.Okta.js" id="coveoInitscript">
                                    </script>
                                </div>
                            </div>
                        </div>
                    </section><a data-close="true"></a>
                </div>
            </div>
            <script>/* <![CDATA[ */$(document).foundation();/* ]]> */</script>
        </div>
    </body>
</html>