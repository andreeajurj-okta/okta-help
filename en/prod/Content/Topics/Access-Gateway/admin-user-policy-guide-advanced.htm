<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_okta_html5_topnav" data-mc-search-type="Stem" data-mc-help-system-file-name="okta_help.xml" data-mc-path-to-help-system="../../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="typeofcontent" content="documentation" />
        <meta name="audience" content="admin" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="description" content="Manage Access Gateway Application Policies to restrict or allow access to on-prem applications based on admin-created, app-specific policies." /><title>Advanced Policy | Okta</title>
        <meta charset="utf-8" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, height=device-height" />
        <link rel="shortcut icon" href="../../Resources/Images/favicon.ico" type="image/x-icon" />
        <!-- Google Tag Manager -->
        <script>
			/* <![CDATA[ */
			(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], 
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
			})(window,document,'script','dataLayer','GTM-TJ45R6');
			/* ]]> */
		</script>
        <!-- End Google Tag Manager -->
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/okta-main.css" rel="stylesheet" />
        <link href="https://static.cloud.coveo.com/searchui/v2.5395/css/CoveoFullSearchNewDesign.css" rel="stylesheet" />
        <style>/*&lt;meta /&gt;*/

.button.expand-all-button
{
	-pie-background: url('../../../Skins/Default/Stylesheets/Images/expand-all-non-hover-sm.png') no-repeat center center, linear-gradient(#fff, #fff);
}

.button.collapse-all-button
{
	-pie-background: url('../../../Skins/Default/Stylesheets/Images/collapse-all-non-hover-sm.png') no-repeat center center, linear-gradient(#fff, #fff);
}

.needs-pie
{
	behavior: url('../../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <link href="../../Resources/TableStyles/standard.css" rel="stylesheet" />
        <link href="../../Resources/TableStyles/standard-shaded-rows.css" rel="stylesheet" />
        <link href="../../Resources/Scripts/coveo-resources/css/Coveo.Okta.StandaloneSearchbox.min.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.6.2.3_custom.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="small" data-mc-ignore="true">
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <button class="menu-icon" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="https://support.okta.com/help/s/" alt="Okta"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="2" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" placeholder="Search" />
                                                <div class="search-filter-wrapper">
                                                    <div class="search-filter">
                                                        <div class="search-filter-content">
                                                            <ul>
                                                                <li>All Files</li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search">
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <section class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <div class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </div>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <!-- Google Tag Manager (noscript) -->
                                    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TJ45R6" height="0" width="0" style="display:none;visibility:hidden"></iframe>
                                    </noscript>
                                    <!-- End Google Tag Manager (noscript) -->
                                    <!-- Coveo config parameters -->
                                    <div id="coveo_org_id" style="Display:None"><span class="okta-coveo-configOrgId">oktaproduction9ounvcxa</span>
                                    </div>
                                    <div id="coveo_rest_uri" style="Display:None"><span class="okta-coveo-configPlatformRestUri">https://platform.cloud.coveo.com/rest/search</span>
                                    </div>
                                    <div id="coveo_search_url" style="Display:None"><span class="okta-coveo-configSearchPageUrl">https://support.okta.com/help/s/global-search/%40uri</span>
                                    </div>
                                    <div id="coveo_token_url" style="Display:None"><span class="okta-coveo-configSearchTokenServiceUrl">https://support.okta.com/help/services/apexrest/PublicSearchToken?site=help</span>
                                    </div>
                                    <!-- End Coveo config parameters -->
                                    <!-- ************************* Coveo Search bar ************************************* -->
                                    <div id="OLC_Coveo_Headline" class="coveo-headline-wrapper">
                                        <div class="slds-p-vertical_small">
                                            <!--Search Bar-->
                                            <div class="slds-grid slds-grid_align-center">
                                                <div id="customSelect" class="CoveoCustomSelect slds-float_right">
                                                </div>
                                                <div id="standaloneSearchbox">
                                                    <div class="CoveoAnalytics" data-search-hub="OktaCommunityFullSearch">
                                                    </div>
                                                    <div class="CoveoTab" data-id="Help" data-caption="Help" style="display:none">
                                                    </div>
                                                    <div class="CoveoSearchbox" data-enable-omnibox="true" data-enable-query-suggest-addon="true">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- **********************  Main content row  ********************** -->
                                    <div class="okta-topics">
                                        <!-- *** Col1: Left Nav Col *** -->
                                        <div class="is-not-in-mobile">
                                            <div data-sticky-container="" id="9pWcA3Q3jE2_F6WqmC6u5g">
                                                <div class="sticky sticky-menu" style="width:100%" data-sticky="" data-top-anchor="9pWcA3Q3jE2_F6WqmC6u5g:top" data-bottom-anchor="contentBody:bottom" data-sticky-on="small" data-scroll-container-on="small">
                                                    <ul class="nocontent menu _Skins_okta_left_menu mc-component" data-mc-linked-toc="Data/Tocs/left_nav_TOC.js" data-mc-side-menu="True" data-mc-max-depth="2" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- *** Col2: Body Col *** -->
                                        <div>
                                            <div class="is-not-in-mobile">
                                                <!-- Breadcrumbs -->
                                            </div>
                                            <div class="toolbar-main">
                                                <!-- Expand/Collapse All for drop-downs -->
                                                <div class="buttons popup-container clearfix topicToolbarProxy _Skins_okta_toolbar mc-component nocontent" style="mc-topic-toolbar-items: ;">
                                                    <div class="button-group-container-left">
                                                        <button class="button needs-pie expand-all-button" data-state1-class="expand-all-button" data-state2-class="collapse-all-button" data-state2-title="Collapse all" title="Expand all" data-state1-title="Expand all">
                                                            <img src="../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="expand all" />
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="body-main">
                                                <!-- Main content body -->
                                                <h1>Advanced Policy</h1>
                                                <hr width="100%" size="0" align="center" />
                                                <h2 style="font-weight: normal;"><a name="Overview"></a>Overview</h2>
                                                <p>The purpose of this guide is to walk through the process of creating and managing advanced policy. <br />Advanced policy configuration allows Access Gateway application administrators to create policy tailored to a specific URI, and need.</p>
                                                <hr width="100%" size="0" align="center" />
                                                <div>
                                                    <h2 style="font-weight: normal;"><a name="What’s"></a><span style="font-weight: normal;">What’s covered in this guide</span>
                                                    </h2>
                                                    <ol>
                                                        <li value="1"><a href="#Policies" class="MCXref xref">Policies
            </a>
                                                        </li>
                                                        <li value="2"><a href="#Concepts" class="MCXref xref">Concepts</a>
                                                        </li>
                                                        <li value="3"><a href="#Developing_Advanced_Policy" class="MCXref xref">Entering Advanced Policy</a>
                                                        </li>
                                                        <li value="4"><a href="#Custom_Configuration" class="MCXref xref">Custom Configuration</a>
                                                        </li>
                                                        <li value="5"><a href="#Examples" class="MCXref xref">Examples</a>
                                                        </li>
                                                    </ol>
                                                </div>
                                                <div>
                                                    <hr width="100%" size="0" align="center" />
                                                    <h2><a name="Policies"></a>Policies
            </h2>
                                                    <p>Access Gateway includes the ability to configure one or more access policies per application. Policies are applied to URI resources within an application and can be set to achieve the following:</p>
                                                    <ul>
                                                        <li value="1">
                                                            <p>Allow access to an application by any authenticated user (default)</p>
                                                        </li>
                                                        <li value="2">
                                                            <p>Allow no authentication access (to anyone) for an application</p>
                                                        </li>
                                                        <li value="3">
                                                            <p>Allow specific user(s) access to an application</p>
                                                        </li>
                                                        <li value="4">
                                                            <p>Allow specific group(s) access to an application</p>
                                                        </li>
                                                        <li value="5">
                                                            <p>Allow access to an application based on any <a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">IDP<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>An acronym for Identity Provider. It is a service that manages end user accounts analogous to user directories such as LDAP and Active Directory, and can send SAML responses to SPs to authenticate end users. Within this scenario, the IdP is Okta.</span></a> user profile attribute</p>
                                                        </li>
                                                        <li value="6">
                                                            <p>Allow granular access based on an application URI(s) or deep link(s)</p>
                                                        </li>
                                                    </ul>
                                                    <p>See the <a href="admin-user-policy-guide.htm" class="MCXref xref">Administration User Policy Guide</a> for details of creating and managing access policies.</p>
                                                </div>
                                                <hr width="100%" size="0" align="center" />
                                                <h2><a name="Concepts"></a>Concepts</h2>
                                                <p>The Access Gateway supports customized scripting within a given policy. These scripts can be used to extend the basic policy mechanism to meet specific customer requirements.  </p>
                                                <p>Advanced policies are:</p>
                                                <ul>
                                                    <li value="1">
                                                        <p>Are associated with a given policy and declared in the Advanced section of the associated policy.</p>
                                                    </li>
                                                    <li value="2">
                                                        <p>Are executed with the location block of the underlying <a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ #text">NGINX<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>Nginx is a web server which can also be used as a reverse proxy, load balancer, mail proxy and HTTP cache.</span></a>&#160;server instance.</p>
                                                    </li>
                                                    <li value="3">
                                                        <p>Can access environment, session, and query values,</p>
                                                    </li>
                                                    <li value="4">
                                                        <p>Can include conditional statements</p>
                                                    </li>
                                                    <li value="5">
                                                        <p>Can rewrite URLs as well change return codes</p>
                                                    </li>
                                                    <li value="6">
                                                        <p>and more</p>
                                                    </li>
                                                </ul>
                                                <div>
                                                    <hr width="100%" size="0" align="center" />
                                                    <h2><a name="Advanced_Policy_Basics"></a>Working with Advanced Policy</h2>
                                                    <p>Advanced policy consists of one or more statements.<br />Statements:</p>
                                                    <ul>
                                                        <li value="1">Are executed in the order specified.</li>
                                                        <li value="2">Are terminated using semi-colons .</li>
                                                        <li value="3">Can define variables.</li>
                                                        <li value="4">Can read and write AccessGateway and HTTP&#160;session variables.</li>
                                                        <li value="5">Support if/then style conditional constructs.</li>
                                                        <li value="6">Can be grouped into blocks.</li>
                                                        <li value="7">Can be short circuited, causing execution cease at that point.</li>
                                                        <li value="8">Can change and return HTTP status codes.</li>
                                                        <li value="9">Can rewrite URL strings.<br /></li>
                                                    </ul>
                                                    <div>
                                                        <h3><a name="Developing_Advanced_Policy"></a>Entering Advanced Policy</h3>
                                                        <p>To enter advanced policy:</p>
                                                        <ol>
                                                            <li value="1">Log in to the Access Gateway Administration UI Console.</li>
                                                            <li value="2">
                                                                <p>Click the <strong>Applications</strong> tab.</p>
                                                            </li>
                                                            <li value="3">
                                                                <p>Open an application for edit by clicking the pencil icon.<br /><br /><img src="../../Resources/Images/access-gateway/admin-policy-guide-advanced.01.png" id="img_new" alt="Click the pencil icon next to any application to open for update." /><br /></p>
                                                            </li>
                                                            <li value="4">
                                                                <p>Select the <b>Policies</b> sub-tab.<br /><img src="../../Resources/Images/access-gateway/admin-policy-guide-advanced.02.png" id="img_new" alt="Select the policy tab." /></p>
                                                            </li>
                                                            <li value="5">
                                                                <p>Open a policy for edit by clicking the <b>pencil</b> icon<br /><img src="../../Resources/Images/access-gateway/admin-policy-guide-advanced.03.png" id="img_new" alt="Click the pencil to open a policy for edit." /></p>
                                                            </li>
                                                            <li value="6">
                                                                <p>Expand <b>Advanced</b>.</p>
                                                            </li>
                                                            <li value="7">
                                                                <p>In the <b>Custom Configuration</b> text box enter the advanced policy. <br />For example: <br /><span style="font-family: 'Courier New';">set $TEST "some value";
<br />proxy_set_header header_test $TEST;</span></p>
                                                            </li>
                                                            <li value="8">
                                                                <p>Click the not validated button (<img src="../../Resources/Images/access-gateway/admin-policy-guide-advanced.04.png" />) to validate the syntax of the custom configuration.</p>
                                                                <p>On success the button will turn green. Otherwise, correct any syntax errors and re-validate. </p>
                                                            </li>
                                                            <li value="9">Click <b>Okay</b> to save the custom configuration.</li>
                                                            <li value="10">Click <b>Done</b> to complete the application editing session. </li>
                                                        </ol>
                                                    </div>
                                                    <div>
                                                        <h3><a name="Custom_Configuration"></a>Custom Configuration</h3>
                                                        <p>Custom Configuration is composed of comments, one or more statements session data, performing various tests and executing follow up actions on those tests. </p>
                                                        <div>
                                                            <h4>Comments</h4>
                                                            <p>Comments are any content following the hash symbol (<span style="font-family: 'Courier New';">#</span>).</p>
                                                            <p style="font-family: 'Courier New';">#This is a comment
<br /> #This comment, preceded by a space
<br />set $TEST "some value"; #this is also a valid comment
</p>
                                                        </div>
                                                        <div>
                                                            <h4>Embedded or Predefined Variables<br /></h4>
                                                            <p>Embedded variables include all HTTP&#160;session, cookie, query and request header fields as well as more then 50 named variables. Commonly these variables are accessed using prefixes. Common prefixes include:</p>
                                                            <table style="width: 100%;mc-table-style: url('../../Resources/TableStyles/standard-shaded-rows.css');" class="TableStyle-srb_header_alt_shade" cellspacing="0">
                                                                <col class="TableStyle-srb_header_alt_shade-Column-Column1" />
                                                                <col class="TableStyle-srb_header_alt_shade-Column-Column1" />
                                                                <col class="TableStyle-srb_header_alt_shade-Column-Column1" />
                                                                <thead>
                                                                    <tr class="TableStyle-srb_header_alt_shade-Head-Header1">
                                                                        <th class="TableStyle-srb_header_alt_shade-HeadF-Column1-Header1">Prefix</th>
                                                                        <th class="TableStyle-srb_header_alt_shade-HeadF-Column1-Header1">
                                                                            <p>Use</p>
                                                                        </th>
                                                                        <th class="TableStyle-srb_header_alt_shade-HeadD-Column1-Header1">Example</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <tr class="TableStyle-srb_header_alt_shade-Body-Body1">
                                                                        <td class="TableStyle-srb_header_alt_shade-BodyF-Column1-Body1"><b>arg_</b>
                                                                        </td>
                                                                        <td class="TableStyle-srb_header_alt_shade-BodyF-Column1-Body1">
                                                                            <p>Access query arguments</p>
                                                                        </td>
                                                                        <td class="TableStyle-srb_header_alt_shade-BodyD-Column1-Body1">arg_<b style="font-style: italic;">name</b> where <i>name</i> represents a query variable.</td>
                                                                    </tr>
                                                                    <tr class="TableStyle-srb_header_alt_shade-Body-Body2">
                                                                        <td class="TableStyle-srb_header_alt_shade-BodyF-Column1-Body2">
                                                                            <p><b>cookie_</b>
                                                                            </p>
                                                                        </td>
                                                                        <td class="TableStyle-srb_header_alt_shade-BodyF-Column1-Body2">
                                                                            <p>Access cookie fields</p>
                                                                        </td>
                                                                        <td class="TableStyle-srb_header_alt_shade-BodyD-Column1-Body2">
                                                                            <p>cookie_<i style="font-weight: bold;">name</i> where <i>name</i> represent some cookie field..</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-srb_header_alt_shade-Body-Body1">
                                                                        <td class="TableStyle-srb_header_alt_shade-BodyF-Column1-Body1"><b>http_</b>
                                                                        </td>
                                                                        <td class="TableStyle-srb_header_alt_shade-BodyF-Column1-Body1">
                                                                            <p>Access arbitrary header field</p>
                                                                        </td>
                                                                        <td class="TableStyle-srb_header_alt_shade-BodyD-Column1-Body1">http_<b style="font-style: italic;">email</b> where <i>email</i> represents some field in the header. </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-srb_header_alt_shade-Body-Body2">
                                                                        <td class="TableStyle-srb_header_alt_shade-BodyC-Column1-Body2"><b>sent_http_</b>
                                                                        </td>
                                                                        <td class="TableStyle-srb_header_alt_shade-BodyC-Column1-Body2">
                                                                            <p>Response header field</p>
                                                                        </td>
                                                                        <td class="TableStyle-srb_header_alt_shade-BodyA-Column1-Body2">sent_http_<b style="font-style: italic;">email</b> where <i>email</i> represents some field in the response header. </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                            <p>A partial list of variables, includes:</p>
                                                            <ul>
                                                                <li value="1"><span style="font-family: 'Courier New';">$args</span> - All arguments in the request.</li>
                                                                <li value="2"><![CDATA[
                            ]]><span style="font-family: 'Courier New';">$request_uri</span> - complete original request URI (with arguments).</li>
                                                                <li value="3"><span style="font-family: 'Courier New';">$uri</span> - Content URI&#160;in request.</li>
                                                                <li value="4"><span style="font-family: 'Courier New';">$request_body</span> - Request body.</li>
                                                            </ul>
                                                            <p>For complete list of embedded variables see <a href="http://nginx.org/en/docs/http/ngx_http_core_module.html#var_sent_http_" title="Embedded variables." alt="Embedded variables.">Embedded variables</a> in the NGINX guide.</p>
                                                        </div>
                                                        <div>
                                                            <h4>User Variables</h4>
                                                            <p>Variables can be defined within a custom configuration, can be used in assignments, as well as conditional(<b>if</b>) statements.<br /><br /><b>General format:</b></p>
                                                            <blockquote>
                                                                <p><span style="font-family: 'Courier New';">set $variablename value;</span>
                                                                </p>
                                                            </blockquote>
                                                            <p><b>Example:</b>
                                                                <br />
                                                            </p>
                                                            <blockquote><span style="font-family: 'Courier New';">#create a variable TEST, containing the value "test value"
<br />set $TEST "test value"; <br /></span>
                                                            </blockquote>
                                                        </div>
                                                        <div>
                                                            <h4>Conditionals</h4>
                                                            <p>Conditionals allow for making decisions based on variable state and then conditionally executing a code block. <br /><br /><b>General format:</b></p>
                                                            <blockquote>
                                                                <p><span style="font-family: 'Courier New';">if (condition) { statement1; statement2; . . . statementn; }</span>
                                                                </p>
                                                            </blockquote>
                                                            <p>Where <span style="font-family: 'Courier New';">condition</span> is:</p>
                                                            <ul>
                                                                <li value="1">variable name, false if empty or <b>0</b>., otherwise true</li>
                                                                <li value="2">Comparison between two variables using <span style="font-family: 'Courier New';">=</span>(equals) and <span style="font-family: 'Courier New';">!=</span> (not equals) operators. </li>
                                                                <li value="3">Matching of a variable against a regular expression. </li>
                                                            </ul>
                                                            <p><b>Example:</b>
                                                                <br />
                                                            </p>
                                                            <blockquote><span style="font-family: 'Courier New';"><pre xml:space="preserve"># If the query parameter 'test' contains the value 'demo'
#&#160;then no authorization required.<br />if ($arg_test = "demo") {
    set $policy_type "NO_AUTH";}</pre></span>
                                                            </blockquote>
                                                            <p>In addition, the <span style="font-family: 'Courier New';">break</span> directive stops further statement execution.<br /><br /><b>Example:</b></p>
                                                            <blockquote><span style="font-family: 'Courier New';"><pre xml:space="preserve">
if ($arg_test = "demo") {
    set $policy_type "NO_AUTH";
    break;
}
#Statements after break not executed if condition is true</pre></span>
                                                            </blockquote>
                                                            <p>For more information on if statements see <a href="http://nginx.org/en/docs/http/ngx_http_rewrite_module.html#if">if statement</a>.</p>
                                                        </div>
                                                        <div>
                                                            <h4>Return codes</h4>
                                                            <p>Stops processing and returns the specified code to a <a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">client<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>Essentially, a client is anything that talks to the Okta service. Within the traditional client-server model, Okta is the server. The client might be an agent, an Okta mobile app, or a browser plugin. </span></a>. </p>
                                                            <p><b>General format:</b>
                                                            </p>
                                                            <blockquote>
                                                                <p><span style="font-family: 'Courier New';">return <i>numericReturnCode</i> <i>[optional url]</i>;</span>
                                                                </p>
                                                            </blockquote>
                                                            <p><b>Example:</b>
                                                            </p>
                                                            <blockquote>
                                                                <p><span style="font-family: 'Courier New';">#Stop executing and return a 404<br />							return 404;</span>
                                                                </p>
                                                            </blockquote>
                                                        </div>
                                                        <div>
                                                            <h4>Directives</h4>
                                                            <p>Directives are a set of built in functionality that can be called from custom configuration much like a function can be called in various programming languages. Directives can, and mostly do, take parameters. <br /></p>
                                                            <p><b>General format:</b>
                                                            </p>
                                                            <blockquote>
                                                                <p><span style="font-family: 'Courier New';">directive_name [parameter1 [parameter2 [parametern]]];</span>
                                                                </p>
                                                            </blockquote>
                                                            <p>For an alphabetical list of directives see the NGINX documentation <a href="https://nginx.org/en/docs/dirindex.html" title="Alphabetical list of all NGNIX directives." alt="Alphabetical list of all NGNIX directives.">here</a>. </p>
                                                            <div class="noteOkta">
                                                                <img src="../../Resources/Images/assets/Icons/Notes/Help.png" class="noteImgFloat" title="Info" alt="Info" />
                                                                <p class="noteHeading">Note</p>
                                                                <p class="noteContent">Custom Configuration only supports directives which specify the location context. <br />For example:<br /><img src="../../Resources/Images/access-gateway/admin-user-policy-guide-advanced.directive.example.png" alt="An example of a directive which supports location. " /><br /></p>
                                                            </div>
                                                            <p>Directives examples might include:</p>
                                                            <div>
                                                                <h5>Proxy hide header</h5>
                                                                <p>By default certain header fields are hidden. The <span style="font-family: 'Courier New';">proxy_hide_heade</span>r field directive can be used to hide other headers.&#160;</p>
                                                                <p><b>General format:</b>
                                                                </p>
                                                                <blockquote>
                                                                    <p><span style="font-family: 'Courier New';">proxy_set_header <i>field value</i>;</span>
                                                                    </p>
                                                                    <p>Value can contain text, variables and their combinations. </p>
                                                                </blockquote>
                                                                <p><b>Example:</b>
                                                                    <br />
                                                                </p>
                                                                <blockquote><span style="font-family: 'Courier New';">proxy_set_header Host       $proxy_host;</span>
                                                                </blockquote>
                                                            </div>
                                                            <div>
                                                                <h5>Proxy set header</h5>
                                                                <p>Allows redefining or appending fields the request header.</p>
                                                                <p><b>General format:</b>
                                                                </p>
                                                                <blockquote>
                                                                    <p><span style="font-family: 'Courier New';">proxy_hide_header <i>field</i>;</span>
                                                                    </p>
                                                                </blockquote>
                                                                <p><b>Example:</b>
                                                                    <br />
                                                                </p>
                                                                <blockquote><span style="font-family: 'Courier New';">proxy_hide_header secondaryEmailAddress;</span>
                                                                </blockquote>
                                                            </div>
                                                            <div>
                                                                <h5>Proxy Redirecting</h5>
                                                                <p>Specifies the values that should be changed in the <b style="font-style: italic; font-weight: normal;">Location</b> and <u style="font-style: italic; text-decoration: none;">Refresh</u> header fields of a proxied server response.&#160;</p>
                                                                <p><b>General format:</b>
                                                                </p>
                                                                <blockquote>
                                                                    <p><span style="font-family: 'Courier New';">proxy_redirect redirect replacement;</span>
                                                                    </p>
                                                                </blockquote>
                                                                <p><b>Example:</b>
                                                                    <br />
                                                                </p>
                                                                <blockquote><code><pre>proxy_redirect http://general.<a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">domain<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>A domain is an attribute of an Okta organization. Okta uses a fully-qualified domain name, meaning it always includes the top-level domain (.com, .eu, etc.), but does not include the protocol (https).</span></a>.tbd/abc http://abc.domain.tld;</pre></code>
                                                                </blockquote>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div>
                                                        <hr width="100%" size="0" align="center" />
                                                        <h3><a name="Examples"></a>Examples</h3>
                                                        <p>The following are examples of custom&#160;configuration:</p>
                                                        <div>
                                                            <h4>Only send field on specific URI requests</h4>
                                                            <table style="width: 100%;mc-table-style: url('../../Resources/TableStyles/standard.css');" class="TableStyle-standard" cellspacing="0">
                                                                <col class="TableStyle-standard-Column-Column1" style="width: 165pt;" />
                                                                <col class="TableStyle-standard-Column-Column1" style="width: 748px;" />
                                                                <thead>
                                                                    <tr class="TableStyle-standard-Head-Header1">
                                                                        <th class="TableStyle-standard-HeadD-Column1-Header1" colspan="2">Description: Passing all fields to all URLs is often unnecessary. Using custom configuration, a policy can be created to send specific fields on specific requests</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <tr class="TableStyle-standard-Body-Body1">
                                                                        <td class="TableStyle-standard-BodyF-Column1-Body1"><b>Required </b>
                                                                            <br style="font-weight: bold;" /><b>Configuration</b>
                                                                        </td>
                                                                        <td class="TableStyle-standard-BodyD-Column1-Body1">
                                                                            <p>Protected rule exists for a given resource. <br />Configure attribute 'do not send'<br /><img src="../../Resources/Images/access-gateway/admin-user-policy-guide-advanced.example.01.png" id="img_new" alt="Set attribute Don't Send." /></p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-standard-Body-Body2">
                                                                        <td class="TableStyle-standard-BodyC-Column1-Body2"><b>Example</b>
                                                                        </td>
                                                                        <td class="TableStyle-standard-BodyA-Column1-Body2">
                                                                            <p>Add a variable to a header</p><code><pre xml:space="preserve">set $TEST " ";   # Set a value for later use
proxy_set_header header_name $TEST;  #Add a value to the HTTP&#160;Header</pre></code>
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                        <div>
                                                            <h4>Force a return on a different URL and error code</h4>
                                                            <table style="width: 100%;mc-table-style: url('../../Resources/TableStyles/standard.css');" class="TableStyle-standard" cellspacing="0">
                                                                <col class="TableStyle-standard-Column-Column1" style="width: 165pt;" />
                                                                <col class="TableStyle-standard-Column-Column1" style="width: 748px;" />
                                                                <thead>
                                                                    <tr class="TableStyle-standard-Head-Header1">
                                                                        <th class="TableStyle-standard-HeadD-Column1-Header1" colspan="2">Description: Sometimes its required to return a specific return code and URL for a given URI</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <tr class="TableStyle-standard-Body-Body1">
                                                                        <td class="TableStyle-standard-BodyF-Column1-Body1"><b>Required </b>
                                                                            <br style="font-weight: bold;" /><b>Configuration</b>
                                                                        </td>
                                                                        <td class="TableStyle-standard-BodyD-Column1-Body1">Protected rule exists for a given resource. <br /></td>
                                                                    </tr>
                                                                    <tr class="TableStyle-standard-Body-Body2">
                                                                        <td class="TableStyle-standard-BodyC-Column1-Body2"><b>Example</b>
                                                                        </td>
                                                                        <td class="TableStyle-standard-BodyA-Column1-Body2"><code><pre xml:space="preserve"># Regardless of the behavior, 
# for the given protected resource
# return 301 </pre><pre xml:space="preserve">return 301 https://www.okta.com;
</pre></code>
                                                                            <p>&#160;</p>
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                        <div>
                                                            <h4>Specify a behavior based on query arguments</h4>
                                                            <table style="width: 100%;mc-table-style: url('../../Resources/TableStyles/standard.css');" class="TableStyle-standard" cellspacing="0">
                                                                <col class="TableStyle-standard-Column-Column1" style="width: 165pt;" />
                                                                <col class="TableStyle-standard-Column-Column1" style="width: 748px;" />
                                                                <thead>
                                                                    <tr class="TableStyle-standard-Head-Header1">
                                                                        <th class="TableStyle-standard-HeadD-Column1-Header1" colspan="2">Description: Behavior for a given URI&#160;can depend on incoming query values. &#160;For example to skip authentication for test data. </th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <tr class="TableStyle-standard-Body-Body1">
                                                                        <td class="TableStyle-standard-BodyF-Column1-Body1"><b>Required </b>
                                                                            <br style="font-weight: bold;" /><b>Configuration</b>
                                                                        </td>
                                                                        <td class="TableStyle-standard-BodyD-Column1-Body1">Protected rule exists for a given resource.<br /></td>
                                                                    </tr>
                                                                    <tr class="TableStyle-standard-Body-Body2">
                                                                        <td class="TableStyle-standard-BodyC-Column1-Body2"><b>Example</b>
                                                                        </td>
                                                                        <td class="TableStyle-standard-BodyA-Column1-Body2"><code><pre xml:space="preserve">#If the query argument test is equal to demo 
#then set the policy type field to NO_AUTH
if ($arg_test = "demo") {
    set $policy_type "NO_AUTH";
}</pre></code>
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                        <div>
                                                            <h4>Rewrite URL&#160;Strings</h4>
                                                            <table style="width: 100%;mc-table-style: url('../../Resources/TableStyles/standard.css');" class="TableStyle-standard" cellspacing="0">
                                                                <col class="TableStyle-standard-Column-Column1" style="width: 165pt;" />
                                                                <col class="TableStyle-standard-Column-Column1" style="width: 748px;" />
                                                                <thead>
                                                                    <tr class="TableStyle-standard-Head-Header1">
                                                                        <th class="TableStyle-standard-HeadD-Column1-Header1" colspan="2">Description:   Despite turning on url re-writing in the gateway, some links and redirects are pointing the browser to the wrong place. <br /></th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <tr class="TableStyle-standard-Body-Body1">
                                                                        <td class="TableStyle-standard-BodyF-Column1-Body1">
                                                                            <p><b>Scenario</b>
                                                                            </p>
                                                                        </td>
                                                                        <td class="TableStyle-standard-BodyD-Column1-Body1">
                                                                            <p>Gateway is <b>gw.okta.com</b><br />Protected server is <b>app1.okta.com</b><br />Some links/redirects point to <b>gw.okta.com</b> instead of <b>app1.okta.com</b></p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-standard-Body-Body2">
                                                                        <td class="TableStyle-standard-BodyF-Column1-Body2"><b>Required </b>
                                                                            <br style="font-weight: bold;" /><b>Configuration</b>
                                                                        </td>
                                                                        <td class="TableStyle-standard-BodyD-Column1-Body2">Protected rule exists for a given resource. <br /></td>
                                                                    </tr>
                                                                    <tr class="TableStyle-standard-Body-Body1">
                                                                        <td class="TableStyle-standard-BodyC-Column1-Body1"><b>Example</b>
                                                                        </td>
                                                                        <td class="TableStyle-standard-BodyA-Column1-Body1"><code><pre xml:space="preserve">proxy_redirect http://gw.okta.com https://app1.okta.com;</pre></code>
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                                <hr width="100%" size="0" align="center" />
                                                <h2><a name="Next_Steps"></a>Next Steps</h2>
                                                <ul>
                                                    <li value="1">Add or review application settings. For more details see  <a href="admin-app-settings.htm" class="MCXref xref">Application Settings</a>.</li>
                                                    <li value="2">Add application behaviors. For details and examples of behaviors see <a href="admin-behaviors.htm" class="MCXref xref">Administer Behaviors</a></li>
                                                    <li value="3">Add fine grained policy to further protect resources. <br />An overview of user policy can be found in <a href="admin-app-policies.htm">Application Policy User Overview.</a> <br />For details and examples of policy see <a href="admin-user-policy-guide.htm" class="MCXref xref">Administration User Policy Guide</a>.</li>
                                                    <li value="4">Extend existing policy using Custom configuration, see <a href="#" class="MCXref xref selected">Advanced Policy</a>.</li>
                                                    <li value="5">Define one or more certificates for use with this application. See <a href="managing-certificates.htm" class="MCXref xref">Certificate Management</a></li>
                                                    <li value="6">Add supplemental database or <a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">LDAP<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>Lightweight Directory Access Protocol (LDAP) is a lightweight client-server protocol for accessing directory services, specifically X.500-based directory services. LDAP runs over TCP/IP or other connection oriented transfer services.</span></a> based data stores.&#160;For more information see <a href="admin-settings-datasources.htm" class="MCXref xref">Administer DataStores</a></li>
                                                </ul>
                                                <!-- Back to Top button --><a href="#" class="sf-back-to-top"><span class="arrow"></span>Top</a>
                                            </div>
                                        </div>
                                        <!-- *** Col3: Right menu Col *** -->
                                        <div class="is-not-in-mobile">
                                        </div>
                                    </div>
                                    <!-- ***************************** Footer rows ********************************* -->
                                    <div class="footer-temp">
                                        <div class="is-not-in-mobile">
                                            <p> </p>
                                        </div>
                                        <div>
                                            <p class="copyright">©  <span class="okta-variablesYear">2020</span> <span class="okta-variablesCompanyName">Okta, Inc</span> All Rights Reserved. Various trademarks held by their respective owners.</p>
                                        </div>
                                    </div>
                                    <!-- ***************************** Scripts ************************************* -->
                                    <!-- Foundation -->
                                    <script src="../../Resources/Scripts/js/app.js">
                                    </script>
                                    <script src="../../Resources/Scripts/js/vendor/what-input.js">
                                    </script>
                                    <script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/6.4.4-rc1/js/foundation.min.js">
                                    </script>
                                    <!-- Ours -->
                                    <script type="text/javascript" src="../../Resources/Scripts/back-to-top.js">
                                    </script>
                                    <script type="text/javascript" src="../../Resources/Scripts/get-feedback.js">
                                    </script>
                                    <!-- Coveo -->
                                    <script src="https://static.cloud.coveo.com/searchui/v2.5395/js/CoveoJsSearch.Lazy.min.js">
                                    </script>
                                    <script src="../../Resources/Scripts/coveo-resources/js/cultures/en.js" id="coveoCultureScript">
                                    </script>
                                    <script src="../../Resources/Scripts/coveo-resources/js/Coveo.MadcapFlare.RequireJS.js" id="coveoRequireScript">
                                    </script>
                                    <script src="../../Resources/Scripts/coveo-resources/js/Coveo.MadcapFlare.Okta.js" id="coveoInitscript">
                                    </script>
                                </div>
                            </div>
                        </div>
                    </section><a data-close="true"></a>
                </div>
            </div>
            <script>/* <![CDATA[ */$(document).foundation();/* ]]> */</script>
        </div>
    </body>
</html>