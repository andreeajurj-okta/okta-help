<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:tocPath="" MadCap:InPreviewMode="false" MadCap:PreloadImages="false" MadCap:RuntimeFileType="Topic" MadCap:TargetType="WebHelp" lang="en-us" xml:lang="en-us" MadCap:PathToHelpSystem="../../../" MadCap:HelpSystemFileName="okta_help.xml" MadCap:SearchType="Stem">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Configuring the On-Prem MFA Agent (including RSA SecurID)</title>
        <link href="../../SkinSupport/Slideshow.css" rel="stylesheet" MadCap:generated="True" />
        <link href="../../SkinSupport/MadCap.css" rel="stylesheet" MadCap:generated="True" />
        <link href="../../Resources/Stylesheets/okta_help.css" rel="stylesheet" />
        <script src="../../SkinSupport/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../SkinSupport/MadCapAll.js" type="text/javascript">
        </script>
        <script src="../../SkinSupport/MadCapTopicAll.js" type="text/javascript">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop"><a href="../../../okta_help_CSH.htm#Topics/Security/MFA_OnPrem.htm" style="">Open topic with navigation</a>
        </p><a name="Authentication_OnPrem"></a>
        <h1>Configuring the On-Prem MFA Agent (including RSA SecurID)</h1>
        <p>The Okta <b>On-Prem MFA agent</b> (formerly named the RSA SecurID agent) acts as a RADIUS client and will communicate with your RADIUS enabled on-prem MFA server, including RSA Authentication manager for RSA SecurIDs. This allows your organization to leverage second factor challenges from a variety of on-premises multifactor authentication tools.</p>
        <p><b>Note</b>: If you are currently using the<b> <![CDATA[ ]]></b><b>RSA SecurID agent</b> (v. 1.1.0 or below) you should upgrade to the <b>On-Prem MFA agent</b> (v. 1.3.0) at your earliest convenience.</p>
        <h2><a name="supported"></a>Supported Operating Systems</h2>
        <p>The Okta <b>On-Prem MFA agent</b> can be installed on the following:</p>
        <ul>
            <li value="1">Windows Server 2003 R2</li>
            <li value="2">Windows Server 2008 R2</li>
            <li value="3">Windows Server 2008 R2 Core â€“ If you are using this version for your installation, please take special note of <b>step 6 </b>under <a href="#installingOnPrem">Installing the Agent</a>.
            </li>
        </ul>
        <h2><a name="begin"></a>Before You Begin</h2>
        <p>Before setting up the <b>On-Prem MFA agent</b> within Okta, set up the RADIUS server settings for your secure OAuth vendor.</p>
        <h2><a name="enabling"></a>Enabling the Agent</h2>
        <p>To enable either of these options, do the following: </p>
        <ol>
            <li value="1">From your<strong> Administrative Dashboard</strong>, select <strong>Security</strong> &gt; <strong>Authentication</strong>.</li>
            <li value="2">Click the<strong> Multifactor</strong> tab.</li>
            <li value="3">Click the <strong>Edit</strong> button in the <strong>Factor Types</strong> section, and select either<strong> RSA SecurID</strong> or <b>Custom</b>.</li>
        </ol>
        <h3>For RSA SecurID</h3><a name="Security_Authentication_RSA"></a>
        <ol>
            <li value="1">Click the <b>RSA SecurID</b> link.</li>
            <li value="2">In the <b>RSA SecurID</b> option, click the <strong>RSA SecurID</strong> tab.</li>
            <li value="3">On the <strong>RSA SecurID</strong> tab, click the <strong>Edit</strong> button in the <strong>RSA SecurID Settings</strong> section.</li>
            <li value="4">Select your <strong>RSA username format</strong>, enter the <strong>Host name</strong>, <strong>Authentication Port</strong>, and <strong>Shared</strong> <strong>Secret</strong>, and then click the <strong>Save</strong> button.</li>
        </ol>
        <ul>
            <li value="1"><b>RSA username format</b>: Select the format expected by RSA.</li>
            <li value="2"><strong>Host name</strong>: The RADIUS server's host name or IP address.</li>
            <li value="3"><strong>Authentication Port</strong>: The RADIUS server port (e.g., 1812). This is defined when the RSA RADIUS server is configured.</li>
            <li value="4"><strong>Shared Secret</strong>: An authentication key that must be defined when the RADIUS server is configured, and must be the same on both the RADIUS client and server.</li>
        </ul>
        <h3>For the Custom Option</h3>
        <p><b>Note</b>: Before continuing, verify that you have obtained the <b>On-Prem MFA agent</b> from Okta Support.</p>
        <ol>
            <li value="1">Click the <b>On-Prem MFA</b> link.</li>
            <li value="2">On the <strong>On-Prem MFA</strong> page, click the <strong>Edit</strong> button in the <strong>On-Prem Multifactor Authentication Settings</strong> section.</li>
            <li value="3">Enter the on-prem provider name.</li>
            <li value="4">Select the preferred provider username format.</li>
            <li value="5">Enter the <strong>Host name</strong>, <strong>Authentication Port</strong>, and <strong>Shared</strong> <strong>Secret </strong>fields.</li>
        </ol>
        <ul>
            <li value="1"><b>Custom On-prem provider name</b>: This is the name that appears to end users during their login challenge.</li>
            <li value="2"><b>Provider Username format</b>: Select the format expected by the provider.</li>
            <li value="3"><strong>Host name</strong>: The OAuth vendor's server host name or IP address.</li>
            <li value="4"><strong>Authentication Port</strong>: The RADIUS server port (e.g., 1812). This is defined when the On-Prem RADIUS server is configured.</li>
            <li value="5"><strong>Shared Secret</strong>: An authentication key that must be defined when the RADIUS server is configured, and must be the same on both the RADIUS client and server.</li>
        </ul>
        <ol start="6">
            <li value="6">Click the <strong>Add New Agent</strong> link.</li>
            <li value="7">Click the <b>Save</b> button.</li>
        </ol>
        <h2><a id="upgrading" name="upgrading"></a>Disabling SSL Pinning</h2>
        <p>The following is applicable only to On-Prem MFA agent versions <b>1.3.0 </b>or later.</p>
        <p><b>Note</b>: For agents on a network containing a web security appliance, it might be necessary to disable SSL pining.</p>
        <ol>
            <li value="1">Open the folder where the Okta RSA agent resides. The default installation folder is <span style="font-family: courier new,courier,monospace;">C:\Program Files (x86)\Okta\Okta RSA Agent\ </span><span style="font-family: arial,helvetica,sans-serif;">OR</span><span style="font-family: courier new,courier,monospace;"> C:\Program Files (x86)\Okta\Okta On-Prem MFA Agent\</span></li>
            <li value="2">From this folder, navigate to <span style="font-family: courier new,courier,monospace;">current\user\config\rsa-securid\config.properties</span>. Before making changes, we recommend creating a back up of this file. Using a text application such a Notepad, open the file <span style="font-family: courier new,courier,monospace;">current\user\config\rsa-securid\config.properties</span> residing in the Okta RSA agent installation folder.</li>
            <li value="3">At the end, append the following line:<span style="font-family: courier new,courier,monospace;"> ragent.ssl.pinning = false</span></li>
            <li value="4">Save the file.</li>
            <li value="5">Restart the <b>Okta On-Prem MFA Agent</b> service using the available Windows administrative tools.</li>
        </ol>
        <h2><a id="installingOnPrem" name="installingOnPrem"></a>Installing the Agent</h2>
        <ol>
            <li value="1">
                <p>Run the<b> On-Prem MFA agent installer</b>.</p>
            </li>
            <li value="2">
                <p>Click <strong>Next </strong>through the "<strong>Important Information</strong>" and "<strong>License Information</strong>" screens.</p>
            </li>
            <li value="3">
                <p>Choose your installation folder and click <strong>Install</strong>.</p>
            </li>
            <li value="4">
                <p>On the <strong>Okta On-Prem</strong><strong> Agent Configuration</strong> screen, enter your <strong>Instance ID. </strong>This is accessible from the <strong>On-Prem Multifactor Authentication</strong> <b>Settings</b> page in the Okta app (see <b>The Custom Option</b> under <a href="#enabling">Enabling the Agent</a> above).</p>
            </li>
            <li value="5"><span id="j_id0:j_id2:j_id103">Configure the settings in the <strong>Register Okta On-Prem MFA Agent</strong> dialog box as follows: </span>
            </li>
        </ol>
        <p style="margin-left: 40px;"><strong>Note:</strong> If setting this up to test on your<strong> Okta Preview Sandbox</strong> org, you'll need to enter the complete URL for your org. For example:<strong><i> https://mycompany.oktapreview.com</i></strong>.</p>
        <p style="margin-left: 40px;">
            <img src="../../Resources/Images/On-Prem_2.jpeg" />
        </p>
        <ol start="6">
            <li value="6">
                <p><b>(Windows Server 2008 R2 Core ONLY</b> Open a browser and add the provided URL into the address field. This authorizes the installer to use Okta.</p>
                <p>
                    <img src="../../Resources/Images/On-Prem_3.jpeg" />
                </p>
            </li>
        </ol>
        <ol start="7">
            <li value="7">Click the <strong>Next</strong> button to continue on to an Okta<strong> Sign In </strong>page.</li>
            <li value="8">
                <p><span>Sign into Okta on the <strong>Sign <span><strong>In</strong></span></strong> screen. </span>
                </p>
            </li>
            <li value="9">
                <p><span>Click the <strong>Allow Access</strong> button.</span>
                </p>
            </li>
            <li value="10">
                <p><span>The confirmation screen appears. <span>Click the <strong>Finish</strong> button to complete the installation.</span></span>
                </p>
            </li>
        </ol>
        <h2><a id="ha" name="ha"></a>Configuring High Availability</h2>
        <p>To configure for high availability by installing an additional On-Prem MFA agent, do the following:</p>
        <ol>
            <li value="1">From your <strong>Administrator Dashboard</strong>, select <strong>Security</strong> &gt; <strong>Authentication</strong> &gt; <strong>RSA SecurID / On-Prem MFA</strong>. <strong> <![CDATA[ ]]></strong></li>
            <li value="2">Click the <strong>Add New Agent</strong> button.</li>
            <li value="3">Download the agent with the provided URL, run the installation file, and enter the provided Instance ID when you are prompted to do so.</li>
        </ol>
        <p style="text-align: right;"><a href="#top">top</a>
        </p>
        <h2><a id="uninstalling_reinstalling" name="uninstalling_reinstalling"></a>Uninstalling and Reinstalling Your Agent</h2>
        <p>When you uninstall a RSA SecurID or On-Prem MFA agent, or reinstall a On-Prem MFA agent, you must decide whether or not you also want to remove the old Okta API token from your system. If you are performing an upgrade, you are not required to do so. To remove the API token, you must delete the <strong>Okta RSA SecurID Agent</strong> or<b> On-Prem MFA Agent</b> folder, and deactivate and remove your old RSA SecurID / On-Prem MFA agent in Okta.</p>
        <p><strong>Note</strong>: To avoid down time, you must have at least two agents running before you uninstall one. See <a href="#ha">Configuring High Availability</a> for more information.</p>
        <p> <![CDATA[ ]]></p>
        <p style="text-align: right;"><a href="#top">top</a>
        </p>
        <h3><a id="uninstallingagent" name="uninstallingagent"></a>Uninstalling Your Agent</h3>
        <p>To uninstall your agent, do the following:</p>
        <ol>
            <li value="1">On your Windows desktop, select <strong>Start</strong> &gt; <strong>Control Panel</strong> &gt; <strong>Programs</strong> &gt; <strong>Programs and Features</strong>.</li>
            <li value="2">Select the appropriate agent, and then select <strong>Uninstall</strong>.</li>
            <li value="3">From your <strong>Administrator Dashboard</strong>, select <strong>Security</strong> &gt; <strong>Authentication</strong> &gt; <strong>RSA SecurID / On-Prem MFA</strong>.</li>
            <li value="4">Click the <strong>Deactivate</strong> button for the agent you want to deactivate and then click the <strong>Delete</strong> button to remove it from your system.</li>
            <li value="5">Uninstalling your On-Prem MFA agent leaves the agent configuration data on your hard drive. To remove the configuration data, go to <span style="font-family: courier new,courier,monospace;"><i>\Program Files (x86)\Okta</i><![CDATA[  ]]></span>and delete the <strong>Okta RSA SecurID Agent</strong> or<b> On-Prem MFA</b> folder. Deleting this folder removes the agent configuration data and the API token from your hard drive. The API token for the server is still valid in Okta so it is important to remove the configuration data.</li>
        </ol>
        <p style="text-align: right;"><a href="#top">top</a>
        </p>
        <h3><a id="reinstallingagent" name="reinstallingagent"></a>Reinstalling Your Agent</h3>
        <p>Installing the agent does not overwrite the configuration data in the<b> On-Prem MFA</b> <strong>Agent</strong> folders. If you want to reinstall and create a new API token, make sure you delete the<b> On-Prem MFA </b><strong>Agent</strong> folder, (as described above) before you reinstall the agent. Then perform the following steps to reinstall your agent, then deactivate and remove the old one in Okta:</p>
        <ol>
            <li value="1">
                <p>Perform the procedure described in<b> Installing the On-Prem MFA Agent</b> above.</p>
            </li>
            <li value="2">
                <p>From your <strong>Administrator Dashboard</strong>, select <strong>Security </strong>&gt;<strong> Authentication</strong> and then select the <strong>RSA SecurID <b>/</b><![CDATA[  ]]></strong><b>On-Prem MFA</b> tab. </p>
            </li>
            <li value="3">
                <p>Under <strong>Agents</strong>, there is a list of your agents. Confirm that your reinstalled agent is connected to Okta and appears in the list. You should always make sure to have at least one of the agents online.</p>
                <p>If you are performing an upgrade or reinstallation and do not wish to revoke the Okta API token of the old agent, you are finished. Otherwise, proceed to the next step.</p>
            </li>
            <li value="4">Under <strong>Agents</strong>, click the <strong>Deactivate</strong> button for the agent you want to deactivate, then test your system to ensure that it is working properly.</li>
            <li value="5">Select <strong>Security</strong> &gt; <strong>API</strong>, and then click the trash can icon next to the appropriate agent token. See <a href="API.htm#apiTokens">API Tokens</a> for more information.</li>
            <li value="6">Select <strong>Security </strong>&gt;<strong> Authentication</strong> and then select the <strong>RSA SecurID / On-Prem MFA</strong> tab again.</li>
            <li value="7">Click the <strong>Delete</strong> button to remove the agent from your system.</li>
        </ol>
        <p>&#160;</p>
        <script type="text/javascript" src="../../SkinSupport/MadCapBodyEnd.js">
        </script>
    </body>
</html>