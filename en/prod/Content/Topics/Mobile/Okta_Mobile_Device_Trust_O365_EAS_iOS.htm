<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_okta_html5_topnav" data-mc-search-type="Stem" data-mc-help-system-file-name="okta_help.xml" data-mc-path-to-help-system="../../../" data-mc-has-content-body="True" data-mc-searchable="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="">
    <head>
        <meta name="typeofcontent" content="documentation" />
        <meta name="audience" content="admin" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta charset="utf-8" />
        <meta name="description" content="" />
        <meta name="author" content="" /><title>Enforce Okta Device Trust for Exchange ActiveSync on OMM-managed iOS devices</title>
        <link rel="shortcut icon" href="../../Resources/Images/favicon.ico" type="image/x-icon" />
        <script>/* <![CDATA[ */
			(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
			(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
			})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

			ga('create', 'UA-15777010-10', 'auto');
			ga('send', 'pageview');

		/* ]]> */</script>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/okta-main.css" rel="stylesheet" />
        <style>/*&lt;meta /&gt;*/

.button.expand-all-button
{
	-pie-background: url('../../../Skins/Default/Stylesheets/Images/expand-all-non-hover-sm.png') no-repeat center center, linear-gradient(#fff, #fff);
}

.button.collapse-all-button
{
	-pie-background: url('../../../Skins/Default/Stylesheets/Images/collapse-all-non-hover-sm.png') no-repeat center center, linear-gradient(#fff, #fff);
}

.needs-pie
{
	behavior: url('../../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.6.2.3_custom.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div>
                        <nav class="title-bar tab-bar" data-mc-ignore="true">
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <button class="menu-icon" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../ReleaseNotes/okta-relnotes.htm" alt="Okta"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" placeholder="Search" />
                                                <div class="search-filter-wrapper">
                                                    <div class="search-filter">
                                                        <div class="search-filter-content">
                                                            <ul>
                                                                <li>All Files</li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search">
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <section class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <div class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </div>
                            <div class="body-container" data-mc-content-body="True">
                                <div class="LeftRightTopRow">
                                    <div>
                                        <div class="is-not-in-mobile">
                                        </div>
                                        <div class="toolbar-main">
                                            <div class="buttons popup-container clearfix topicToolbarProxy _Skins_okta_toolbar mc-component nocontent" style="mc-topic-toolbar-items: ;">
                                                <div class="button-group-container-left">
                                                    <button class="button needs-pie expand-all-button" data-state1-class="expand-all-button" data-state2-class="collapse-all-button" data-state2-title="Collapse all" title="Expand all" data-state1-title="Expand all">
                                                        <img src="../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="expand all" />
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div>
                                        <p />
                                    </div>
                                </div>
                                <div class="LeftRightMenu">
                                    <div>
                                        <div class="body-main">
                                            <p class="earlyaccess"><span class="okta-variablesEarlyAccess">This is an <a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ #text">Early Access<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>Early Access (EA) features are opt-in features that you can try out in your org by asking Okta Support to enable them. Additionally, the Features page in the Okta Admin Console (Settings &amp;gt; Features) allows Super Admins to enable and disable some EA features themselves.</span></a> feature. To enable it, please contact Okta Support.</span>
                                            </p>
                                            <h1><a name="top"></a>Enforce Okta Device Trust for Exchange ActiveSync on OMM-managed iOS devices</h1>
                                            <hr width="100%" size="0" align="center" />
                                            <p />
                                            <p>This Okta Device Trust solution for Microsoft Office 365 EAS on <a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">OMM<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>An acronym for Okta Mobility Management. OMM enables you to manage your users' mobile devices, applications, and data. Your users enroll in the service and can then download and use managed apps from the Apps Store. Managed apps are typically work-related, such as Box or Expensify. As an administrator, you can remove managed apps and associated data from users' devices at any time. You can configure policies, such as data sharing controls, on any of your managed apps. See Configuring Okta Mobility Management for more information.</span></a>&#160;managed iOS&#160;devices allows you to do the following: </p>
                                            <ul>
                                                <li value="1">Configure the iOS mail <a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">app<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>An abbreviation of application. Essentially, it is a web-based site used to perform any number of specific tasks, and requires authentication from end users by signing in.</span></a> to use certificates instead of passwords to allow <b>OMM-enrolled</b> <a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">users<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>In Okta literature, we generally refer to "users" as the people who serve as Okta administrators. When we refer to "end users" we are generally referring to the people who the administrators serve. That is, those who use Okta chiclets to access their apps, but have no administrative control.</span></a> to authenticate to <b>Microsoft Office 365 Exchange ActiveSync</b>.</li>
                                                <li value="2">Configure iOS mail app <a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">client<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>Essentially, a client is anything that talks to the Okta service. Within the traditional client-server model, Okta is the server. The client might be an agent, an Okta mobile app, or a browser plugin. </span></a> access policy to prevent users with unmanaged devices from accessing Microsoft Office 365 Exchange ActiveSync.</li>
                                            </ul>
                                            <div style="line-height:150%;">
                                                <br />
                                            </div>
                                            <hr width="100%" size="0" align="center" />
                                            <div class="MCDropDown MCDropDown_Open dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Diagram — profile and certificate flow</a></span>
                                                <div class="MCDropDownBody dropDownBody">
                                                    <p>
                                                        <img src="../../Resources/Images/EAS_DT_O365_flow3.png" />
                                                    </p>
                                                </div>
                                            </div>
                                            <div style="line-height:150%;">
                                                <br />
                                            </div>
                                            <hr width="100%" size="0" align="center" />
                                            <div class="MCDropDown MCDropDown_Open dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Key benefits</a></span>
                                                <div class="MCDropDownBody dropDownBody">
                                                    <ul>
                                                        <li value="1">Allows <a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">end users<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>In Okta literature, we generally refer to "end users" as the people who have their own Okta home page (My Applications), using chiclets to authenticate into all of their apps. End users do not have any administrative control. When we refer to "users" we are generally referring to the individual(s) who have administrative control.</span></a> to seamlessly <a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">SSO<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>An acronym for single sign-on. In a SSO system, a user logs in once to the system and can access multiple systems without being prompted to sign in for each one. Okta is a cloud-based SSO platform that allows users to enter one name and password to access multiple applications. Users can access all of their web applications, both behind the firewall and in the cloud, with a single sign in. Okta provides a seamless experience across PCs, laptops, tablets, and smartphones.</span></a> in to their native iOS mail app (EAS) from OMM-enrolled iOS devices</li>
                                                        <li value="2">Enhances Office 365 ActiveSync security through enforcement of certificate-based authentication instead of password authentication</li>
                                                        <li value="3">
                                                            <p>Prevents users with unmanaged iOS devices from accessing Office365</p>
                                                        </li>
                                                        <li value="4">Helps prevent users from becoming locked-out of their account due to Active Directory (AD) password resets</li>
                                                    </ul>
                                                </div>
                                            </div>
                                            <div style="line-height:150%;">
                                                <br />
                                            </div>
                                            <hr width="100%" size="0" align="center" />
                                            <div class="MCDropDown MCDropDown_Open dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Requirements</a></span>
                                                <div class="MCDropDownBody dropDownBody">
                                                    <ul>
                                                        <li value="1">
						An Office 365 tenant federated to an Okta <a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">org<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>The Okta container that represents a real-world organization.</span></a> with at least one license for Exchange Online
					</li>
                                                        <li value="2">
						A Windows computer to run PowerShell commands
</li>
                                                        <li value="3">Azure PowerShell 5.0 (64-bit)</li>
                                                        <li value="4">
					An iOS 9 (or higher) device</li>
                                                    </ul>
                                                </div>
                                            </div>
                                            <div style="line-height:150%;">
                                                <br />
                                            </div>
                                            <hr width="100%" size="0" align="center" />
                                            <div class="MCDropDown MCDropDown_Open dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage" style="font-weight: bold;"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Procedure</a></span>
                                                <div class="MCDropDownBody dropDownBody">
                                                    <p>This procedure has three parts: </p>
                                                    <div class="MCDropDown MCDropDown_Open dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" /></a><a name="PartA"></a><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_">Part Ⓐ — Enable ActiveSync certificate-based authentication in Office 365</a></span>
                                                        <div class="MCDropDownBody dropDownBody">
                                                            <p><b><i style="color: #ff4500;">Important</i>:</b> Do not click <b>Save</b> at the end of Step 1. You will save changes in Part Ⓑ.</p>
                                                            <ol>
                                                                <li value="1"><a name="FromOktaAdminConsole"></a>From the Okta <a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">Admin<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>An abbreviation of administrator. This is the individual(s) who have access to the Okta Administrator Dashboard. They control the provisioning and deprovisioning of end users, the assigning of apps, the resetting of passwords, and the overall end user experience. Only administrators have the Administration button on the upper right side of the My Applications page.</span></a> Console, prepare to enable certificate distribution for OMM and download the Okta root certificate:
								<p><b>Note:</b> If you have set up <b>multiple Office 365 app instances</b> in your org, note that Okta generates a different Okta CA certificate for each Office 365 app instance/<a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">domain<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>A domain is an attribute of an Okta organization. Okta uses a fully-qualified domain name, meaning it always includes the top-level domain (.com, .eu, etc.), but does not include the protocol (https).</span></a>. This means that you must upload a separate root certificate for each Office 365 app instance/domain that you want to configure with certificate based authentication.</p><ol style="list-style-type: lower-alpha;"><li value="1">Go to <b>Applications</b> and click the <b>Office 365</b> app instance.</li><li value="2">Go to the <b>Mobile</b> tab, scroll down to the <b>Exchange ActiveSync Settings</b> and click <b>Edit</b>.
									<a href="javascript:void(0);" class="MCToggler MCTogglerHead MCTogglerHotSpot MCToggler_Open toggler MCTogglerHotSpot_ MCHotSpotImage" style="color: #0000ff;" data-mc-targets="DT_EAS_CBA"><img class="MCToggler_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Screenshot</a><p style="display: none;" data-mc-target-name="DT_EAS_CBA"><img src="../../Resources/Images/EAS_CBA_O365.png" /></p></li><li value="3">Select <b>Enable Exchange ActiveSync</b>.</li><li value="4">Enter a profile name.</li><li value="5">Select <b>Enable certificate-based authentication for iOS</b>.</li><li value="6">Click <b>Download root certificate</b>.
									</li><li value="7">For use later in this procedure, copy and paste the <b>Certificate Revocation List URL</b> and the <b>Delta Certificate Revocation List URL</b> into a text editor.
							<a href="javascript:void(0);" class="MCToggler MCTogglerHead MCTogglerHotSpot MCToggler_Open toggler MCTogglerHotSpot_ MCHotSpotImage" style="color: #0000ff;" data-mc-targets="DT_EAS_CRL_DCRL_first"><img class="MCToggler_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Screenshot</a><p><img src="../../Resources/Images/EAS_CBA_O365_CLR-DRL_450x197.png" style="width: 450;height: 197;display: none;" data-mc-target-name="DT_EAS_CRL_DCRL_first" /></p></li><li value="8"><a name="Stop_dontclicksave"></a><b><u style="color: #ff4500;">Stop:</u></b> Do <u style="color: #ff4500;">not</u> click <b>Save</b> yet. You must complete the PowerShell actions detailed in <a href="#FromWinCLI">Step 2</a> before you save your Exchange ActiveSync settings. If you save  now and then encounter a problem when enabling ActiveSync Cert Based Authentication in Office 365, your users may not be able to access their mail app.</li></ol></li>
                                                                <li value="2"><a name="FromWinCLI"></a>From a Windows command line, enable ActiveSync Cert Based Authentication in Office 365:
					
								<ol style="list-style-type: lower-alpha;"><li value="1"><a name="Launch"></a>Launch <b>Azure PowerShell 5.0</b> (64-bit) as an Administrator.
						
						
									<p><b><i style="color: #ff4500;">Important</i>:</b> An error message appears if you try to use the x86 (32-bit) version of PowerShell.</p></li><li value="2"><p>Issue the following command to install the <b>AzureAD</b> module for PowerShell:</p><p><span style="font-family: 'Courier New';">Install-Module -Name AzureAD –RequiredVersion 2.0.0.33</span></p><ul><li value="1">If the message <i>NuGet provider is required to continue</i> appears, click <b>Yes</b> to install and import <b>NuGet provider</b>.</li><li value="2">If the message <i>Untrusted repository</i> appears, click <b>Yes to All</b> to install the required modules.</li></ul></li><li value="3">In PowerShell, issue the following command to connect to your Azure AD tenant and authenticate to Office 365:
						
						
									<p><span style="font-family: 'Courier New';">Connect-AzureAD</span></p></li><li value="4"><p>Enter your Office 365 credentials in the <b>Azure Active Directory</b> sign-in screen.</p></li><li value="5">To create the necessary PowerShell variables, issue the following commands in PowerShell:
								
								
								
									<p style="font-family: 'Courier New';">$cert=Get-Content -Encoding byte "<i>LOCATION OF YOUR CER FILE\filename.cer</i>"</p><p>Make sure to replace <i style="font-family: 'Courier New';">LOCATION OF YOUR CER FILE\filename.cer</i> with the path and filename of your *.cer file.</p><p style="font-family: 'Courier New';">$new_ca=New-Object -TypeName Microsoft.Open.AzureAD.Model.CertificateAuthorityInformation</p><p style="font-family: 'Courier New';">$new_ca.AuthorityType=0</p><p style="font-family: 'Courier New';">$new_ca.TrustedCertificate=$cert</p></li><li value="6">To enable certificate revocation in Office 365, issue the following commands, making sure to paste the revocation URLs that you saved earlier: <span style="color: #0000ff;"><a href="javascript:void(0);" class="MCToggler MCTogglerHead MCTogglerHotSpot MCToggler_Open toggler MCTogglerHotSpot_ MCHotSpotImage" style="color: #0000ff;" data-mc-targets="DT_EAS_CRL_DCRL"><img class="MCToggler_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Screenshot</a></span><p><img src="../../Resources/Images/EAS_CBA_O365_CLR-DRL_450x197.png" style="width: 450;height: 197;display: none;" data-mc-target-name="DT_EAS_CRL_DCRL" /></p><p style="font-family: 'Courier New';">$new_ca.crlDistributionPoint = "<i>CERTIFICATE REVOCATION LIST URL</i>"</p><p>Replace <span style="font-family: 'Courier New'; font-style: italic;">CERTIFICATE REVOCATION LIST URL</span> with the <b>Certificate Revocation list URL</b> that you saved earlier.</p><p style="font-family: 'Courier New';">$new_ca.deltaCrlDistributionPoint = "<i>DELTA CERTIFICATE REVOCATION LIST URL</i>"</p><p>Replace <span style="font-family: 'Courier New'; font-style: italic;">DELTA CERTIFICATE REVOCATION LIST URL</span> with the <b>Delta Certificate Revocation list URL</b> that you saved earlier.</p></li><li value="7">To add the appropriate certificate authority in Office 365, issue the following command:
									<p style="font-family: 'Courier New';">New-AzureADTrustedCertificateAuthority -CertificateAuthorityInformation $new_ca</p></li><li value="8">To confirm that the certificate authority was added to Office 365, issue the following command:
					
									<p style="font-family: 'Courier New';">Get-AzureADTrustedCertificateAuthority</p><p><span style="color: #0000ff;"><a href="javascript:void(0);" class="MCToggler MCTogglerHead MCTogglerHotSpot MCToggler_Open toggler MCTogglerHotSpot_ MCHotSpotImage" style="color: #0000ff;" data-mc-targets="DT_EAS_CLI"><img class="MCToggler_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Screenshot</a></span><img src="../../Resources/Images/EAS_Cert_Install_CLI_867x361.png" style="width: 867;height: 361;display: none;" data-mc-target-name="DT_EAS_CLI" /></p></li><li value="9">(Optional) Issue the following commands to help troubleshoot your configuration, if necessary:
							<ul><li value="1"><p>If you want to add the existing Certificate Authorities to a variable:</p><p style="font-family: 'Courier New';">$c=Get-AzureADTrustedCertificateAuthority</p></li><li value="2"><p>If you want to remove a Certificate Authority, issue the following command and choose the correct certificate. Numbering begins at <span style="font-family: 'Courier New';">0</span> (zero). For example, to remove the first certificate, enter <span style="font-family: 'Courier New';">0</span> as shown below:</p><p style="font-family: 'Courier New';">Remove-AzureADTrustedCertificateAuthority -CertificateAuthorityInformation $c[0]</p></li></ul></li></ol></li>
                                                                <li value="3"><b><i style="color: #ff4500;">Important</i>:</b> Tell your end users how the above configuration may affect their device and mail account. For details, carefully review the section <a href="#KnownIssues">Known Issues</a>.
						
							</li>
                                                            </ol>
                                                            <br />
                                                        </div>
                                                    </div>
                                                    <div style="line-height:150%;">
                                                        <br />
                                                    </div>
                                                    <div class="MCDropDown MCDropDown_Open dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" /></a><a name="PartB"></a><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_">Part Ⓑ — Distribute certificates for EAS to OMM-enrolled devices</a></span>
                                                        <div class="MCDropDownBody dropDownBody">
                                                            <ol>
                                                                <li value="1">Make sure to advise your end users to remove any <a href="#KnownIssues">manually-configured EAS profiles</a> that may be installed on their device.</li>
                                                                <li value="2">In the Okta Admin Console, return to the <b>Exchange ActiveSync Settings</b> dialog box and click <b>Save</b>.</li>
                                                                <li value="3">Click <b>Save</b> in the <b>Confirm Exchange ActiveSync</b> changes message.</li>
                                                            </ol>
                                                        </div>
                                                    </div>
                                                    <div style="line-height:150%;">
                                                        <br />
                                                    </div>
                                                    <div class="MCDropDown MCDropDown_Open dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" /></a><a name="PartC"></a><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_">Part Ⓒ — (Optional) Prevent unmanaged devices from accessing Office 365 email using the iOS Mail app (EAS)</a></span>
                                                        <div class="MCDropDownBody dropDownBody">
                                                            <br />
                                                            <p><b>Note:</b> Only configure Part C if your users have been notified to enroll in Okta Mobility Management.</p>
                                                            <ol>
                                                                <li value="1">Configure the Office 365 client access policy:
								<a href="javascript:void(0);" class="MCToggler MCTogglerHead MCTogglerHotSpot MCToggler_Open toggler MCTogglerHotSpot_ MCHotSpotImage" style="color: #0000ff;" data-mc-targets="DT_CLIENTACCESS"><img class="MCToggler_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Screenshot</a><p><img src="../../Resources/Images/ClientAccessPolicies_DT_EAS_iOS.png" style="display: none;" data-mc-target-name="DT_CLIENTACCESS" /></p><ol style="list-style-type: lower-alpha;"><li value="1">
										In Okta, go to <b>Applications</b> and click the Office 365 app instance.
									</li><li value="2">
										Click the <b>Sign On</b> tab, scroll down to the <b>Sign On Policy</b>, and click <b>Add Rule</b>.
									</li><li value="3">
										Enter a name for the rule and apply it to the appropriate group or users.
									</li><li value="4">
										In the <b>Client</b> section, select <b>Mobile (Exchange ActiveSync)</b> and <b>iOS</b>.
									</li><p><b>Important:</b> Make sure the other options  are <u>not</u> selected.
									</p><li value="5">In the <b>Actions</b> section, change the <b>Access</b> setting for <b>When all the conditions above are met, sign on to this application is</b> to <b>Denied</b>.
									</li><li value="6">
										Click <b>Save</b>.
							</li></ol></li>
                                                                <li value="2">
								Using an OMM-enrolled iOS device, verify the Device Trust configuration:
								<ol style="list-style-type: lower-alpha;"><li value="1">
										Ensure that the OMM-enrolled iOS device is covered by an appropriate Okta mobile policy.
									</li><li value="2">
										Launch the native iOS mail app and confirm that email works without the need to authenticate to Office 365.
									</li><li value="3">
										Manually create an EAS mail account on the native iOS mail app to confirm that Okta is blocking manually-configured email accounts.
							</li></ol></li>
                                                            </ol>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="line-height:150%;">
                                                <br />
                                            </div>
                                            <hr width="100%" size="0" align="center" />
                                            <div class="MCDropDown MCDropDown_Open dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Known Issues</a><a name="KnownIssues"></a></span>
                                                <div class="MCDropDownBody dropDownBody">
                                                    <ul>
                                                        <li value="1"><b>Continuous password prompt caused by duplicate EAS profiles</b> — iOS 9.3 and iOS 10.2 device users who manually configure the native iOS mail app before enrolling in OMM will have duplicate EAS profiles on their device after OMM enrollment pushes a certificate-based profile to their device automatically. On <b>iOS 9.3</b> devices, this duplication may cause confusion. On <b>iOS 10.2</b> devices, in addition to the profile duplication issue, the manually-configured profile does not receive email and <u>continuously prompts for a password</u>. To address these issues, we recommend that you advise your users to delete the manually-configured profile from their device. As shown in this <a href="javascript:void(0);" class="MCToggler MCTogglerHead MCTogglerHotSpot MCToggler_Open toggler MCTogglerHotSpot_ MCHotSpotImage" style="color: #0000ff;" data-mc-targets="DupProfiles"><img class="MCToggler_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />example</a>, the password prompt appears continuously.<p style="display: none;" data-mc-target-name="DupProfiles"><img src="../../Resources/Images/Duplicate EAS-profiles.gif" /></p></li>
                                                        <li value="2">Currently, this feature supports only the native iOS mail app on iOS devices.</li>
                                                        <li value="3">
                                                            <p><b>Users may be prompted for credentials</b> — If you unassign and then reassign a CBA-configured <b>Office 365</b> app instance to users or <a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">groups<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>Groups allow you to organize your end users and the apps they can access. Assigning apps to large sets of end users is made easier with groups.</span></a>, users trying to access the EAS-enabled native iOS mail client are prompted to enter their credentials. Even after entering credentials, users still receive the message <i>Cannot Get Mail</i>. Users may need to wait up to several hours before they can access email.</p>
                                                        </li>
                                                        <li value="4"><b>Block access to Outlook for iOS or Android</b> — If you don't want your end users to access Outlook for iOS or Android, you can block access as described in the Microsoft article <a href="https://technet.microsoft.com/en-us/library/mt465747(v=exchg.150).aspx">Enabling Outlook for iOS and Android in Exchange Online</a>. Scroll down to <i>Blocking Outlook for iOS and Android</i>.</li>
                                                        <li value="5">
                                                            <p><b>CRL cache must refresh</b> — When Okta revokes a certificate — or if the trusted root CA certificate is removed from Exchange Online/O365/Azure AD — CBA EAS-enabled devices using the certificate can still access email until the next time Office 365 invalidates the Certificate Revocation List (CRL) cache and refreshes the CRL. When the cache is refreshed, Microsoft denies the device access to email. Microsoft cache expires once every 24 hours, or whenever the device switches to a different Wi-Fi network.</p>
                                                        </li>
                                                        <li value="6"><b>More than one OS type in the header when using the Outlook mail app</b> — When Okta receives a request from the Outlook Mail app on iOS and Android devices, the header contains both iOS and Android, which prevents Okta from precisely identifying the OS type. To ensure that the client access policy is applied in this case, select the <b>Others</b> option in the <b>Mobile (Exchange ActiveSync)</b> client access policy. For more information, see <a href="https://support.okta.com/help/Documentation/Knowledge_Article/Getting-Started-with-Office-365-Client-Access-Policies#ClientAccessPolicies">Configuring Rules for Office 365 Client Access Policies</a>.</li>
                                                    </ul>
                                                </div>
                                            </div>
                                            <div style="line-height:150%;">
                                                <br />
                                            </div>
                                            <hr width="100%" size="0" align="center" />
                                            <div class="MCDropDown MCDropDown_Open dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Related Topics</a></span>
                                                <div class="MCDropDownBody dropDownBody">
                                                    <p><a href="device-trust-overview.htm">Device Trust</a>
                                                    </p>
                                                    <p><a href="../Apps/Apps_Apps.htm#EAS">Configuring Microsoft Exchange ActiveSync (EAS)</a>
                                                    </p>
                                                    <p><a href="../Security/O365_Client-Access-Policies.htm">Office 365 Client Access Policies</a>
                                                    </p>
                                                    <p><a href="Apps_OMM.htm">Configuring Okta Mobility Management</a>
                                                    </p>
                                                    <p><a href="https://support.okta.com/help/Documentation/Knowledge_Article/27719248-About-Microsoft-Office-365-Provisioning">About Microsoft Office 365 Provisioning</a>
                                                    </p>
                                                    <p><a href="../Apps/Office365/Apps_Okta_Enhancements_Office_365_Integration.htm">Okta Enhancements with Microsoft Office 365 Integration</a>
                                                    </p>
                                                </div>
                                            </div><a href="#" class="sf-back-to-top"><span class="arrow"></span>Top</a>
                                        </div>
                                    </div>
                                    <div>
                                        <div data-sticky-container="" id="8kEdyXUqp0-7EMmvoZN0_Q">
                                            <div class="sticky sticky-menu" style="width:100%" data-sticky="" data-top-anchor="8kEdyXUqp0-7EMmvoZN0_Q:top" data-bottom-anchor="contentBody:bottom" data-scroll-container=".body-container" data-sticky-on="only screen and (min-width: 1025px)" data-scroll-container-on="only screen and (min-width: 1025px)">
                                                <ul class="nocontent menu _Skins_okta_side_menu mc-component" data-mc-is-context-sensitive="True" data-mc-linked-toc="Data/BrowseSequences/BrowseSequences__secondary.js" data-mc-side-menu="True" data-mc-max-depth="1" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="False" data-mc-include-parent="True" data-mc-toc="True">
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="Footer">
                                    <div>
                                        <p class="copyright">© Copyright <span class="okta-variablesYear">2019</span> <span class="okta-variablesCompanyName">Okta, Inc</span></p>
                                    </div>
                                </div>
                                <script src="../../Resources/Scripts/js/app.js">
                                </script>
                                <!-- <script src="../../Resources/Scripts/js/vendor/jquery.js"></script> -->
                                <script src="../../Resources/Scripts/js/vendor/what-input.js">
                                </script>
                                <script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/6.4.4-rc1/js/foundation.min.js">
                                </script>
                                <script type="text/javascript" src="../../Resources/Scripts/back-to-top.js">
                                </script>
                                <script type="text/javascript" src="../../Resources/Scripts/get-feedback.js">
                                </script>
                            </div>
                        </div>
                    </section><a data-close="true"></a>
                </div>
            </div>
            <script>/* <![CDATA[ */$(document).foundation();/* ]]> */</script>
        </div>
    </body>
</html>