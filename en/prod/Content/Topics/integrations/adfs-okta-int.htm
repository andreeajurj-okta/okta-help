<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_okta_html5_topnav" data-mc-search-type="Stem" data-mc-help-system-file-name="okta_help.xml" data-mc-path-to-help-system="../../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta charset="utf-8" />
        <meta name="description" content="" />
        <meta name="author" content="" /><title>Okta MFA for Active Directory Federation Services (ADFS)</title>
        <link rel="shortcut icon" href="../../Resources/Images/favicon.ico" type="image/x-icon" />
        <script>/* <![CDATA[ */
			(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
			(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
			})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

			ga('create', 'UA-15777010-10', 'auto');
			ga('send', 'pageview');

		/* ]]> */</script>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/okta-relnotes.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/okta-docs-custom.css" rel="stylesheet" />
        <style>/*&lt;meta /&gt;*/

.button.expand-all-button
{
	-pie-background: url('../../../Skins/Default/Stylesheets/Images/expand-all-non-hover-sm.png') no-repeat center center, linear-gradient(#fff, #fff);
}

.button.collapse-all-button
{
	-pie-background: url('../../../Skins/Default/Stylesheets/Images/collapse-all-non-hover-sm.png') no-repeat center center, linear-gradient(#fff, #fff);
}

.needs-pie
{
	behavior: url('../../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.6.2.3_custom.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (min-width: 1025px)" data-mc-ignore="true">
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <button class="menu-icon" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../ReleaseNotes/okta-relnotes.htm" alt="Okta"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" placeholder="Search" />
                                                <div class="search-filter-wrapper">
                                                    <div class="search-filter">
                                                        <div class="search-filter-content">
                                                            <ul>
                                                                <li>All Files</li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search">
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <section class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <div class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </div>
                            <div class="body-container" data-mc-content-body="True">
                                <div class="TopBarLeftRight">
                                    <div>
                                        <p>left</p>
                                    </div>
                                    <div>
                                    </div>
                                    <div>
                                        <p>right</p>
                                    </div>
                                </div>
                                <div class="LeftRightMenu">
                                    <div>
                                        <ul class="nocontent menu _Skins_okta_relnote_menu mc-component" data-mc-linked-toc="Data/Tocs/okta_relnotesTOC.js" data-mc-side-menu="True" data-mc-max-depth="2" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="False" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        </ul>
                                    </div>
                                    <div>
                                        <div class="toolbar-main">
                                            <div class="buttons popup-container clearfix topicToolbarProxy _Skins_okta_toolbar mc-component nocontent" style="mc-topic-toolbar-items: ExpandAll CollapseAll;">
                                                <div class="button-group-container-left">
                                                    <button class="button needs-pie expand-all-button" data-state1-class="expand-all-button" data-state2-class="collapse-all-button" data-state2-title="Collapse all" title="Expand all" data-state1-title="Expand all">
                                                        <img src="../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="expand all" />
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <p class="earlyaccess">This is an Early Access feature. To enable it, please contact <a href="https://support.okta.com/">Okta Support</a>.</p>
                                        <h1>Okta MFA for Active Directory Federation Services (ADFS) </h1>
                                        <p>The guide below outlines the setup process to install the Okta Multifactor Authentication (MFA) provider for Active Directory Federation Services (ADFS) v. 3.0 and v 4.0. With this feature, customers can use ADFS as their Identity Provider (<a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">IdP<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>An acronym for Identity Provider. It is a service that manages end user accounts analogous to user directories such as LDAP and Active Directory, and can send SAML responses to SPs to authenticate end users. Within this scenario, the IdP is Okta.</span></a>) to applications and also use Okta for MFA to provide a strong method of authentication for your applications. Please see the list of prerequisites and assumptions before starting the install process. This feature supports all <a href="../Security/MFA.htm#FactorTypes">Okta supported MFA factors</a>. For information on enabling TLS 1.2 in .NET and in Microsoft Internet Explorer browsers, see <a href="../Miscellaneous/okta-ends-browser-support-for-TLS-1.1.htm">Okta ends browser support for TLS 1.1</a>. </p>
                                        <div class="MCDropDown MCDropDown_Open dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Part 1 – Preconfiguration: Configure MFA Factor Enrollment in Okta</a></span>
                                            <div class="MCDropDownBody dropDownBody">
                                                <p>Before beginning the installation, be sure the MFA Factors to use with ADFS are configured in Okta. </p>
                                                <p><b>Note</b>: You can skip this step if you have already configured factor enrollment.</p>
                                                <ol>
                                                    <li value="1">Login to your Okta <a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">org<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>The Okta container that represents a real-world organization.</span></a>.</li>
                                                    <li value="2">Navigate to <b>Security &gt; Multifactor</b>.</li>
                                                    <li value="3">Select the <b>Factor Types</b> tab, then select the factors you want to enable in your org.
					<img src="../../Resources/Images/okta-adfs1.png" /></li>
                                                    <li value="4">Select the <b>Factor Enrollment</b> tab and set up a policy to prompt for MFA (this can be scoped to <a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">users<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>In Okta literature, we generally refer to "users" as the people who serve as Okta administrators. When we refer to "end users" we are generally referring to the people who the administrators serve. That is, those who use Okta chiclets to access their apps, but have no administrative control.</span></a> who will need to provide MFA for ADFS&#160;logins).
                  <p><img src="../../Resources/Images/okta-adfs2.png" /></p><p><img src="../../Resources/Images/okta-adfs3.png" /></p></li>
                                                </ol>
                                            </div>
                                        </div>
                                        <div class="MCDropDown MCDropDown_Open dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" /></a><a name="Part"></a><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_">Part 2 – Create the Microsoft ADFS (MFA) app in Okta</a></span>
                                            <div class="MCDropDownBody dropDownBody">
                                                <ol>
                                                    <li value="1">Login into your Okta org as an administrator. </li>
                                                    <li value="2">Navigate to <b>Applications &gt; Applications</b>, then click <b>Add Application</b>.
					<p><img src="../../Resources/Images/okta-adfs4.png" /></p></li>
                                                    <li value="3">Search for the <b>Microsoft ADFS (MFA)</b> application application, then click <b>Add</b>.
                    
                       <p> <img src="../../Resources/Images/okta-adfs5.png" /></p></li>
                                                    <li value="4">
                                                        <p>On the <b>General</b> tab for the Microsoft ADFS&#160;<a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">app<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>An abbreviation of application. Essentially, it is a web-based site used to perform any number of specific tasks, and requires authentication from end users by signing in.</span></a>, specify an <b>Application Label</b> relevant to your organization, then click <b>Next</b>.</p>
                                                    </li>
                                                    <li value="5">Skip the <b>Assign to People</b> page for now, you'll return to this after making a few application modifications.                  </li>
                                                </ol>
                                            </div>
                                        </div>
                                        <div class="MCDropDown MCDropDown_Open dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" /></a><a name="Part3"></a><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_">Part 3 – Enable Cross-Origin Resource Sharing (CORS) in your Okta org</a></span>
                                            <div class="MCDropDownBody dropDownBody">
                                                <p><b>Note</b>:&#160;For more information about CORS, see <a href="https://developer.okta.com/docs/api/getting_started/enabling_cors.html">CORS Overview</a>.</p>
                                                <ol>
                                                    <li value="1">Login to your Okta org.</li>
                                                    <li value="2">Navigate to <b>Security &gt; API</b>.</li>
                                                    <li value="3">Select the <b>Trusted Origins</b> tab, then click <b>CORS</b>.
					<p><img src="../../Resources/Images/okta-adfs6.png" /></p></li>
                                                    <li value="4"><b>Select Add Origin</b>.</li>
                                                    <li value="5">Enter the following information:
					<ul><li value="1"><p><b>Name</b></p></li><li value="2"><p><b>Origin URL</b>: This can be your ADFS service name.</p></li><li value="3"><p>Check the box for CORS <b>Type</b>, then click <b>Save</b>.</p></li></ul><p><img src="../../Resources/Images/okta-adfs7.png" /></p></li>
                                                </ol>
                                            </div>
                                        </div>
                                        <div class="MCDropDown MCDropDown_Open dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" /></a><a name="Part2"></a><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_">Part 4 – Install the Okta ADFS Plug on your ADFS Server</a></span>
                                            <div class="MCDropDownBody dropDownBody">
                                                <ol>
                                                    <li value="1">
                                                        <p>The Okta ADFS Plugin is available at <a href="https://okta.oktapreview.com/static/adfs/OktaADFSAdapter-1.5.8.zip">https://okta.oktapreview.com/static/adfs/OktaADFSAdapter-1.5.8.zip</a>. Select the link to download the file, unzip the archive, and run <i>setup.exe</i>.</p>
                                                        <p><b>Note:</b> The <a href="../Settings/Version_Histories/Ver_History_ADFS_Adapter.htm">version history</a> describes all version of this plugin. </p>
                                                    </li>
                                                    <li value="2">Click <b>Next</b> to start the installation.
					<p><img src="../../Resources/Images/okta-adfs8.png" /></p></li>
                                                    <li value="3">Log back into your Okta org, then navigate to  the <b>Microsoft ADFS (MFA) application</b> application you created earlier (<a href="#Part">Part 2</a>).
                        <p><img src="../../Resources/Images/okta-adfs9.png" /></p></li>
                                                    <li value="4">Select the <b>General</b> tab and locate the values for <b><a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">Client<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>Essentially, a client is anything that talks to the Okta service. Within the traditional client-server model, Okta is the server. The client might be an agent, an Okta mobile app, or a browser plugin. </span></a> ID</b> and <b>Client secret</b>.
							<p><img src="../../Resources/Images/okta-adfs10.png" /></p></li>
                                                    <li value="5">The Okta ADFS Adapter install will prompt you for values for <b>ClientId</b>, <b>ClientSecret</b>, and <b>Okta URL</b> (this is your org name with the https prefix). For example:&#160;
                        <ul><li value="1"><b>ClientId</b>: <i>90aSt67bHgyW9bv</i></li><li value="2"><b>ClientSecret</b>: <i>80hglw7bw46hNoTpbnAyqzihouyzia</i></li><li value="3"><b>OktaURL</b>: <i>https://atkodemoorg.oktapreview.com</i></li></ul><p><img src="../../Resources/Images/okta-adfs11.png" /></p></li>
                                                    <li value="6">
                       Specify the drive and folder where you want to install the Okta MFA Adapter.
<p> <img src="../../Resources/Images/okta-adfs12.png" /></p></li>
                                                    <li value="7">
                      You will be notified that the install for the ADFS Plugin has completed.
 Click <b>Close</b>.<p><img src="../../Resources/Images/okta-adfs13.png" /></p></li>
                                                    <li value="8">If you are installing in a Federation Server Farm, refer to the procedure detailed in the <a href="#Farm">Farm Installation Addendum</a>.</li>
                                                </ol>
                                            </div>
                                        </div>
                                        <div class="MCDropDown MCDropDown_Open dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Part 5 – Enable the Okta MFA Provider in ADFS</a></span>
                                            <div class="MCDropDownBody dropDownBody">
                                                <ol>
                                                    <li value="1">Log onto your ADFS server.</li>
                                                    <li value="2">Open the ADFS management console.
					<p><img src="../../Resources/Images/okta-adfs14.png" /></p></li>
                                                    <li value="3">
                        Expand <b>Service - Authentication Methods</b>.
                    </li>
                                                    <li value="4">
                       Right-click on <b>Authentication Methods</b>.
                    </li>
                                                    <li value="5">
                        Click <b>Edit Multi-factor Authentication Methods...</b>.
						<p><img src="../../Resources/Images/okta-adfs15.png" /></p></li>
                                                    <li value="6">
                       Select <b>Okta MFA Provider</b>, then click <b>OK</b>.
<p><img src="../../Resources/Images/okta-adfs16.png" /></p></li>
                                                    <li value="7">
                      Select <b>Access Control Policies</b>.
						<p><img src="../../Resources/Images/okta-adfs17.png" /></p></li>
                                                    <li value="8">Select <b>Add Access Control Policy</b>.
					<p><img src="../../Resources/Images/okta-adfs18.png" /></p></li>
                                                    <li value="9">Enter a <b>Name</b> and <b>Description</b>, then click <b>Add</b>.
						<p><img src="../../Resources/Images/okta-adfs19.png" /></p></li>
                                                    <li value="10">
                       In the Rule Editor, configure a policy as required for your organization. Ensure that you include the <b style="font-style: italic;">and require multifactor authentication</b> option in your rule editor. Click <b>OK</b>.
                    <p><img src="../../Resources/Images/okta-adfs20.png" /></p></li>
                                                </ol>
                                            </div>
                                        </div>
                                        <div class="MCDropDown MCDropDown_Open dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Part 6 – Add the Access Control Policy to a Relying Party Application</a></span>
                                            <div class="MCDropDownBody dropDownBody">
                                                <ol>
                                                    <li value="1">In the ADFS management console, go to <b>Relying Party Trusts</b>.</li>
                                                    <li value="2">Right-click on the application, then select  <b>Edit Access Control Policy</b>.
					<p><img src="../../Resources/Images/okta-adfs21.png" /></p></li>
                                                    <li value="3">In the Settings section, click Edit. Choose the Application username format that you want to assign to users that will require this application.</li>
                                                    <li value="4">Select the policy you created in the previous step, then  click <b>OK</b>.
					<p><img src="../../Resources/Images/okta-adfs22.png" /></p><p><img src="../../Resources/Images/okta-adfs23.png" /></p></li>
                                                </ol>
                                            </div>
                                        </div>
                                        <div class="MCDropDown MCDropDown_Open dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Part 7 – Assign the Microsoft ADFS (MFA) Application in Okta</a></span>
                                            <div class="MCDropDownBody dropDownBody">
                                                <ol>
                                                    <li value="1">Log into your Okta org.</li>
                                                    <li value="2">Navigate to <b>Applications</b>, then select the Microsoft ADFS (MFA) application you created earlier.</li>
                                                    <li value="3">Select the <b>Assignments</b> tab, then select the individual users or <a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">groups<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>Groups allow you to organize your end users and the apps they can access. Assigning apps to large sets of end users is made easier with groups.</span></a> to whom this application will be assigned.
                <p>Ensure that the username assigned in the application matches the username that users will use for their ADFS initiated logins.</p></li>
                                                    <li value="4">When you are finished with the application assignments, click <b>Done</b>.
					<p><img src="../../Resources/Images/okta-adfs24.png" /></p><p><img src="../../Resources/Images/okta-adfs25.png" /></p></li>
                                                </ol>
                                            </div>
                                        </div>
                                        <div class="MCDropDown MCDropDown_Open dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Part 8 – Verify the Okta MFA prompt when logging into ADFS</a></span>
                                            <div class="MCDropDownBody dropDownBody">
                                                <ol>
                                                    <li value="1">Login to the test device to verify the Okta MFA prompt for ADFS login.</li>
                                                    <li value="2">Navigate directly to your ADFS login page (Id- initiated login), or login directly to an application that has been configured for <a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">SSO<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>An acronym for single sign-on. In a SSO system, a user logs in once to the system and can access multiple systems without being prompted to sign in for each one. Okta is a cloud-based SSO platform that allows users to enter one name and password to access multiple applications. Users can access all of their web applications, both behind the firewall and in the cloud, with a single sign in. Okta provides a seamless experience across PCs, laptops, tablets, and smartphones.</span></a> via ADFS (Service Provider-initiated login).</li>
                                                    <li value="3">After entering your credentials, you will either be redirected to your ADFS login page, or be prompted for Okta MFA if you started with IdP-initiated login.
						 <p>The example below shows service provider initiated login via Office 365:</p><table style="width: 99%;"><col /><col /><tbody><tr style="width: 25%;"><td>IdP&#160;Discovery at Office 365</td><td><img src="../../Resources/Images/okta-adfs26.png" /></td></tr><tr><td>Username/Password at ADFS</td><td><img src="../../Resources/Images/okta-adfs27.png" /></td></tr><tr><td>MFA by Okta embedded in ADFS</td><td><img src="../../Resources/Images/okta-adfs28.png" /></td></tr></tbody></table></li>
                                                </ol>
                                            </div>
                                        </div>
                                        <div class="MCDropDown MCDropDown_Open dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" /></a><a name="Farm"></a><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_">Farm Installation Addendum</a></span>
                                            <div class="MCDropDownBody dropDownBody">
                                                <p>During the Early Access (EA) phase of this deployment an administrator will be required to follow these additional steps during the installation to have a successful installation of the adapter in a Federation Server Farm environment.</p>
                                                <h2>Background</h2>
                                                <p>The installer stores the <b>Client Secret</b> as a protected string.  That protected string is generated using a machine specific key.</p>
                                                <p>When ADFS is setup in a server farm, the configuration file is replicated among farm member servers.  As a result the final configuration file will contain a single client secret that can only be decrypted by one server; the last server on which the installation was completed.</p>
                                                <p>If the ADFS server farm is using the WID database and not a SQL database you will also need to promote each server to be the primary server during the installation.  For this reason we recommend starting the installation on the current primary server, if you start on the primary server and follow the sequence as described below you will complete the installation on the original primary server returning it to its primary state.  Identify the current primary server with the powershell command <span style="font-family: 'Courier New'; font-size: 11pt;">Get-AdfsFarmInformation</span>.</p>
                                                <div class="MCDropDown MCDropDown_Open dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Procedure</a></span>
                                                    <div class="MCDropDownBody dropDownBody">
                                                        <ol>
                                                            <li value="1">If installing on servers in a WID based ADFS farm identify the current primary server, start the sequence from there.</li>
                                                            <li value="2">Perform the installation as described in <a href="#Part2">Part 4</a> of the Setup Instructions above.</li>
                                                            <li value="3">Retrieve and copy the protected string values from each server.</li>
                                                            <li value="4">Combine the values in a modified configuration file.</li>
                                                            <li value="5">Replace the configuration file with the modified version on the last server.</li>
                                                            <li value="6">Manually re-register the Adfs Authentication Provider.</li>
                                                        </ol>
                                                    </div>
                                                </div>
                                                <div class="MCDropDown MCDropDown_Open dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Detailed Procedure</a></span>
                                                    <div class="MCDropDownBody dropDownBody">
                                                        <ol>
                                                            <li value="1">If a local database farm (WID) and If the current computer is NOT the primary server in the farm promote it to primary by executing this command on server:
                            <p><span style="font-family: 'Courier New'; font-size: 11pt;">Set-AdfsSyncProperties -Role PrimaryComputer</span></p></li>
                                                            <li value="2">Perform the installation as described above on the first server.</li>
                                                            <li value="3">Open the <span style="font-family: 'Courier New'; font-size: 11pt;">okta_adfs_adapter.json</span> file <span style="font-family: 'Courier New'; font-size: 11pt;">(%ProgramFiles%\Okta\Okta MFA Provider\config</span>) with a text editor such as Notepad:							<p><img src="../../Resources/Images/okta-adfs29.png" /></p><ol style="list-style-type: lower-alpha;"><li value="1"><p>Copy the client secret value (truncated secret shown)</p></li><li value="2"><p>Paste the value in a separate file</p></li><li value="3"><p>Repeat Step 2 on the remaining servers in the environment</p></li><li value="4"><p>Proceed to Step 4 when you’ve completed the preceding steps on all of the servers in the farm.</p></li></ol></li>
                                                            <li value="4">Combine the values in a modified configuration file:
								<ol style="list-style-type: lower-alpha;"><li value="1">From the original primary server</li><li value="2">Promote the server back to primary:										<p><span style="font-family: 'Courier New'; font-size: 11pt;">Set-AdfsSyncProperties -Role PrimaryComputer</span></p></li><li value="3">Open the okta_adfs_adapter.json file:
								<p>If UAC is on make sure your editor is running as administrator</p></li><li value="4"><p>Copy/Paste the entire contents of your seperate file that contains the protected secrets from the other servers.</p></li><li value="5"><p>Shown below are the four protected strings from my servers and the full configuration file from the first (and now primary) server in one file.</p><p><img src="../../Resources/Images/okta-adfs30.png" /></p></li><li value="6"><p>Arrange the list of protected strings into a json array (note the last element in the array does not end with a comma).</p><p><img src="../../Resources/Images/okta-adfs31.png" /></p></li><li value="7"><p>Replace the clientSecret string value of your complete configuration file with the array you just created.</p></li><p><img src="../../Resources/Images/okta-adfs32.png" /></p><li value="8"><p><b>Note</b>: Indentation and new line formatting is optional</p></li><li value="9"><p><b>Optional</b>: Use a json lint tool to validate the json is well formed.  Online versions are available, use at your own discretion. For example:&#160;<a href="https://jsonlint.com/">https://jsonlint.com/</a>.</p></li></ol></li>
                                                            <li value="5">
                                Replace the configuration file with the modified version on the last server:
								<ul><li value="1"><p>Replace the <span style="font-family: 'Courier New'; font-size: 11pt;">okta_adfs_adapter.json</span> file on the last server with the newly created config file.</p></li><li value="2"><p><b>Note</b>: you may need to run notepad as a administrator</p></li></ul></li>
                                                            <li value="6">
                               Manually re-register the Adfs Authentication Provider:
<ul><li value="1">Sample Script:
											
											&#160;<p style="font-family: 'Courier New';">$a=[System.Reflection.Assembly]::LoadFile("C:\Program Files\Okta\Okta MFA Provider\bin\OktaMfaAdfs.dll")</p><p style="font-family: 'Courier New';">$file=[String]::Format("OktaMfaAdfs.AuthenticationAdapter, {0}", $a.GetName().FullName)</p><p style="font-family: 'Courier New';">Unregister-AdfsAuthenticationProvider -Name "OktaMfaAdfs"</p><p style="font-family: 'Courier New';">Register-AdfsAuthenticationProvider -Name "OktaMfaAdfs" -TypeName $file -ConfigurationFilePath "C:\Program Files\Okta\Okta MFA Provider\config\okta_adfs_adapter.json"</p></li></ul></li>
                                                        </ol>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="MCDropDown MCDropDown_Open dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Troubleshooting</a></span>
                                            <div class="MCDropDownBody dropDownBody">
                                                <ol>
                                                    <li value="1">If you see this message when logging into ADFS, ensure you have enabled CORS in your Okta org (<a href="#Part3">Part 3</a> in the setup guide).
					<p><img src="../../Resources/Images/okta-adfs33.png" /></p></li>
                                                    <li value="2">During installation you encounter an error 1001 PS0033  “cmdlet cannot be executed from a secondary server in a local database farm.
					<p>If you encounter this error closely follow the instructions in the <a href="#Farm">Farm Installation addendum</a>, especially the steps that discuss WID (windows internal database) and promoting each server to be primary.</p><p><img src="../../Resources/Images/okta-adfs34.png" /></p></li>
                                                </ol>
                                            </div>
                                        </div>
                                        <p>&#160;</p>
                                    </div>
                                    <div>
                                    </div>
                                </div>
                                <div class="Footer">
                                    <div>
                                        <p class="copyright">© Copyright 2018 Okta, Inc.</p>
                                    </div>
                                </div>
                                <script type="text/javascript" src="../../Resources/Scripts/getfeedback.js">
                                </script>
                            </div>
                        </div>
                    </section><a data-close="true"></a>
                </div>
            </div>
            <script>/* <![CDATA[ */$(document).foundation();/* ]]> */</script>
        </div>
    </body>
</html>