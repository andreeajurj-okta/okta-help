<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_okta_html5_topnav" data-mc-search-type="Stem" data-mc-help-system-file-name="okta_help.xml" data-mc-path-to-help-system="../../../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="typeofcontent" content="documentation" />
        <meta name="audience" content="admin" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Deploy an Ubuntu/Debian Amazon Web Services Server with Terraform and an Enrollment Token | Okta</title>
        <meta charset="utf-8" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, height=device-height" />
        <link rel="shortcut icon" href="../../../Resources/Images/favicon.ico" type="image/x-icon" />
        <!-- Google Tag Manager -->
        <script>
			/* <![CDATA[ */
			(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], 
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
			})(window,document,'script','dataLayer','GTM-TJ45R6');
			/* ]]> */
		</script>
        <!-- End Google Tag Manager -->
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" />
        <link href="../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" />
        <link href="../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" />
        <link href="../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" />
        <link href="../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" />
        <link href="../../../Resources/Stylesheets/okta-main.css" rel="stylesheet" />
        <link href="https://static.cloud.coveo.com/searchui/v2.5395/css/CoveoFullSearchNewDesign.css" rel="stylesheet" />
        <style>/*&lt;meta /&gt;*/

.button.expand-all-button
{
	-pie-background: url('../../../../Skins/Default/Stylesheets/Images/expand-all-non-hover-sm.png') no-repeat center center, linear-gradient(#fff, #fff);
}

.button.collapse-all-button
{
	-pie-background: url('../../../../Skins/Default/Stylesheets/Images/collapse-all-non-hover-sm.png') no-repeat center center, linear-gradient(#fff, #fff);
}

.needs-pie
{
	behavior: url('../../../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <link href="../../../Resources/TableStyles/oktatable_greyborders.css" rel="stylesheet" />
        <script src="../../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../../Resources/Scripts/foundation.6.2.3_custom.js">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="small" data-mc-ignore="true">
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <button class="menu-icon" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="https://support.okta.com/help/s/" alt="Okta"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="2" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" placeholder="Search" />
                                                <div class="search-filter-wrapper">
                                                    <div class="search-filter">
                                                        <div class="search-filter-content">
                                                            <ul>
                                                                <li>All Files</li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search">
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <section class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <div class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </div>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <!-- Google Tag Manager (noscript) -->
                                    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TJ45R6" height="0" width="0" style="display:none;visibility:hidden"></iframe>
                                    </noscript>
                                    <!-- End Google Tag Manager (noscript) -->
                                    <!-- Coveo config parameters -->
                                    <div id="coveo_org_id" style="Display:None"><span class="okta-coveo-configOrgId">oktaproduction9ounvcxa</span>
                                    </div>
                                    <div id="coveo_rest_uri" style="Display:None"><span class="okta-coveo-configPlatformRestUri">https://platform.cloud.coveo.com/rest/search</span>
                                    </div>
                                    <div id="coveo_search_url" style="Display:None"><span class="okta-coveo-configSearchPageUrl">https://support.okta.com/help/s/global-search/%40uri</span>
                                    </div>
                                    <div id="coveo_token_url" style="Display:None"><span class="okta-coveo-configSearchTokenServiceUrl">https://support.okta.com/help/services/apexrest/PublicSearchToken?site=help</span>
                                    </div>
                                    <!-- End Coveo config parameters -->
                                    <!-- ************************* Coveo Search bar ************************************* -->
                                    <div id="OLC_Coveo_Headline" class="coveo-headline-wrapper">
                                        <div class="slds-p-vertical_small">
                                            <!--Search Bar-->
                                            <div class="slds-grid slds-grid_align-center">
                                                <div id="customSelect" class="CoveoCustomSelect slds-float_right">
                                                </div>
                                                <div id="standaloneSearchbox">
                                                    <div class="CoveoAnalytics" data-search-hub="OktaCommunityFullSearch">
                                                    </div>
                                                    <div class="CoveoTab" data-id="Help" data-caption="Help" style="display:none">
                                                    </div>
                                                    <div class="CoveoSearchbox" data-enable-omnibox="true" data-enable-query-suggest-addon="true">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- **********************  Main content row  ********************** -->
                                    <div class="okta-topics">
                                        <!-- *** Col1: Left Nav Col *** -->
                                        <div class="is-not-in-mobile">
                                            <div data-sticky-container="" id="saBoKsBMk0-ySD5PDnUH7A">
                                                <div class="sticky sticky-menu" style="width:100%" data-sticky="" data-top-anchor="saBoKsBMk0-ySD5PDnUH7A:top" data-bottom-anchor="contentBody:bottom" data-sticky-on="small" data-scroll-container-on="small">
                                                    <ul class="nocontent menu _Skins_okta_left_menu mc-component" data-mc-linked-toc="Data/Tocs/left_nav_TOC.js" data-mc-side-menu="True" data-mc-max-depth="2" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- *** Col2: Body Col *** -->
                                        <div>
                                            <div class="is-not-in-mobile">
                                                <!-- Breadcrumbs -->
                                            </div>
                                            <div class="toolbar-main">
                                                <!-- Expand/Collapse All for drop-downs -->
                                                <div class="buttons popup-container clearfix topicToolbarProxy _Skins_okta_toolbar mc-component nocontent" style="mc-topic-toolbar-items: ;">
                                                    <div class="button-group-container-left">
                                                        <button class="button needs-pie expand-all-button" data-state1-class="expand-all-button" data-state2-class="collapse-all-button" data-state2-title="Collapse all" title="Expand all" data-state1-title="Expand all">
                                                            <img src="../../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="expand all" />
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="body-main">
                                                <!-- Main content body -->
                                                <h1>Deploy an&#160;Ubuntu/Debian Amazon Web Services Server with Terraform</h1>
                                                <h2>Overviews</h2>
                                                <p>This guide provides the information you need to deploy an&#160;Ubuntu/Debian Amazon Web Services Cloud Server with systemd and a bastion to your <span class="okta-feature-namesScaleFT">Advanced Server Access</span> team with Terraform.  Depending on your target server and enrollment type some topics in this guide may not apply to you, such as if your team's project will not be using terraform or if you plan to add a different server type to your project.&#160;Modify your steps as needed to fit your team or refer to a different guide on the <a href="cloud-deployment.htm">cloud deployments page</a>.</p>
                                                <p>Creating a cloud server with Terraform means installing the Terraform tool on your personal machine and using an Access ID,&#160;enrollment token, and secret ID&#160;to create servers on the Amazon Web Services console.&#160;Once created, your new servers should list automatically within your team's console in <span class="okta-feature-namesScaleFT">Advanced Server Access</span>. </p>
                                                <p><b>Note:</b> For this guide we used the <a href="https://github.com/ScaleFT/StarterKit/tree/master/AWS/ubuntu-behind-bastion">ScaleFT ubuntu-behind-bastion StarterKit</a> provided by Okta on Github as our terraform module. For your setup, use your company's Terraform repo for you production environment instead, though you should still end up with similar configuration values in your <code>terraform.tfvars</code> file.</p>
                                                <h2>Prerequisites</h2>
                                                <p>You need the following permissions you need to deploy an Amazon Web Services Server with Terraform</p>
                                                <h3>Amazon Web Services </h3>
                                                <table style="width: 100%;border-collapse: collapse;border-spacing: 0px 0px;border-left-style: solid;border-left-width: 1px;border-left-color: #dcdcdc;border-right-style: solid;border-right-width: 1px;border-right-color: #dcdcdc;border-top-style: solid;border-top-width: 1px;border-top-color: #dcdcdc;border-bottom-style: solid;border-bottom-width: 1px;border-bottom-color: #dcdcdc;mc-table-style: url('../../../Resources/TableStyles/oktatable_greyborders.css');" class="TableStyle-oktatable_greyborders" cellspacing="0">
                                                    <col style="width: 410px;" class="TableStyle-oktatable_greyborders-Column-Column1" />
                                                    <col class="TableStyle-oktatable_greyborders-Column-Column1" />
                                                    <tbody>
                                                        <tr class="TableStyle-oktatable_greyborders-Body-Body1">
                                                            <th class="TableStyle-oktatable_greyborders-BodyE-Column1-Body1">Requirement</th>
                                                            <th class="TableStyle-oktatable_greyborders-BodyD-Column1-Body1">Description</th>
                                                        </tr>
                                                        <tr class="TableStyle-oktatable_greyborders-Body-Body1">
                                                            <td class="TableStyle-oktatable_greyborders-BodyB-Column1-Body1">Amazon Web Services Account</td>
                                                            <td class="TableStyle-oktatable_greyborders-BodyA-Column1-Body1">An Amazon Web Services account is needed to access the AWS Management console, where you can create a Virtual Machine for your team. </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                                <h3>Advanced Server Access</h3>
                                                <table style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/oktatable_greyborders.css');" class="TableStyle-oktatable_greyborders" cellspacing="0">
                                                    <col class="TableStyle-oktatable_greyborders-Column-Column1" />
                                                    <col class="TableStyle-oktatable_greyborders-Column-Column1" />
                                                    <tbody>
                                                        <tr class="TableStyle-oktatable_greyborders-Body-Body1">
                                                            <th class="TableStyle-oktatable_greyborders-BodyE-Column1-Body1">Requirement</th>
                                                            <th class="TableStyle-oktatable_greyborders-BodyD-Column1-Body1">Description</th>
                                                        </tr>
                                                        <tr class="TableStyle-oktatable_greyborders-Body-Body1">
                                                            <td class="TableStyle-oktatable_greyborders-BodyE-Column1-Body1"><span class="okta-feature-namesScaleFT">Advanced Server Access</span> Team</td>
                                                            <td class="TableStyle-oktatable_greyborders-BodyD-Column1-Body1">This is the top-level object that is representing an organization within <span class="okta-feature-namesScaleFT">Advanced Server Access</span>.</td>
                                                        </tr>
                                                        <tr class="TableStyle-oktatable_greyborders-Body-Body1">
                                                            <td class="TableStyle-oktatable_greyborders-BodyB-Column1-Body1"><span class="okta-feature-namesScaleFT">Advanced Server Access</span> Project</td>
                                                            <td class="TableStyle-oktatable_greyborders-BodyA-Column1-Body1">This is the authorization-<span class="disableGlossary">scope</span> of your team, organizing your Users, <span class="disableGlossary">Groups</span>, and Servers.</td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                                <h1>Procedures</h1>
                                                <p>Deploying an Amazon Web Services Server with Terraform can be done in 3 steps:</p>
                                                <ol>
                                                    <li value="1"><a href="#Create" class="MCXref xref">Download and Install Terraform</a>
                                                    </li>
                                                    <li value="2"><a href="#Enroll">Locate your Amazon Web Services Security Credentials </a>
                                                    </li>
                                                    <li value="3"><a href="#Configure">Configure Terraform to work with Amazon Web Services and Advanced Server Access</a>
                                                    </li>
                                                </ol>
                                                <p>&#160;</p>
                                                <h1><a name="Create"></a>Download and Install Terraform</h1>
                                                <ol>
                                                    <li value="1">
                                                        <p><![CDATA[
              ]]><a href="https://www.terraform.io/downloads.html">Download the Terraform installer from the official site</a><![CDATA[            ]]></p>
                                                    </li>
                                                    <li value="2">Unzip the downloaded file and run the unix executable</li>
                                                </ol>
                                                <h1><a name="Enroll"></a>Locate and Save your Amazon Web Services Security Credentials </h1>
                                                <ol>
                                                    <li value="1">Navigate to the Amazon Web Services console and log in to your account</li>
                                                    <li value="2">
                                                        <p>Click the dropdown next to your username in the top-right corner of the console and select <b>My Security Credentials</b></p>
                                                        <p>If prompted with another window concerning AWS&#160;Identity and Access Management users, click the <b>Continue to Security Credentials</b> button</p>
                                                    </li>
                                                    <li value="3">Click the <b>Access keys&#160;(access key ID&#160;and secret access key)</b> dropdown menu</li>
                                                    <li value="4">Click the <b>Create New Access Key</b> button, and click the <b>Hide Access Key</b> dropdown to see your new Access Key ID&#160;and Secret Access Key</li>
                                                    <li value="5">Copy and store both the Access Key ID and Secret Access Key and save in a secure location</li>
                                                </ol>
                                                <h1><a name="Configure"></a>Configure Terraform to work with Advanced Server Access and Amazon Web Services</h1>
                                                <ol>
                                                    <li value="1">
                                                        <p>Open your machine's console and run the <code>ls -a</code> command to see the folders in your home directory</p>
                                                    </li>
                                                    <li value="2">
                                                        <p>Create a file named <code>terraform.tfvars</code> and add the following lines:</p><pre xml:space="preserve">access_key:"&lt;access-key&gt;"
secret_key:"&lt;secret-key&gt;"
enrollment_token:"&lt;enrollment-token&gt;"</pre>
                                                    </li>
                                                    <li value="3">
                                                        <p>Save the file and place it in your Terraform module</p>
                                                    </li>
                                                    <li value="4">
                                                        <p>In your machine's console, run the <code>which terraform</code> command to confirm that your terraform path exists.&#160;Depending on your platform, the output should look something like the following:&#160;</p>
                                                        <p><code>/Users/user/bin/terraform</code>
                                                        </p>
                                                    </li>
                                                    <li value="5">Confirm that you are in your terrform module before running the <code>terraform init</code> command to initialize the terraform program</li>
                                                    <li value="6">Confirm that the information you saved to you <code>terraform.tfvars</code> file is correct by running the <code>terraform plan</code> command. If you receive any errors, troubleshoot as needed before proceeding</li>
                                                    <li value="7">Run  <code>terraform apply</code> to begin creating your servers. If prompted for approval, type <code>yes</code> and press return on your keyboard</li>
                                                </ol>
                                                <p>Navigate to the <span class="okta-feature-namesScaleFT">Advanced Server Access</span> console and confirm that your new servers are listed before attempting to SSH into your team's servers. </p>
                                                <!-- Back to Top button --><a href="#" class="sf-back-to-top"><span class="arrow"></span>Top</a>
                                            </div>
                                        </div>
                                        <!-- *** Col3: Right menu Col *** -->
                                        <div class="is-not-in-mobile">
                                        </div>
                                    </div>
                                    <!-- ***************************** Footer rows ********************************* -->
                                    <div class="footer-temp">
                                        <div class="is-not-in-mobile">
                                            <p> </p>
                                        </div>
                                        <div>
                                            <p class="copyright">©  <span class="okta-variablesYear">2020</span> <span class="okta-variablesCompanyName">Okta, Inc</span> All Rights Reserved. Various trademarks held by their respective owners.</p>
                                        </div>
                                    </div>
                                    <!-- ***************************** Scripts ************************************* -->
                                    <!-- Foundation -->
                                    <script src="../../../Resources/Scripts/js/app.js">
                                    </script>
                                    <script src="../../../Resources/Scripts/js/vendor/what-input.js">
                                    </script>
                                    <script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/6.4.4-rc1/js/foundation.min.js">
                                    </script>
                                    <!-- Ours -->
                                    <script type="text/javascript" src="../../../Resources/Scripts/back-to-top.js">
                                    </script>
                                    <script type="text/javascript" src="../../../Resources/Scripts/get-feedback.js">
                                    </script>
                                    <!-- Coveo -->
                                    <script src="https://static.cloud.coveo.com/searchui/v2.5395/js/CoveoJsSearch.Lazy.min.js">
                                    </script>
                                    <script src="../../../Resources/Scripts/coveo-resources/js/cultures/en.js" id="coveoCultureScript">
                                    </script>
                                    <script src="../../../Resources/Scripts/coveo-resources/js/Coveo.MadcapFlare.RequireJS.js" id="coveoRequireScript">
                                    </script>
                                    <script src="../../../Resources/Scripts/coveo-resources/js/Coveo.MadcapFlare.Okta.js" id="coveoInitscript">
                                    </script>
                                </div>
                            </div>
                        </div>
                    </section><a data-close="true"></a>
                </div>
            </div>
            <script>/* <![CDATA[ */$(document).foundation();/* ]]> */</script>
        </div>
    </body>
</html>