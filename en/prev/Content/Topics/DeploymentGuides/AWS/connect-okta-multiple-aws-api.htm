<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_okta_html5_topnav_nav_poc" data-mc-search-type="Stem" data-mc-help-system-file-name="okta_help.xml" data-mc-path-to-help-system="../../../../" data-mc-has-content-body="True" data-mc-conditions="Primary.do-not-publish" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <!-- ******************************************************************************** -->
    <!-- IMPORTANT: replicate changes in this file to other master pages, as appropriate. -->
    <!-- ******************************************************************************** -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="typeofcontent" content="documentation" />
        <meta name="audience" content="admin" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="description" content="Section includes high-level design of multiple AWS instances using an API and the step topics to implement this integration. These include Configure Okta as the identity provider in all AWS, Add Okta identity provider as trusted source in your all AWS roles across all AWS accounts, Generate the AWS API access key for Okta to download AWS roles from all accounts, Set up an IAM role in each of the child accounts, and Configure the AWS app in Okta." /><title>Connect Okta to multiple AWS instances using an API | Okta</title>
        <meta charset="utf-8" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, height=device-height" />
        <link rel="shortcut icon" href="../../../Resources/Images/favicon.ico" type="image/x-icon" />
        <!-- Google Tag Manager -->
        <!-- End Google Tag Manager -->
        <!-- Google Tag Manager -->
        <!-- End Google Tag Manager -->
        <!-- Pendo Script (Per Chris Bank) -->
        <!-- End Pendo Script -->
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Resources/Stylesheets/okta-main-new-nav.css" rel="stylesheet" type="text/css" />
        <link rel="stylesheet" href="https://static.cloud.coveo.com/searchui/v2.5395/css/CoveoFullSearchNewDesign.css" />
        <style>/*&lt;meta /&gt;*/

.button.expand-all-button
{
	-pie-background: url('../../../../Skins/Default/Stylesheets/Images/expand.png') no-repeat center center, linear-gradient(#fff, #fff);
}

.button.previous-topic-button
{
	-pie-background: url('../../../../Skins/Default/Stylesheets/Images/navigate-previous.png') no-repeat center center, linear-gradient(#fff, #fff);
}

.button.next-topic-button
{
	-pie-background: url('../../../../Skins/Default/Stylesheets/Images/navigate-next.png') no-repeat center center, linear-gradient(#fff, #fff);
}

.button.collapse-all-button
{
	-pie-background: url('../../../../Skins/Default/Stylesheets/Images/collapse.png') no-repeat center center, linear-gradient(#fff, #fff);
}

.needs-pie
{
	behavior: url('../../../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <style>/*&lt;meta /&gt;*/

.button.previous-topic-button
{
	-pie-background: url('../../../../Skins/Default/Stylesheets/Images/navigate-previous.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.next-topic-button
{
	-pie-background: url('../../../../Skins/Default/Stylesheets/Images/navigate-next.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.needs-pie
{
	behavior: url('../../../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <script src="../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
        <script>
			/* <![CDATA[ */
			(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], 
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
			})(window,document,'script','dataLayer','GTM-NMZZV4P');
			/* ]]> */
		</script>
        <script>
			/* <![CDATA[ */
			(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], 
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
			})(window,document,'script','dataLayer','GTM-KXMLV58');
			/* ]]> */
		</script>
        <script>
		/* <![CDATA[ */
		(function(apiKey){
			(function(p,e,n,d,o){var v,w,x,y,z;o=p[d]=p[d]||{};o._q=o._q||[];
			v=['initialize','identify','updateOptions','pageLoad','track'];for(w=0,x=v.length;w<x;++w)(function(m){
			o[m]=o[m]||function(){o._q[m===v[0]?'unshift':'push']([m].concat([].slice.call(arguments,0)));};})(v[w]);
			y=e.createElement(n);y.async=!0;y.src='https://cdn.pendo.io/agent/static/'+apiKey+'/pendo.js';
			z=e.getElementsByTagName(n)[0];z.parentNode.insertBefore(y,z);})(window,document,'script','pendo');

        pendo.initialize({
            visitor: {
                id:              'VISITOR-UNIQUE-ID'
            },	
            account: {
                id:           'ACCOUNT-UNIQUE-ID'
            }
        });
		})('a9bd3885-93ae-46ab-700b-dd29e613c19d');
		/* ]]> */
		</script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" role="banner" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1024px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="https://support.okta.com/help/s/" alt="Okta"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="2" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <!-- Google Tag Manager (noscript) -->
                                    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NMZZV4P" height="0" width="0" style="display:none;visibility:hidden"></iframe>
                                    </noscript>
                                    <!-- End Google Tag Manager (noscript) -->
                                    <!-- Google Tag Manager (noscript) -->
                                    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KXMLV58" height="0" width="0" style="display:none;visibility:hidden"></iframe>
                                    </noscript>
                                    <!-- End Google Tag Manager (noscript) -->
                                    <!-- Coveo config parameters -->
                                    <div id="coveo_org_id" style="Display:None"><span class="mc-variable okta-coveo-config.OrgId variable">oktaproduction9ounvcxa</span>
                                    </div>
                                    <div id="coveo_rest_uri" style="Display:None"><span class="mc-variable okta-coveo-config.PlatformRestUri variable">https://platform.cloud.coveo.com/rest/search</span>
                                    </div>
                                    <div id="coveo_search_url" style="Display:None"><span class="mc-variable okta-coveo-config.SearchPageUrl variable">https://support.okta.com/help/s/global-search/%40uri</span>
                                    </div>
                                    <div id="coveo_token_url" style="Display:None"><span class="mc-variable okta-coveo-config.SearchTokenServiceUrl variable">https://support.okta.com/help/services/apexrest/PublicSearchToken?site=help</span>
                                    </div>
                                    <!-- End Coveo config parameters -->
                                    <!-- ************************* Coveo Search bar ************************************* -->
                                    <!-- set margin and size in /Content/Resources/Scripts/coveo-resources/css/Coveo.Okta.StandaloneSearchbox.min.css to make room for replacing Flare-generated top-nav with HTML code (see below)-->
                                    <div id="OLC_Coveo_Headline" class="coveo-headline-wrapper" data-mc-conditions="MultiProdPubish.SearchBar">
                                        <div class="slds-p-vertical_small">
                                            <!--Search Bar-->
                                            <div class="slds-grid slds-grid_align-center">
                                                <div id="customSelect" class="CoveoCustomSelect slds-float_right">
                                                </div>
                                                <div id="standaloneSearchbox">
                                                    <div class="CoveoAnalytics" data-search-hub="OktaCommunityFullSearch">
                                                    </div>
                                                    <div class="CoveoTab" data-id="Help" data-caption="Help" style="display:none">
                                                    </div>
                                                    <div class="CoveoSearchbox" data-enable-omnibox="true" data-enable-query-suggest-addon="true">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="replace_top_nav">
                                        <!--<div class="title-bar-layout outer-row">-->
                                        <!--<div class="navigation-wrapper nocontent">
			<ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="2" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True" data-mc-chunk="Data/Toc.xml">                               
			<li class="has-children" data-mc-id="0"><a href="javascript:void(0);">Documentation</a></li>
			<li data-mc-id="1"><a href="https://support.okta.com/help/s/documentation">Knowledge base</a></li>
			<li class="has-children" data-mc-id="2"><a href="javascript:void(0);">Community</a></li>
			<li class="has-children" data-mc-id="3"><a href="javascript:void(0);">Product</a></li>
			<li data-mc-id="4"><a href="https://www.okta.com/services/education-services/">Training</a></li>
			</ul>
			</div>-->
                                        <div class="navbar">
                                            <div class="dropdown" data-mc-conditions="MultiProdPubish.DocMenu">
                                                <button class="dropbtn">Documentation <i class="fa fa-caret-down"></i></button>
                                                <div class="dropdown-content">
                                                    <div><a href="https://help.okta.com/en/prod/Content/Topics/ReleaseNotes/okta-relnotes.htm">Release notes</a>
                                                    </div>
                                                    <div><a href="https://help.okta.com/en/prod/Content/index.htm">Product documentation</a>
                                                    </div>
                                                    <div><a href="https://developer.okta.com/documentation" target="_blank">Developer documentation<img src="../../../Resources/Images/okta-assets/external-link-icon.svg" style="margin-left: 8px;" /></a>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="dropdown"><a href="https://support.okta.com/help/s/knowledge">Knowledge base</a>
                                            </div>
                                            <div class="dropdown">
                                                <button class="dropbtn">Community <i class="fa fa-caret-down"></i></button>
                                                <div class="dropdown-content">
                                                    <div><a href="https://support.okta.com/help/s/questions?language=en_US">Questions</a>
                                                    </div>
                                                    <div><a href="https://support.okta.com/help/s/group/CollaborationGroup/Recent?language=en_US">Discussions</a>
                                                    </div>
                                                    <div><a href="https://support.okta.com/help/s/events?language=en_US">Webinars</a>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="dropdown">
                                                <button class="dropbtn">Product <i class="fa fa-caret-down"></i></button>
                                                <div class="dropdown-content">
                                                    <div><a href="https://support.okta.com/help/s/ideas" target="_blank">Ideas<img src="../../../Resources/Images/okta-assets/external-link-icon.svg" style="margin-left: 8px;" /></a>
                                                    </div>
                                                    <div><a href="https://support.okta.com/help/s/productroadmap?language=en_US">Roadmap</a>
                                                    </div>
                                                    <div><a href="https://support.okta.com/help/s/product-hub?language=en_US">Product hub</a>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="dropdown"><a href="https://www.okta.com/services/education-services/" target="_blank">Training<span><img src="../../../Resources/Images/okta-assets/external-link-icon.svg" style="margin-left: 8px;" /></span></a>
                                            </div>
                                        </div>
                                        <div class="logo_container"><a class="logo" href="https://support.okta.com/help/s/"><img src="../../../Resources/Images/okta-assets/Logo.png" alt="Okta Support" title="Okta Support" /></a>
                                        </div>
                                    </div>
                                    <!-- **********************  Main content row  ********************** -->
                                    <div class="okta-topics">
                                        <!-- *** Col1: Left Nav Col *** ****commented out, with new left accordion implementation***-->
                                        <!--<div class="is-not-in-mobile">
                <MadCap:menuProxy data-mc-skin="/Project/Skins/okta-left-menu.flskn" mc-linked-toc="/Project/TOCs/left-nav-TOC.fltoc" style="mc-toc-depth: 2;mc-context-sensitive: False;mc-include-parent: True;mc-include-siblings: True;mc-include-children: True;" />
            </div>-->
                                        <!-- *** Col1: Body Col *** -->
                                        <div>
                                            <div class="is-not-in-mobile">
                                                <!-- Breadcrumbs -->
                                            </div>
                                            <div class="toolbar-main">
                                                <!-- Expand/Collapse All for drop-downs, next/prev buttons -->
                                                <div class="buttons popup-container clearfix topicToolbarProxy _Skins_okta_toolbar_nav_poc mc-component nocontent" style="mc-topic-toolbar-items: ;">
                                                    <div class="button-group-container-left">
                                                        <button class="button needs-pie expand-all-button" data-state1-class="expand-all-button" data-state2-class="collapse-all-button" data-state2-title="Collapse all" title="Expand all" data-state1-title="Expand all">
                                                            <img alt="Expand all" src="../../../../Skins/Default/Stylesheets/Images/transparent.gif" class="invisible-label" />
                                                        </button>
                                                        <button class="button needs-pie previous-topic-button" title="Previous topic">
                                                            <img alt="Navigate previous" src="../../../../Skins/Default/Stylesheets/Images/transparent.gif" class="invisible-label" />
                                                        </button>
                                                        <button class="button needs-pie next-topic-button" title="Next topic">
                                                            <img alt="Navigate next" src="../../../../Skins/Default/Stylesheets/Images/transparent.gif" class="invisible-label" />
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="body-main">
                                                <!-- Main content body -->
                                                <div role="main" id="mc-main-content">
                                                    <h1>Connect Okta to multiple AWS instances using an API</h1>
                                                    <p>If you do not expect to exceed 60 AWS accounts and want a simplified user assignment process all contained within Okta, then connect to Okta using the AWS API.</p>
                                                    <h2><a name="High-lev"></a>High-level design</h2>
                                                    <p>Okta can provide SSO and fetch roles across multiple AWS accounts using a single Identity and Access Management (IAM) user account, having permissions to read IAM roles and account information across all connected accounts.</p>
                                                    <ul style="list-style-type: square;">
                                                        <li>
                                                            <p>The  IAM user account is created in an AWS account, known as the master account in Okta.</p>
                                                        </li>
                                                        <li>
                                                            <p>The IAM user account accesses connected accounts. These accounts are children of the IAM user master account. You can designate any AWS account as the IAM user master, as long as there is at least one IAM user account (with the proper permissions) in the AWS instance.</p>
                                                        </li>
                                                    </ul>
                                                    <p>
                                                        <img src="../../../Resources/Images/aws/aws_new_18.png" />
                                                    </p>
                                                    <h2><a name="Step4"></a>Step 1: Configure Okta as the identity provider in all AWS accounts</h2>
                                                    <p>Configure Okta as a trusted SAML SSO identity provider in all of your AWS accounts (see <a href="connect-okta-single-aws.htm#Step3" class="MCXref xref">Connect Okta to a single Amazon Web Services instance</a>). Use the same metadata and name throughout your accounts. This includes your master account and connected accounts.</p>
                                                    <h2><a name="Step3"></a>Step 2: Add Okta identity provider as trusted source in your all AWS roles across all AWS accounts</h2>
                                                    <p>Repeat <a href="connect-okta-single-aws.htm#Step4" class="MCXref xref">Connect Okta to a single Amazon Web Services instance</a> for each role in all accounts you wish to set up. This includes roles that you want to access from your master account and connected accounts.</p>
                                                    <h2><a name="Step2"></a>Step 3: Generate the AWS API access key for Okta to download AWS roles from all accounts</h2>
                                                    <p><b style="color: #696969;">About</b>
                                                    </p>
                                                    <p>You need to create an AWS user with specific permissions so Okta can dynamically fetch a list of available roles from your accounts. This makes assigning users and groups to specific AWS roles easy and secure for administrators.</p>
                                                    <p>Complete this procedure for each account you want to connect.</p>
                                                    <p><b style="color: #696969;">Procedure</b>
                                                    </p>
                                                    <ol>
                                                        <li value="1">
                                                            <p>From the AWS Console, choose <b>Identity and Access Management (IAM) &gt; Users</b> and then click <b>Add user</b>.</p>
                                                            <p>
                                                                <img src="../../../Resources/Images/aws/aws_new_9n.png" class="new" />
                                                            </p>
                                                        </li>
                                                        <li value="2">
                                                            <p>From the <b>Add user</b> page (step 1 view), specify a user name.</p>
                                                            <p>Example: <i>OktaSSOuser</i></p>
                                                        </li>
                                                        <li value="3">
                                                            <p>From the <b>Select AWS access type</b> area, select <b>Programmatic access</b> and then click <b>Next Permissions</b>.</p>
                                                            <p>
                                                                <img src="../../../Resources/Images/aws/aws_new_10n.png" class="new" />
                                                            </p>
                                                        </li>
                                                        <li value="4">
                                                            <p>From the <b>Add user</b> page (step 2 view), click <b>Attach existing policies directly</b> and then <b>Create policy</b>.</p>
                                                            <p>
                                                                <img src="../../../Resources/Images/aws/aws_new_11n.png" class="new" />
                                                            </p>
                                                            <p>The <b>Create policy</b> page (step 1 view) opens in a new <b>IAM Management Console</b> browser tab.</p>
                                                        </li>
                                                        <li value="5">
                                                            <p>Click the <b>JSON</b> tab.</p>
                                                            <p>
                                                                <img src="../../../Resources/Images/aws/aws_new_c.png" />
                                                            </p>
                                                        </li>
                                                        <li value="6">
                                                            <p>Delete the existing code in the <b>JSON</b> tab and then paste the following code in the tab:</p>
                                                            <div style="background-color: #dcdcdc;mc-float: none;vertical-align: baseline;height: 625px;width: 732px;"><pre>{</pre><pre xml:space="preserve">    "Version": "2012-10-17",</pre><pre xml:space="preserve">    "Statement": [</pre><pre xml:space="preserve">      {</pre><pre xml:space="preserve">          "Effect": "Allow",</pre><pre xml:space="preserve">          "Action": [</pre><pre xml:space="preserve">              "iam:GetAccountSummary",</pre><pre xml:space="preserve">              "iam:ListRoles",</pre><pre xml:space="preserve">              "iam:ListAccountAliases",</pre><pre xml:space="preserve">              "iam:GetUser",</pre><pre xml:space="preserve">              "sts:AssumeRole"</pre><pre xml:space="preserve">          ],</pre><pre xml:space="preserve">          "Resource": "*"</pre><pre xml:space="preserve">      }</pre><pre xml:space="preserve">    ]</pre><pre>}</pre>
                                                            </div>
                                                        </li>
                                                        <li value="7">
                                                            <p>Click <b>Review policy</b>.</p>
                                                        </li>
                                                        <li value="8">
                                                            <p>From the <b>Create policy</b> page (step 2 view), enter a policy name and description.</p>
                                                            <p>Example policy name: <i>OktaMasterAccountPolicy</i></p>
                                                            <p>
                                                                <img src="../../../Resources/Images/aws/aws_new_34.png" class="new" />
                                                            </p>
                                                        </li>
                                                        <li value="9">
                                                            <p>Click <b>Create Policy</b>.</p>
                                                            <p>The app returns you to the first browser tab where you can continue assigning policies to your IAM user.</p>
                                                        </li>
                                                        <li value="10">
                                                            <p>Click the first <b>IAM Management Console</b> browser tab.</p>
                                                            <p>
                                                                <img src="../../../Resources/Images/aws/aws_browser_tabs.png" />
                                                            </p>
                                                        </li>
                                                        <li value="11">
                                                            <p>From the <b>Add user</b> page (step 2 view), ensure that <b style="font-weight: bold;">Attach existing policies directly</b> is selected.</p>
                                                        </li>
                                                        <li value="12">
                                                            <p>Locate and select  the policy you just created.</p>
                                                            <p>Use the refresh button to update your search.</p>
                                                            <p>
                                                                <img src="../../../Resources/Images/aws/aws_new_13n.png" class="new" />
                                                            </p>
                                                        </li>
                                                        <li value="13">
                                                            <p>Click <b>Next: Tags</b>. </p>
                                                        </li>
                                                        <li value="14">
                                                            <p>From the <b style="font-weight: bold;">Add user</b> page (step 3 view),  click <b style="font-weight: bold;">Next: Review</b>.</p>
                                                        </li>
                                                        <li value="15">
                                                            <p>From the <b style="font-weight: bold;">Add user</b> page (step 4 view), click <b>Create user</b>.</p>
                                                        </li>
                                                        <li value="16">
                                                            <p>From the <b style="font-weight: bold;">Add user</b> page (step 5 view), make a copy of your access key ID and secret access key.</p>
                                                            <p>
                                                                <img src="../../../Resources/Images/aws/aws_new_33_799x346.png" class="new" style="width: 799;height: 346;" />
                                                            </p>
                                                            <p>The keys are needed in <a href="#Step" class="MCXref xref">Step 5: Configure the AWS app in Okta</a> to configure the AWS app in Okta.</p>
                                                            <p>This is the only time that you will be able to see and copy these keys.</p>
                                                        </li>
                                                    </ol>
                                                    <h2><a name="Step5"></a>Step 4: Set up an IAM role in each of the  connected accounts</h2>
                                                    <p><b style="color: #696969;">About</b>
                                                    </p>
                                                    <p>Now that you have created an AWS user with read permissions for accounts and roles in your master account, each of your remaining connected accounts need to trust the master account user and permit it to read roles.</p>
                                                    <p><b style="color: #696969;">Procedure</b>
                                                    </p>
                                                    <ol>
                                                        <li value="1">
                                                            <p>From a connected account, go to <b>Roles &gt; Create Role</b>.</p>
                                                        </li>
                                                        <li value="2">
                                                            <p>From the <b>Create role</b> page, click <b>Another AWS account</b>, enter the master account ID, and then click <b>Next: Permissions</b>.</p>
                                                            <p>
                                                                <img src="../../../Resources/Images/aws/aws_newd.png" />
                                                            </p>
                                                            <p>The master account ID can be found by choosing <b>My Account</b> from the drop-down in the top  right of the AWS Console.</p>
                                                            <p>
                                                                <img src="../../../Resources/Images/aws/aws_new_25.png" />
                                                            </p>
                                                        </li>
                                                        <li value="3">
                                                            <p>Attach a policy with read access to IAM roles. </p>
                                                            <p>Example: <i>IAMReadOnlyAccess</i></p>
                                                            <p>
                                                                <img src="../../../Resources/Images/aws/aws_new_27.png" />
                                                            </p>
                                                            <p>Alternatively, you can create a new policy with minimum read permissions attached and then attach the policy to the role that you're creating (see below).</p>
                                                            <div style="background-color: #dcdcdc;mc-float: none;vertical-align: baseline;height: 510px;width: 732px;"><pre>{</pre><pre xml:space="preserve">    "Version": "2012-10-17",</pre><pre xml:space="preserve">    "Statement": [</pre><pre xml:space="preserve">      {</pre><pre xml:space="preserve">          "Effect": "Allow",</pre><pre xml:space="preserve">          "Action": [</pre><pre xml:space="preserve">              "iam:ListRoles",</pre><pre xml:space="preserve">              "iam:ListAccountAliases"</pre><pre xml:space="preserve">          ],</pre><pre xml:space="preserve">          "Resource": "*"</pre><pre xml:space="preserve">      }</pre><pre xml:space="preserve">    ]</pre><pre>}          </pre>
                                                            </div>
                                                        </li>
                                                        <li value="4">
                                                            <p>Name the role <code>Okta-Idp-cross-account-role</code>.</p>
                                                            <div style="padding-left: 15px;padding-right: 15px;padding-top: 15px;padding-bottom: 15px;border-left-style: solid;border-left-width: 5px;">
                                                                <p><b>Important</b>
                                                                </p>
                                                                <p>This is a predefined name for this integration. A different name cannot be used.</p>
                                                            </div>
                                                        </li>
                                                        <li value="5">
                                                            <p>Repeat this procedure for each connected account, ensuring to use the same master account ID and role name (<code>Okta-Idp-cross-account-role</code>).</p>
                                                        </li>
                                                    </ol>
                                                    <h2><a name="Step"></a>Step 5: Configure the AWS app in Okta</h2>
                                                    <ol>
                                                        <li value="1">From the Okta Admin Dashboard, select the <b>Sign On</b> tab for the AWS app and then click <b>Edit</b>.</li>
                                                        <li value="2">
                                                            <p>From the <b>Advanced Sign-On Settings</b> area, select your environment type  from the <b>AWS Environment</b> drop-down.</p>
                                                            <p>If your environment type is not listed, you can set the desired ACS URL in the <b>ACS URL</b> field.</p>
                                                        </li>
                                                        <li value="3">Paste in the <b>Identity Provider ARN</b> field the identity provider ARN that you copied earlier.</li>
                                                        <li value="4">Specify in the <b>Session Duration</b> field the desired session duration for users.</li>
                                                        <li value="5">
                                                            <p>Click <b>Save/Next</b>.</p>
                                                            <p>
                                                                <img src="../../../Resources/Images/aws/aws_new_28.png" />
                                                            </p>
                                                        </li>
                                                        <li value="6">
                                                            <p>Click the <b>Provisioning</b> tab for the AWS app and then click <b>Edit</b>.</p>
                                                            <div style="padding-left: 15px;padding-right: 15px;padding-top: 15px;padding-bottom: 15px;border-left-style: solid;border-left-width: 5px;">
                                                                <p><b>Note</b>
                                                                </p>
                                                                <p>The AWS app integration does not support provisioning. This setup under the <b>Provisioning</b> tab is required to provide API access to Okta in order to download a list of AWS roles to assign during user assignment. It enables you to assign multiple roles to users and pass those roles in the SAML assertion.</p>
                                                            </div>
                                                        </li>
                                                        <li value="7">
                                                            <p>Select the <b>Enable API Integration</b> check box.</p>
                                                            <ul style="list-style-type: square;">
                                                                <li>
                                                                    <p>If your environment type is listed in the <b>AWS Environment</b> drop-down under the <b>Sign-on</b> tab, you do not need to complete the <b>ACS&#160;URL</b> field.</p>
                                                                </li>
                                                                <li>
                                                                    <p>If your environment type is not listed in the <b>AWS Environment</b> drop-down, then enter your API URL in the <b>ACS&#160;URL</b> field. You may have to contact AWS to learn the API URL for your environment.</p>
                                                                </li>
                                                            </ul>
                                                        </li>
                                                        <li value="8">
                                                            <p>In the <b>Access Key</b> and <b>Secret Key</b> fields, enter the keys you retrieved and stored in <a href="#Step2" class="MCXref xref">Step 3: Generate the AWS API access key for Okta to download AWS roles from all accounts</a>.</p>
                                                        </li>
                                                        <li value="9">
                                                            <p>Provide a comma-separated list in the <b>Connected Accounts IDs</b> field of all IDs of the connected accounts.</p>
                                                            <p>You can find the IDs in each AWS account from the <b>My Accounts</b> page in the top- right area of the AWS Console.</p>
                                                            <p>
                                                                <img src="../../../Resources/Images/aws/aws_newe.png" />
                                                            </p>
                                                        </li>
                                                        <li value="10">
                                                            <p>Click <b>Test API credentials</b> to ensure the credentials work for all connected accounts and fix any errors.</p>
                                                        </li>
                                                        <li value="11">
                                                            <p>Enable the desired options to update roles and permissions from AWS.</p>
                                                            <ul style="list-style-type: square;">
                                                                <li>
                                                                    <p>Enable <b>Create Users</b> and <b>Update User Attributes</b></p>
                                                                    <p>
                                                                        <img src="../../../Resources/Images/aws/aws_new_a1.png" />
                                                                    </p>
                                                                </li>
                                                                <li>
                                                                    <p>Enable <b>Create Users</b> (but not <b>Update User Attributes</b>).</p>
                                                                </li>
                                                            </ul>
                                                            <div style="padding-left: 15px;padding-right: 15px;padding-top: 15px;padding-bottom: 15px;border-left-style: solid;border-left-width: 5px;">
                                                                <p><b>Note</b>
                                                                </p>
                                                                <p>You are not creating or updating any users in AWS, but  activating parts of the API that enables Okta to retrieve Okta-trusted roles from the AWS account.</p>
                                                            </div>
                                                        </li>
                                                        <li value="12">Click <b>Next</b> (or <b>Save</b>).</li>
                                                        <li value="13">
                                                            <p>Assign the AWS app to a test user.</p>
                                                            <ul style="list-style-type: square;">
                                                                <li>From the <b>User Assignment</b> page, you can view a list of roles from your master account and connected (secondary) accounts.</li>
                                                                <li>Okta displays roles in the format: <samp>Account Name - Role Name</samp>.</li>
                                                                <li>
                                                                    <p>If AWS accounts have an alias setup, Okta uses the account alias instead of the account name.</p>
                                                                    <p>Example:  <samp>[Account Alias] - Role Name</samp>.</p>
                                                                </li>
                                                                <li>
                                                                    <p>In the following example, <samp>starks</samp> is used as the account alias.</p>
                                                                    <p>
                                                                        <img src="../../../Resources/Images/aws/aws_new_31.png" />
                                                                    </p>
                                                                </li>
                                                            </ul>
                                                        </li>
                                                        <li value="14">Complete the app assignment.</li>
                                                        <li value="15">
                                                            <p>Log in to your Okta org as the test user and then click the AWS app.</p>
                                                            <p>The AWS window lists the roles available to the user in Okta.</p>
                                                        </li>
                                                        <li value="16">
                                                            <p>Select the role to use when logging in to AWS.</p>
                                                            <p>
                                                                <img src="../../../Resources/Images/aws/aws_new_32.png" />
                                                            </p>
                                                        </li>
                                                        <li value="17">
                                                            <p>Ensure that there are no errors and the user is able to log in with the assigned role.</p>
                                                        </li>
                                                        <li value="18">
                                                            <p>You can return to Okta and assign users and groups (or only groups) to the AWS app.</p>
                                                        </li>
                                                    </ol>
                                                </div>
                                                <!-- Back to Top button --><a href="#" class="sf-back-to-top"><span class="arrow"></span>Top</a>
                                            </div>
                                        </div>
                                        <!-- *** Col2: Right menu Col ***  ****commented out temporarily until redesign for "on this page" implementation, redundant to new left accordion implementation***-->
                                        <!--<div class="is-not-in-mobile">
                <MadCap:menuProxy data-mc-skin="/Project/Skins/okta-right-menu.flskn" mc-linked-toc="/Project/TOCs/okta-TOC.fltoc" style="mc-context-sensitive: True;mc-include-parent: True;mc-include-siblings: False;mc-include-children: True;" />
            </div>-->
                                    </div>
                                    <div class="toolbar-bottom">
                                        <!-- Expand/Collapse All for drop-downs -->
                                        <div class="buttons popup-container clearfix topicToolbarProxy _Skins_okta_toolbar_no_expand mc-component nocontent" style="mc-topic-toolbar-items: ;">
                                            <div class="button-group-container-left">
                                                <button class="button needs-pie previous-topic-button" title="Previous topic">
                                                    <img alt="Navigate previous" src="../../../../Skins/Default/Stylesheets/Images/transparent.gif" class="invisible-label" />
                                                </button>
                                                <button class="button needs-pie next-topic-button" title="Next topic">
                                                    <img alt="Navigate next" src="../../../../Skins/Default/Stylesheets/Images/transparent.gif" class="invisible-label" />
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- ***************************** Footer rows ********************************* -->
                                    <!--         <div class="footer2">
            <div>
                <ul>
                    <li><a href="https://fulluat-okta.cs67.force.com/help/s/article/Okta-Community-FAQs">Community FAQ</a>
                    </li>
                    <li><a href="https://support.okta.com/help/s/article/Okta-Community-Terms-and-Conditions">Terms &amp; Conditions</a>
                    </li>
                    <li>Trust</li>
                    <li><a href="https://www.okta.com/contact/">Contact</a>
                    </li>
                    <li>Feedback</li>
                </ul>
            </div>
            <div>
                <p class="try-okta-button"><a role="button" href="https://www.okta.com/free-trial/">Try Okta For Free</a>
                </p>
            </div>
        </div> -->
                                    <div class="footer2">
                                        <div>
                                            <p class="copyright">©  <span class="mc-variable okta-variables.Year variable">2021</span> <span class="mc-variable okta-variables.CompanyName variable">Okta, Inc</span> All Rights Reserved. Various trademarks held by their respective owners.</p>
                                        </div>
                                        <!--             <div>
                <ul>
                    <li><a href="https://twitter.com/okta"><img src="../Images/okta-assets/twitter.png" /></a>
                    </li>
                    <li><a href="https://www.facebook.com/OktaIdentity"><img src="../Images/okta-assets/facebook.png" /></a>
                    </li>
                    <li><a href="https://www.linkedin.com/company/okta-inc-/"><img src="../Images/okta-assets/linkedin.png" /></a>
                    </li>
                    <li><a href="https://www.youtube.com/user/OktaInc"><img src="../Images/okta-assets/youtube.png" /></a>
                    </li>
                    <li><a href="https://www.okta.com"><img src="../Images/okta-assets/okta.png" /></a>
                    </li>
                </ul>
            </div> -->
                                    </div>
                                    <!-- Qualtrics setup to use with script below, replacing getfeedback -->
                                    <div id="ZN_6fGBJ8J3VcIBymN">
                                        <!--DO NOT REMOVE-CONTENTS PLACED HERE-->
                                    </div>
                                    <!-- ***************************** Scripts ************************************* -->
                                    <!-- Foundation -->
                                    <script src="../../../Resources/Scripts/js/app.js">
                                    </script>
                                    <script src="../../../Resources/Scripts/js/vendor/what-input.js">
                                    </script>
                                    <script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/6.4.4-rc1/js/foundation.min.js">
                                    </script>
                                    <!-- Ours -->
                                    <!--         <script type="text/javascript" src="../Scripts/back-to-top.js">
        </script>
 -->
                                    <script type="text/javascript" src="../../../Resources/Scripts/js/vendor/qualtrics.js">
                                    </script>
                                    <!-- Coveo -->
                                    <script src="https://static.cloud.coveo.com/searchui/v2.5395/js/CoveoJsSearch.Lazy.min.js" defer="defer">
                                    </script>
                                    <script src="../../../Resources/Scripts/coveo-resources/js/cultures/en.js" id="coveoCultureScript" defer="defer">
                                    </script>
                                    <script src="../../../Resources/Scripts/coveo-resources/js/Coveo.MadcapFlare.RequireJS.js" id="coveoRequireScript" defer="defer">
                                    </script>
                                    <script src="../../../Resources/Scripts/coveo-resources/js/Coveo.MadcapFlare.Okta.js" id="coveoInitscript" defer="defer">
                                    </script>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
