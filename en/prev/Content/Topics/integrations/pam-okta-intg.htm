<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_okta_html5_topnav" data-mc-search-type="Stem" data-mc-help-system-file-name="okta_help.xml" data-mc-path-to-help-system="../../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="typeofcontent" content="documentation" />
        <meta name="audience" content="admin" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>PAM Okta Integration | Okta</title>
        <meta charset="utf-8" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, height=device-height" />
        <link rel="shortcut icon" href="../../Resources/Images/favicon.ico" type="image/x-icon" />
        <!-- Google Tag Manager -->
        <script>
			/* <![CDATA[ */
			(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], 
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
			})(window,document,'script','dataLayer','GTM-TJ45R6');
			/* ]]> */
		</script>
        <!-- End Google Tag Manager -->
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/okta-main.css" rel="stylesheet" />
        <link href="https://static.cloud.coveo.com/searchui/v2.5395/css/CoveoFullSearchNewDesign.css" rel="stylesheet" />
        <style>/*&lt;meta /&gt;*/

.button.expand-all-button
{
	-pie-background: url('../../../Skins/Default/Stylesheets/Images/expand-all-non-hover-sm.png') no-repeat center center, linear-gradient(#fff, #fff);
}

.button.collapse-all-button
{
	-pie-background: url('../../../Skins/Default/Stylesheets/Images/collapse-all-non-hover-sm.png') no-repeat center center, linear-gradient(#fff, #fff);
}

.needs-pie
{
	behavior: url('../../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.6.2.3_custom.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="small" data-mc-ignore="true">
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <button class="menu-icon" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="https://support.okta.com/help/s/" alt="Okta"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="2" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" placeholder="Search" />
                                                <div class="search-filter-wrapper">
                                                    <div class="search-filter">
                                                        <div class="search-filter-content">
                                                            <ul>
                                                                <li>All Files</li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search">
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <section class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <div class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </div>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <!-- Google Tag Manager (noscript) -->
                                    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TJ45R6" height="0" width="0" style="display:none;visibility:hidden"></iframe>
                                    </noscript>
                                    <!-- End Google Tag Manager (noscript) -->
                                    <!-- Coveo config parameters -->
                                    <div id="coveo_org_id" style="Display:None"><span class="okta-coveo-configOrgId">oktaproduction9ounvcxa</span>
                                    </div>
                                    <div id="coveo_rest_uri" style="Display:None"><span class="okta-coveo-configPlatformRestUri">https://platform.cloud.coveo.com/rest/search</span>
                                    </div>
                                    <div id="coveo_search_url" style="Display:None"><span class="okta-coveo-configSearchPageUrl">https://support.okta.com/help/s/global-search/%40uri</span>
                                    </div>
                                    <div id="coveo_token_url" style="Display:None"><span class="okta-coveo-configSearchTokenServiceUrl">https://support.okta.com/help/services/apexrest/PublicSearchToken?site=help</span>
                                    </div>
                                    <!-- End Coveo config parameters -->
                                    <!-- ************************* Coveo Search bar ************************************* -->
                                    <div id="OLC_Coveo_Headline" class="coveo-headline-wrapper">
                                        <div class="slds-p-vertical_small">
                                            <!--Search Bar-->
                                            <div class="slds-grid slds-grid_align-center">
                                                <div id="customSelect" class="CoveoCustomSelect slds-float_right">
                                                </div>
                                                <div id="standaloneSearchbox">
                                                    <div class="CoveoAnalytics" data-search-hub="OktaCommunityFullSearch">
                                                    </div>
                                                    <div class="CoveoTab" data-id="Help" data-caption="Help" style="display:none">
                                                    </div>
                                                    <div class="CoveoSearchbox" data-enable-omnibox="true" data-enable-query-suggest-addon="true">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- **********************  Main content row  ********************** -->
                                    <div class="okta-topics">
                                        <!-- *** Col1: Left Nav Col *** -->
                                        <div class="is-not-in-mobile">
                                            <div data-sticky-container="" id="N1ZqoRlayUKIl9d05ag-eg">
                                                <div class="sticky sticky-menu" style="width:100%" data-sticky="" data-top-anchor="N1ZqoRlayUKIl9d05ag-eg:top" data-bottom-anchor="contentBody:bottom" data-sticky-on="small" data-scroll-container-on="small">
                                                    <ul class="nocontent menu _Skins_okta_left_menu mc-component" data-mc-linked-toc="Data/Tocs/left_nav_TOC.js" data-mc-side-menu="True" data-mc-max-depth="2" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- *** Col2: Body Col *** -->
                                        <div>
                                            <div class="is-not-in-mobile">
                                                <!-- Breadcrumbs -->
                                            </div>
                                            <div class="toolbar-main">
                                                <!-- Expand/Collapse All for drop-downs -->
                                                <div class="buttons popup-container clearfix topicToolbarProxy _Skins_okta_toolbar mc-component nocontent" style="mc-topic-toolbar-items: ;">
                                                    <div class="button-group-container-left">
                                                        <button class="button needs-pie expand-all-button" data-state1-class="expand-all-button" data-state2-class="collapse-all-button" data-state2-title="Collapse all" title="Expand all" data-state1-title="Expand all">
                                                            <img src="../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="expand all" />
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="body-main">
                                                <!-- Main content body -->
                                                <p class="beta">This is a Beta feature. To see about participating in this Beta program, please refer to the <a href="https://support.okta.com/help/s/betas">Beta Programs page</a>.</p>
                                                <h1>MFA on Linux Systems with PAM</h1>
                                                <p>You can extend <a href="../Security/MFA.htm">Multifactor Authentication</a> (MFA) to your Linux system with the Okta Pluggable <a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">Authentication<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>Authentication is distinct from authorization, which is the process of giving individuals access to system objects based on their identity. Authentication merely ensures that the individual is who he or she claims to be, but says nothing about the access rights of the individual.

Authentication methods and protocols include direct auth, delegated auth, SAML, SWA, WS-Fed, and OpenID Connect.</span></a> Module (PAM) adapter to take advantage of the PAM infrastructure to provide MFA when authenticating on a Linux system. For version history, see <a href="../Settings/Version_Histories/Ver_History_PAM_Adapter.htm">Okta PAM Adapter Version History</a>.</p>
                                                <p><b>Important:</b> <b>This beta is closed.</b> The released feature may not have the same interfaces, data structures, or limitations as this beta version. Do not use this version in production applications or environments at this time.</p>
                                                <p>All questions, comments, and concerns should be directed to <a href="mailto:mfabeta@okta.com?subject=PAM Beta">mfabeta@okta.com</a>. In addition, all feedback is appreciated. If you have an Okta CSM, include the CSM on the message. Please do not contact Okta Support; the support team does not support beta programs.</p>
                                                <h2> Limitations</h2>
                                                <p>This beta version is tested on Red Hat Enterprise Linux Server release 7.5 (Maipo). The instructions in this document may require modifications to work on other Linux distributions.</p>
                                                <p>Only the Push, SMS, Call, and OTP-codes <a href="../Security/MFA.htm#FactorTypes">MFA factors</a> are supported.</p>
                                                <h2>Sequence Diagram</h2>
                                                <p>The following sample sequence diagram shows an authentication flow using Okta Verify Push.</p>
                                                <p>
                                                    <img src="../../Resources/Images/okta-pam-1a.png" />
                                                </p>
                                                <h2>Step-by-step Configuration Guide</h2>
                                                <p>There are four parts to the configuration, including prerequisites. Additionally, there is a troubleshooting section..</p>
                                                <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" /></a><a name="Part"></a><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_"> Part 1 – Prerequisites</a></span>
                                                    <div class="MCDropDownBody dropDownBody">
                                                        <p>To get started with this beta feature, you must first request access to the PAM <a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">app<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>An abbreviation of application. Essentially, it is a web-based site used to perform any number of specific tasks, and requires authentication from end users by signing in.</span></a> and <a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">agent<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>A software agent is a lightweight program that runs as a service outside of Okta. It is typically installed behind a firewall and allows Okta to tunnel communication between an on-premises service and Okta's cloud service. Okta employs several agent types: Active Directory, LDAP, RADIUS, RSA, Active Directory Password Sync, and IWA. For example, users can install multiple Active Directory agents to ensure that the integration is robust and highly available across geographic locations.</span></a>. To obtain access, send an email to <a href="mailto:mfabeta@okta.com">mfabeta@okta.com</a>  with the subject: <i>Request to participate in the MFA for Linux beta release</i>. Be sure to also include your <a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">org<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>The Okta container that represents a real-world organization.</span></a> name in the request.</p>
                                                        <p>In addition, the following items must also be in place:</p>
                                                        <ul>
                                                            <li value="1">A RHEL system with a Red Hat subscription, or CentOS.</li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" /></a><a name="Part2"></a><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_"> Part 2 – Add a PAM MFA App to an Okta Org</a></span>
                                                    <div class="MCDropDownBody dropDownBody">
                                                        <ol>
                                                            <li value="1">Sign in into your Okta org as an <a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">admin<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>An abbreviation of administrator. This is the individual(s) who have access to the Okta Administrator Dashboard. They control the provisioning and deprovisioning of end users, the assigning of apps, the resetting of passwords, and the overall end user experience. Only administrators have the Administration button on the upper right side of the My Applications page.</span></a>. </li>
                                                            <li value="2">Navigate to <b>Applications &gt; Applications</b>, then click <b>Add Application</b>.
					<p><img src="../../Resources/Images/okta-adfs4.png" /></p></li>
                                                            <li value="3">Search for the <b>MFA for Linux Systems (PAM)</b> application, then click <b>Add</b>.
                    
                       <p><img src="../../Resources/Images/pam-okta-1.png" /></p></li>
                                                            <li value="4">
                                                                <p>On the <b>General</b> tab for the&#160;app, specify an <b>Application Label</b> relevant to your organization, then click <b>Next</b>.</p>
                                                                <p>On the Sign On tab for the app, click <b>Edit</b> and change the <b>Application Username format</b> to Email Prefix.</p>
                                                            </li>
                                                            <li value="5">Skip the <b>Assignments</b> page for now. You'll return to this after making a few application modifications  to ensure that the Linux and app usernames of the involved users match.<![CDATA[           ]]></li>
                                                        </ol>
                                                        <p>&#160;</p>
                                                    </div>
                                                </div>
                                                <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" /></a><a name="Part3"></a><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_"> Part 3 – Install Dependencies in Linux</a></span>
                                                    <div class="MCDropDownBody dropDownBody">
                                                        <p>Use the following code to install the dependencies in Linux. Choose RHEL or Centos, as appropriate for your system.</p>
                                                        <p><pre xml:space="preserve">
# Add EPEL repo for cmake3
sudo yum install https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm

sudo yum install cmake3 openssl-devel libcurl-devel pam-devel

# Installing devtoolset-7 and SCL since RHEL7/CentOS defaults to gcc 4.8.5 but JSON lib 
# used by JWT lib requires gcc 4.9 or newer.
# https://github.com/nlohmann/json#supported-compilers
#
# RHEL
sudo yum-config-manager --enable rhel-server-rhscl-7-rpms
sudo yum install devtoolset-7
# Note: if devtoolset-7 cannot be found, the RHSCL repo might not have been enabled. 
# In that case, perform the following steps:
# 1) Open /etc/yum.repos.d/redhat-rhui.repo in an editor
# 2) Search for the RHSCL (RPMs) repo
# 3) Change enabled from '0' to '1'
# 4) Re-run "sudo yum install devtoolset-7"


# CentOS
sudo yum install centos-release-scl
sudo yum install devtoolset-7-gcc*</pre>
                                                        </p>
                                                        <p>&#160;</p>
                                                    </div>
                                                </div>
                                                <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" /></a><a name="Part4"></a><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_"> Part 4 – Download, Build, and Install the PAM Module</a></span>
                                                    <div class="MCDropDownBody dropDownBody">
                                                        <p>There are eight required parts and one optional part to this process.</p>
                                                        <ol>
                                                            <li value="1">Download the PAM module in Okta<p>From your Okta admin console, navigate to <b>Settings &gt; Downloads</b>. Download the PAM source code from the PAM section under <em>MFA Plugins and Agents</em>, as shown below.</p><p><img src="../../Resources/Images/pam-okta-2.png" /></p></li>
                                                            <li value="2">
                                                                <p>Extract the contents of the downloaded tarball using the following command:</p>
                                                                <p><pre xml:space="preserve">
tar -xvf pam-mfa-okta-1.0.0.tar.gz</pre>
                                                                </p>
                                                            </li>
                                                            <li value="3">Build and install the PAM module with the following commands<p><pre xml:space="preserve">
# Enter new bash session with devtoolset-7 enabled
scl enable devtoolset-7 bash

cd pam-mfa-okta
mkdir release
cd release
cmake3 -E env CXXFLAGS="-fPIC" cmake3 -DCMAKE_BUILD_TYPE=Release ..
make

# Run the following command to:
# 1) Copy the built library to the pam module folder at /usr/lib64/security 
# 2) Create /etc/pam.d/okta-auth with the right permissions
sudo make install</pre></p></li>
                                                            <li value="4">
                                                                <p>Allow sshd to make network connections with the following command.<br /><br /><b>Important:</b> : Misconfigurations can lock you out of the system. Okta recommends keeping an open session while editing the <em>sshd</em> and <em>pam.d</em> configuration filesand simultaneously testing in another window.<br /></p>
                                                                <p><pre xml:space="preserve">
sudo setsebool -P authlogin_yubikey 1</pre>
                                                                </p>
                                                            </li>
                                                            <li value="5">
                                                                <p>Edit the <em>/etc/ssh/sshd_config</em> file and enable <code style="font-size: 11pt;">PasswordAuthentication</code> and <code style="font-size: 11pt;">ChallengeResponseAuthentication</code>, as shown below.</p>
                                                                <p><pre xml:space="preserve">
PasswordAuthentication yes
ChallengeResponseAuthentication yes</pre>
                                                                </p>
                                                            </li>
                                                            <li value="6">
                                                                <p>Edit the <em>okta-auth</em> file.</p>
                                                                <p><code>sudo vi /etc/pam.d/okta-auth</code>
                                                                </p>
                                                                <p><code>auth sufficient pam_okta.so https://&lt;org name&gt;.okta.com &lt;<a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">client<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>Essentially, a client is anything that talks to the Okta service. Within the traditional client-server model, Okta is the server. The client might be an agent, an Okta mobile app, or a browser plugin. </span></a> id&gt; &lt;client secret&gt;</code>
                                                                </p>
                                                                <p>Replace <code style="font-size: 11pt;">&lt;org name&gt;</code>, <code style="font-size: 11pt;">&lt;client id&gt;</code> and <code style="font-size: 11pt;">&lt;client secret&gt;</code> with the correct values for your org. </p>
                                                                <p><b>Important: </b> To find the values for the client id and client secret to use, in Okta navigate to <b>Applications</b>, and then select the app you created in <a href="#Part2">Part 2</a>, above. Select the <b>General</b> tab and locate the values for <b>Client ID</b> and <b>Client secret</b>.
Org name is the org portion of your Okta url.</p>
                                                                <p><u>Example</u>
                                                                </p>
                                                                <p><code>auth sufficient pam_okta.so https://yourOrg.okta.com 0oabcdefghijklmno123 abcdefghijklmnopqrstuvwxyz_0123456789-AB</code>
                                                                </p>
                                                            </li>
                                                            <li value="7">
                                                                <p>Edit the <em>/etc/pam.d/sshd</em> file, and set the auth section to look like the following. This step comments out the line <code style="font-size: 11pt;">auth substack password-auth</code>, adds in new values that were covered by that line, edits the basic auth to be requisite instead of sufficient, and makes a sufficient password authentication with <code style="font-size: 11pt;">pam_okta_mfa_authenticate</code>.</p>
                                                                <p><pre xml:space="preserve">
auth    required     pam_sepermit.so
# auth    substack     password-auth
auth    required     pam_env.so
auth    requisite    pam_unix.so nullok try_first_pass
auth    include   okta-auth
auth    requisite    pam_succeed_if.so uid &gt;= 1000 quiet_success
auth    required     pam_deny.so
auth    include      postlogin</pre>
                                                                </p>
                                                                <p><b>Note:</b> The reference to <em>okta-auth</em> is used instead of inserting the contents of that file to provide the ability to use any more restrictive permissions that exist on that file.</p>
                                                            </li>
                                                            <li value="8">
                                                                <p>(Optional) Enable public key authentication for PAM</p>
                                                                <ul>
                                                                    <li value="1">
                                                                        <p>In<em> /etc/ssh/sshd_config</em>, set the following to turn off password-based authentication.</p>
                                                                        <p><pre xml:space="preserve">
AuthenticationMethods publickey,keyboard-interactive</pre>
                                                                        </p>
                                                                    </li>
                                                                    <li value="2">
                                                                        <p>Next, comment out the auth line with <em>pam_unix.so in /etc/pam.d/sshd</em>. With this change, the auth section looks like:</p>
                                                                        <p><pre xml:space="preserve">
auth required pam_sepermit.so
auth required pam_env.so
# auth requisite pam_unix.so nullok try_first_pass
auth include okta-auth
auth requisite pam_succeed_if.so uid &gt;= 1000 quiet_success
auth required pam_deny.so
auth include postlogin</pre>
                                                                        </p>
                                                                    </li>
                                                                </ul>
                                                            </li>
                                                            <li value="9">
                                                                <p>Restart the sshd service with the following command.</p>
                                                                <p><pre xml:space="preserve">
service sshd restart</pre>
                                                                </p>
                                                            </li>
                                                        </ol>
                                                    </div>
                                                </div>
                                                <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" /></a><a name="Part5"></a><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_"> Part 5 – Troubleshooting</a></span>
                                                    <div class="MCDropDownBody dropDownBody">
                                                        <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Logs</a></span>
                                                            <div class="MCDropDownBody dropDownBody">
                                                                <p>Logs can be viewed at <b>/var/log/secure</b>. These logs can help  pinpoint issues during sign in.</p>
                                                            </div>
                                                        </div>
                                                        <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Debugging with pamtester</a></span>
                                                            <div class="MCDropDownBody dropDownBody">
                                                                <p>You can use pamtester as a debugging tool. Obtain and install pamtester from SourceForge, then use the following command to test your configuration:</p>
                                                                <p><pre xml:space="preserve">
pamtester -v sshd &lt;unix-login&gt; authenticate</pre>
                                                                </p>
                                                                <p>You can also experiment with configurations by creating a file in <code style="font-size: 11pt;">/etc/pam.d/</code> with the rules you want to experiment with. As an example, create a file at <code style="font-size: 11pt;">/etc/pam.d/test</code> with the following content:</p>
                                                                <p><pre xml:space="preserve">
auth sufficient pam_okta.so https://yourOrg.okta.com 0oabcdefghijklmno123 abcdefghijklmnopqrstuvwxyz_0123456789-AB</pre>
                                                                </p>
                                                                <p>With the command shown below, you will be prompted directly for MFA with Okta:</p>
                                                                <p><pre xml:space="preserve">
pamtester -v test &lt;unix-login&gt; authenticate</pre>
                                                                </p>
                                                                <p>Note that <code style="font-size: 11pt;">test</code> above denotes the service name, which corresponds to the name of the file created in the <code style="font-size: 11pt;">/etc/pam.d</code> directory.</p>
                                                            </div>
                                                        </div>
                                                        <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Peer reports incompatible or unsupported protocol version</a></span>
                                                            <div class="MCDropDownBody dropDownBody">
                                                                <p>When installing the UNIX PAM module on a stock CentOS 7 image, the UNIX PAM module will report the following error:<em> peer reports incompatible or unsupported protocol version</em>.</p>
                                                                <p>The stock CentOS 7 install does not support TLS 1.2. Running the following command, followed by a recompile of the UNIX PAM module fixes the issue:</p>
                                                                <p><code>yum update -y nss curl libcurl</code>
                                                                </p>
                                                            </div>
                                                        </div>
                                                        <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />User gets prompted for password repeatedly</a></span>
                                                            <div class="MCDropDownBody dropDownBody">
                                                                <p>This could happen if the user is not assigned the PAM app in Okta. After creating and assigning the PAM app to the user, they should be able to login.</p>
                                                                <p>Before you can create a PAM app, you may need to assign the PAM agent and the private app to your org if it was not previously done. These instructions to do this are Part 2, above.</p>
                                                            </div>
                                                        </div>
                                                        <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />User is not prompted for password</a></span>
                                                            <div class="MCDropDownBody dropDownBody">
                                                                <p>When trying to log in with a password, if user gets the following error,</p>
                                                                <p><pre xml:space="preserve">
Permission denied (publickey,gssapi-keyex,gssapi-with-mic)</pre>
                                                                </p>
                                                                <p>check that <b>PasswordAuthentication</b> is set to yes in <code style="font-size: 11pt;">/etc/ssh/sshd_config</code>. Note that  you might have to set the user's password first and then, restart the SSHD service.</p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- Back to Top button --><a href="#" class="sf-back-to-top"><span class="arrow"></span>Top</a>
                                            </div>
                                        </div>
                                        <!-- *** Col3: Right menu Col *** -->
                                        <div class="is-not-in-mobile">
                                        </div>
                                    </div>
                                    <!-- ***************************** Footer rows ********************************* -->
                                    <div class="footer-temp">
                                        <div class="is-not-in-mobile">
                                            <p> </p>
                                        </div>
                                        <div>
                                            <p class="copyright">©  <span class="okta-variablesYear">2019</span> <span class="okta-variablesCompanyName">Okta, Inc</span> All Rights Reserved. Various trademarks held by their respective owners.</p>
                                        </div>
                                    </div>
                                    <!-- ***************************** Scripts ************************************* -->
                                    <!-- Foundation -->
                                    <script src="../../Resources/Scripts/js/app.js">
                                    </script>
                                    <script src="../../Resources/Scripts/js/vendor/what-input.js">
                                    </script>
                                    <script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/6.4.4-rc1/js/foundation.min.js">
                                    </script>
                                    <!-- Ours -->
                                    <script type="text/javascript" src="../../Resources/Scripts/back-to-top.js">
                                    </script>
                                    <script type="text/javascript" src="../../Resources/Scripts/get-feedback.js">
                                    </script>
                                    <!-- Coveo -->
                                    <script src="https://static.cloud.coveo.com/searchui/v2.5395/js/CoveoJsSearch.Lazy.min.js">
                                    </script>
                                    <script src="../../Resources/Scripts/coveo-resources/js/cultures/en.js" id="coveoCultureScript">
                                    </script>
                                    <script src="../../Resources/Scripts/coveo-resources/js/Coveo.MadcapFlare.RequireJS.js" id="coveoRequireScript">
                                    </script>
                                    <script src="../../Resources/Scripts/coveo-resources/js/Coveo.MadcapFlare.Okta.js" id="coveoInitscript">
                                    </script>
                                </div>
                            </div>
                        </div>
                    </section><a data-close="true"></a>
                </div>
            </div>
            <script>/* <![CDATA[ */$(document).foundation();/* ]]> */</script>
        </div>
    </body>
</html>