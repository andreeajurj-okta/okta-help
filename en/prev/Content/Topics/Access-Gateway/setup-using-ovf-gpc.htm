<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_okta_html5_topnav" data-mc-search-type="Stem" data-mc-help-system-file-name="okta_help.xml" data-mc-path-to-help-system="../../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="typeofcontent" content="documentation" />
        <meta name="audience" content="admin" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Setup Access Gateway using Google Cloud  | Okta</title>
        <meta charset="utf-8" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, height=device-height" />
        <link rel="shortcut icon" href="../../Resources/Images/favicon.ico" type="image/x-icon" />
        <!-- Google Tag Manager -->
        <script>
			/* <![CDATA[ */
			(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], 
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
			})(window,document,'script','dataLayer','GTM-TJ45R6');
			/* ]]> */
		</script>
        <!-- End Google Tag Manager -->
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/okta-main.css" rel="stylesheet" />
        <link href="https://static.cloud.coveo.com/searchui/v2.5395/css/CoveoFullSearchNewDesign.css" rel="stylesheet" />
        <style>/*&lt;meta /&gt;*/

.button.expand-all-button
{
	-pie-background: url('../../../Skins/Default/Stylesheets/Images/expand-all-non-hover-sm.png') no-repeat center center, linear-gradient(#fff, #fff);
}

.button.collapse-all-button
{
	-pie-background: url('../../../Skins/Default/Stylesheets/Images/collapse-all-non-hover-sm.png') no-repeat center center, linear-gradient(#fff, #fff);
}

.needs-pie
{
	behavior: url('../../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.6.2.3_custom.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="small" data-mc-ignore="true">
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <button class="menu-icon" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="https://support.okta.com/help/s/" alt="Okta"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="2" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" placeholder="Search" />
                                                <div class="search-filter-wrapper">
                                                    <div class="search-filter">
                                                        <div class="search-filter-content">
                                                            <ul>
                                                                <li>All Files</li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search">
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <section class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <div class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </div>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <!-- Google Tag Manager (noscript) -->
                                    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TJ45R6" height="0" width="0" style="display:none;visibility:hidden"></iframe>
                                    </noscript>
                                    <!-- End Google Tag Manager (noscript) -->
                                    <!-- Coveo config parameters -->
                                    <div id="coveo_org_id" style="Display:None"><span class="okta-coveo-configOrgId">oktaproduction9ounvcxa</span>
                                    </div>
                                    <div id="coveo_rest_uri" style="Display:None"><span class="okta-coveo-configPlatformRestUri">https://platform.cloud.coveo.com/rest/search</span>
                                    </div>
                                    <div id="coveo_search_url" style="Display:None"><span class="okta-coveo-configSearchPageUrl">https://support.okta.com/help/s/global-search/%40uri</span>
                                    </div>
                                    <div id="coveo_token_url" style="Display:None"><span class="okta-coveo-configSearchTokenServiceUrl">https://support.okta.com/help/services/apexrest/PublicSearchToken?site=help</span>
                                    </div>
                                    <!-- End Coveo config parameters -->
                                    <!-- ************************* Coveo Search bar ************************************* -->
                                    <div id="OLC_Coveo_Headline" class="coveo-headline-wrapper">
                                        <div class="slds-p-vertical_small">
                                            <!--Search Bar-->
                                            <div class="slds-grid slds-grid_align-center">
                                                <div id="customSelect" class="CoveoCustomSelect slds-float_right">
                                                </div>
                                                <div id="standaloneSearchbox">
                                                    <div class="CoveoAnalytics" data-search-hub="OktaCommunityFullSearch">
                                                    </div>
                                                    <div class="CoveoTab" data-id="Help" data-caption="Help" style="display:none">
                                                    </div>
                                                    <div class="CoveoSearchbox" data-enable-omnibox="true" data-enable-query-suggest-addon="true">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- **********************  Main content row  ********************** -->
                                    <div class="okta-topics">
                                        <!-- *** Col1: Left Nav Col *** -->
                                        <div class="is-not-in-mobile">
                                            <div data-sticky-container="" id="kMmzQ4NRc0u3ZieItE_7tg">
                                                <div class="sticky sticky-menu" style="width:100%" data-sticky="" data-top-anchor="kMmzQ4NRc0u3ZieItE_7tg:top" data-bottom-anchor="contentBody:bottom" data-sticky-on="small" data-scroll-container-on="small">
                                                    <ul class="nocontent menu _Skins_okta_left_menu mc-component" data-mc-linked-toc="Data/Tocs/left_nav_TOC.js" data-mc-side-menu="True" data-mc-max-depth="2" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- *** Col2: Body Col *** -->
                                        <div>
                                            <div class="is-not-in-mobile">
                                                <!-- Breadcrumbs -->
                                            </div>
                                            <div class="toolbar-main">
                                                <!-- Expand/Collapse All for drop-downs -->
                                                <div class="buttons popup-container clearfix topicToolbarProxy _Skins_okta_toolbar mc-component nocontent" style="mc-topic-toolbar-items: ;">
                                                    <div class="button-group-container-left">
                                                        <button class="button needs-pie expand-all-button" data-state1-class="expand-all-button" data-state2-class="collapse-all-button" data-state2-title="Collapse all" title="Expand all" data-state1-title="Expand all">
                                                            <img src="../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="expand all" />
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="body-main">
                                                <!-- Main content body -->
                                                <h1>Setup Access Gateway using Google Cloud </h1>
                                                <hr width="100%" size="0" align="center" />
                                                <h2><a name="Overview"></a>Overview</h2>
                                                <p>The purpose of this guide is to walk through the process of installing the Access Gateway software appliance into a Google Cloud instance. </p>
                                                <hr width="100%" size="0" align="center" />
                                                <h2><a name="Prerequisites"></a>Prerequisites</h2>
                                                <ul style="list-style-type: square;">
                                                    <li value="1">You have reviewed all <a href="pre-install-requirements.htm" class="MCXref xref">Prerequisites for Deploying Access Gateway</a></li>
                                                    <li value="2">You have installed and are familiar with the Google Cloud CLI.<br />Those intending to ONLY&#160;use the console UI&#160;need not install the Google Cloud CLI&#160;support.<br />See <a href="setup-gcp-cli.htm" class="MCXref xref">Setup Google Cloud Command Line interface</a> for an introduction to downloading and configuring the Google Cloud Azure CLI.</li>
                                                    <li value="3">You have installed <a href="https://www.virtualbox.org/">Virtual Box v6.0</a> or later. </li>
                                                    <li value="4">The installed the <b>qemu</b> virtual disk utility. <br />For more information and assistance installing the qemu virtual disk utility see <a href="setup-qemu-image-utility.htm" class="MCXref xref">Installing the QEMU Virtual Disk Utility</a>.<br /></li>
                                                    <li value="5">You have installed </li>
                                                </ul>
                                                <hr width="100%" size="0" align="center" />
                                                <h2><a name="What’s"></a>What’s covered in this guide</h2>
                                                <div>
                                                    <p> In order to use the OVA&#160;with Microsoft Azure we must:</p>
                                                    <ol style="list-style-type: square;">
                                                        <li value="1"><a href="#Download_OVA" class="MCXref xref">Download the latest OVA&#160;image.</a>
                                                        </li>
                                                        <li value="2"><a href="#PrepareImage" class="MCXref xref">Prepare Image</a>
                                                        </li>
                                                        <li value="3"><a href="#DefineResourceGroup" class="MCXref xref">Create project, region and zone</a>
                                                        </li>
                                                        <li value="4"><a href="#SetPrivs" class="MCXref xref">Enable Privileges</a>
                                                        </li>
                                                    </ol>
                                                </div>
                                                <hr width="100%" size="0" align="center" />
                                                <div>
                                                    <h2><a name="Download_OVA"></a>Download the latest OVA&#160;image.</h2>
                                                    <p>To download the latest Okta Access Gateway OVA Image:</p>
                                                    <ol>
                                                        <li value="1">
                                                            <p>Login to your Okta <a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">Org<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>The Okta container that represents a real-world organization.</span></a> as <a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">Admin<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>An abbreviation of administrator. This is the individual(s) who have access to the Okta Administrator Dashboard. They control the provisioning and deprovisioning of end users, the assigning of apps, the resetting of passwords, and the overall end user experience. Only administrators have the Administration button on the upper right side of the My Applications page.</span></a>. </p>
                                                        </li>
                                                        <li value="2">
                                                            <p>Download the Okta Access Gateway image from the <b>Settings &gt; Downloads</b> page.</p>
                                                        </li>
                                                        <li value="3">
                                                            <p>When prompted save the file to an appropriate location.</p>
                                                        </li>
                                                    </ol>
                                                </div>
                                                <div>
                                                    <hr width="100%" size="0" align="center" />
                                                    <h2><a name="PrepareImage"></a>Prepare Image</h2>
                                                    <p>Google Cloud  cannot import the Access Gateway OVA unchanged. <br />To prepare the image we must:</p>
                                                    <ul>
                                                        <li value="1">Import the and configure Virtual Box Image Settings</li>
                                                        <li value="2">Export the image</li>
                                                    </ul>
                                                    <p>&#160;</p>
                                                    <p>Import the and configure Virtual Box Image Settings:</p>
                                                    <ol>
                                                        <li value="1">Start <b>VirtualBox</b></li>
                                                        <li value="2">Import the OVA<ol style="list-style-type: lower-alpha;"><li value="1">Choose <b>File &gt; Import Appliance</b></li><li value="2">Navigate to the directory containing the downloaded Access Gateway OVA file, and click <b>Open</b></li><li value="3">Click <b>Continue</b>. </li><li value="4">Set the following VM Options:<ol style="list-style-type: lower-alpha;"><li value="1">Assign the VM a meaningful name.</li><li value="2">Specify Generate New MAC addresses for all network adapters.</li><li value="3">Uncheck Import hard drives as VDI. Note that Google Public Cloud requires disks be created in VMDK format.</li></ol><img src="../../Resources/Images/access-gateway/setup-using-ovf-gpc.05.png" id="img_new" alt="Virtual Box import applications settings dialog with options highlighted. " /></li><li value="5">Click <b>Import</b>.<br />Wait for the import to complete.</li></ol></li>
                                                        <li value="3">From the virtual machine list, select the name of the Virtual Machine just imported.</li>
                                                        <li value="4">Right click the VM name and choose <b>Start &gt; Normal Start</b>.<br />Wait for the Access Gateway instance to start.</li>
                                                        <li value="5">Export the updated OVA<ol style="list-style-type: lower-alpha;"><li value="1">In the Access Gateway command console enter <b>5 - System</b></li><li value="2">Select <b>6 - Shutdown.</b></li><li value="3">Enter <b>y </b>to confirm the shutdown<b>.<br /></b>Wait as the gateway appliance shuts down<b>. </b></li><li value="4">Right click and choose <b>Export to OCI</b>.</li><li value="5">Select <b>Open Virtualization Format 2.0</b>.</li><li value="6">Ensure that the file name for the export ends in OVA.</li><li value="7">Under <b>MAC&#160;Address Policy,</b> select <b>Include all network adapter MAC addresses</b>.</li><li value="8">Click <b>Continue</b></li><li value="9">Click <b>Export</b>. </li></ol></li>
                                                        <li value="6">Exit Virtual Box</li>
                                                    </ol>
                                                </div>
                                                <div>
                                                    <hr width="100%" size="0" align="center" />
                                                    <h2><a name="DefineResourceGroup"></a>Create project, region and zone</h2>
                                                    <p>Google cloud manages resources using projects, regions and zones. Projects are simple containers for artifacts. Regions represent geographic areas, with zones representing a finer area with a region.</p>
                                                    <ol>
                                                        <li value="1">To create a project:</li>
                                                        <li value="2">
                                                            <ol style="list-style-type: lower-alpha;">
                                                                <li value="1">Login to the Google Cloud Portal at <a href="http://cloud.google.com/">cloud.google.com</a>. </li>
                                                                <li value="2">Click <b>Console</b>. </li>
                                                                <li value="3">In the Console, select the project drop down and choose <b>New Project</b>. <br /><img src="../../Resources/Images/access-gateway/setup-using-ovf-gpc.01.png" id="img_new" alt="New project dialog" /></li>
                                                                <li value="4">In the new <i>Project</i> dialog enter a <b>Project name.</b> <br />Optionally select a <b>Location</b>.</li>
                                                                <li value="5">Click <b>Create</b>. <br />The new project creation may take several minutes.</li>
                                                                <li value="6">Once complete select the newly created project from the project list dropdown.</li>
                                                            </ol>
                                                            <p>&#160;</p>
                                                            <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />To create a project at the command line</a></span>
                                                                <div class="MCDropDownBody dropDownBody">
                                                                    <ol style="list-style-type: lower-alpha;">
                                                                        <li value="1">Login to the Google Cloud<br /><pre id="code" xml:space="preserve">gcloud auth login</pre>A browser page will open, enter appropriate credentials and login to the Google Cloud:
				</li>
                                                                        <li value="2">Create a new project using <span class="code">gcloud project create <i>projectName</i>.</span><br />For example:<br /><pre id="code">gcloud projects create <i>accessgateway</i></pre>Which will produce results similar to:<br /><pre id="code">Create in progress for [https://cloudresourcemanager.googleapis.com/v1/projects/accessgateway].
Waiting for [operations/cp.6360392293679086985] to finish...done.
Enabling service [cloudapis.googleapis.com] on project [accessgateway]...
Operation "operations/acf.2e54ecd8-a4ed-4935-9de9-d367b5996552" finished successfully.</pre></li>
                                                                        <li value="3">Set the project as the default project using <span class="code">gcloud config set project <i>projectName</i></span>.<br />For example <br /><pre id="code">gcloud config set project <i>accessgateway</i></pre>Which will return a result similar to:<br /><pre id="code">Updated property [core/project]</pre></li>
                                                                        <li value="4">List all known zones and regions using the <span class="code">gcloud compute zones</span> list command. <br />For example:<br /><pre id="code" xml:space="preserve">gcloud compute zones list</pre>Which will produce output similar to:
										<pre id="code" xml:space="preserve">NAME          REGION       STATUS  . . . 
us-east1-b    us-east1     UP
us-east1-c    us-east1     UP
us-east1-d    us-east1     UP
us-east4-c    us-east4     UP 
. . . 
</pre></li>
                                                                        <li style="font-weight: bold;" value="5">Specify a default region and zone using the command <pre id="code" xml:space="preserve">cloud compute project-info add-metadata \
-metadata google-compute-default-region=<i>&lt;region&gt;</i>,google-compute-default-zone=<i>&lt;zone&gt;</i></pre>Where:
									<ul><li value="1"><i>&lt;region&gt;</i> is one of the regions from the regions list</li><li value="2"><span style="font-weight: normal; font-style: italic;">&lt;<b>zone</b>&gt;</span> is one of the zones within the region</li></ul> 
									For example:
									<pre id="code" xml:space="preserve">gcloud compute project-info add-metadata \
--metadata google-compute-default-region=useast1,google-compute-default-zone=useast1-b</pre>Which should produce results similar to:<pre id="code" xml:space="preserve">Updated [https://www.googleapis.com/compute/v1/projects/accessgateway].</pre></li>
                                                                        <li value="6">
                                                                            <div class="noteOkta">
                                                                                <img src="../../Resources/Images/assets/Icons/Notes/Help.png" class="noteImgFloat" title="Info" alt="Info" />
                                                                                <p class="noteHeading">Note</p>
                                                                                <p class="noteContent">You can set a default zone and region using the following commands.<br /><span class="code">gcloud config set compute/region &lt;region&gt;</span> and <span class="code">gcloud config set compute/zone &lt;zone&gt;</span><br /><br /></p>
                                                                            </div>
                                                                        </li>
                                                                    </ol>
                                                                </div>
                                                            </div>
                                                        </li>
                                                    </ol>
                                                </div>
                                                <div>
                                                    <hr width="100%" size="0" align="center" />
                                                    <h2><a name="SetPrivs"></a>Enable Privileges</h2>
                                                    <p>The Google cloud environment requires certain privileges in order to import a virtual application. &#160;These privileges are:</p>
                                                    <ul>
                                                        <li value="1"><b>roles/compute.admin</b>
                                                        </li>
                                                        <li value="2"><b>roles/storage.admin</b>
                                                        </li>
                                                        <li value="3"><b>roles/iam.serviceAccountUser</b>
                                                        </li>
                                                        <li value="4"><b>roles/iam.serviceAccountTokenCreator</b>
                                                        </li>
                                                    </ul>
                                                    <p>To enable privileges</p>
                                                    <ol>
                                                        <li value="1">Login to the Google Cloud Portal at <a href="http://cloud.google.com/">cloud.google.com</a>. </li>
                                                        <li value="2">Click <b>Console</b>. </li>
                                                        <li value="3">In the Console menu select <b>APIs &amp;&#160;Services</b>.</li>
                                                        <li value="4">In the <i>APIs and Services</i> Dashboard click <b>Enable APIS and SERVICES</b></li>
                                                        <li value="5">In the <i>Search</i> window enter <b>Cloud Build API.</b> and click its name.</li>
                                                        <li value="6">Click Enable.<br /></li>
                                                    </ol>
                                                    <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />To enable privileges at the command line</a></span>
                                                        <div class="MCDropDownBody dropDownBody">
                                                            <p>Project id and project number are required to enable the required privileges to import a virtual appliance. <br />				To display project information use the <span class="code">gcloud projects describe &lt;project&gt;</span><br />For example:<br /><pre id="code">gcloud projects describe <b style="font-style: italic;">accessgateway</b></pre>Which should produce results resembling:
					<pre id="code">createTime: '2020-01-07T21:11:56.257Z'
lifecycleState: ACTIVE
name: accessgateway
projectId: <b>accessgateway</b>
projectNumber: '<b>840912134923</b></pre></p>
                                                            <p>To enable privileges at the command line use the <span class="code">gcloud projects add-iam-policy-binding</span> command which should resemble:<br /><pre id="code" xml:space="preserve">gcloud projects add-iam-policy-binding <b style="font-style: italic;">&lt;projectId&gt;</b> <br /> --member serviceAccount:&lt;<b style="font-style: italic;">projectNumber</b>&gt;@cloudbuild.gserviceaccount.com --role &lt;<b style="font-style: italic;">role</b>&gt;</pre>where:
						</p>
                                                            <ul>
                                                                <li value="1">&lt;<b>projectId</b>&gt; is the project </li>
                                                                <li value="2">&lt;<b>projectNumber</b>&gt; is the project number</li>
                                                                <li value="3">&lt;<b>role</b>&gt; is one of the required roles.</li>
                                                            </ul>
                                                            <ol>
                                                                <li value="1">Add the <b>roles/compute.admin</b> privilege. <br />For example:<br /></li><pre id="code" xml:space="preserve">gcloud projects add-iam-policy-binding accessgateway-264515 
       --member serviceAccount:840912134923@cloudbuild.gserviceaccount.com 
      --role roles/compute.admin</pre>
                                                                <p>Which will return a result resembling:<br /><pre id="code" xml:space="preserve">Updated IAM policy for project [accessgateway-264515].
. . . 
role: roles/compute.admin - members:
     - serviceAccount:service-840912134923@compute-system.iam.gserviceaccount.com
. . .
- members:
- user:user@tld.com
role: roles/owner
etag: BwWcBqsBK84=
version: 1												
</pre></p>
                                                                <li value="2">Repeat for <b>roles/iam.serviceAccountUser</b>. <br />For example:<br /><pre id="code" xml:space="preserve">gcloud projects add-iam-policy-binding accessgateway-264515 
      --member serviceAccount:840912134923@cloudbuild.gserviceaccount.com 
      --role roles/iam.serviceAccountUser</pre></li>And<li value="3"><b>roles/iam.serviceAccountTokenCreator</b>: <br />For example:<br /><pre id="code" xml:space="preserve">gcloud projects add-iam-policy-binding accessgateway-264515 
      --member serviceAccount:840912134923@cloudbuild.gserviceaccount.com 
      --role roles/iam.serviceAccountTokenCreator</pre></li></ol>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div>
                                                    <hr width="100%" size="0" align="center" />
                                                    <h2><a name="ImportDisk"></a>Import OVA&#160;Image</h2>
                                                    <p>To import an image:</p>
                                                    <ul>
                                                        <li value="1"><a href="#CreateBucket" class="MCXref xref">Create a Bucket</a>
                                                        </li>
                                                        <li value="2"><a href="#Upload2Bucket" class="MCXref xref">Upload an image to a bucket</a>
                                                        </li>
                                                    </ul>
                                                    <h3><a name="CreateBucket"></a>Create a Bucket</h3>
                                                    <ol>
                                                        <li value="1">Login to the Google Cloud Portal at <a href="http://cloud.google.com/">cloud.google.com</a>. </li>
                                                        <li value="2">Click <b>Console</b>. </li>
                                                        <li value="3">Using the console menu navigate to <b>Storage &gt; Storage</b>.</li>
                                                        <li value="4">Create a bucket.<ol style="list-style-type: lower-alpha;"><li value="1">Ensure you are in the correct project by selecting the parent project from the Projects dropdown.</li><li value="2">Click <b>Create Bucket</b>.</li><li value="3">Name the bucket and click <b>Continue</b>. For example <b style="font-style: normal;">oagbucket</b>.</li><li value="4">Select an appropriate location type and location and the click <b>Continue</b>. <br />For example, <i>Location type</i> of <b>Region</b> and <i>Location</i> of <b>us-east1</b>. <br /><img src="../../Resources/Images/access-gateway/setup-using-ovf-gpc.02.png" alt="Example location within a Google Cloud bucket." id="img_new" /></li><li value="5">Choose <i>Access control</i> level of either <b>Fine grained</b> or <b>Uniform</b> and click <b>Continue</b>. </li><li value="6">Click <b>Create</b>. <br /></li></ol></li>
                                                    </ol>
                                                    <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />To create a bucket using the command line:</a></span>
                                                        <div class="MCDropDownBody dropDownBody">
                                                            <ol>
                                                                <li value="1">Login to the Google Cloud<br /><pre id="code" xml:space="preserve">gcloud auth login</pre>A browser page will open, enter appropriate credentials and login to the Google Cloud.:
					</li>
                                                                <li value="2">If necessary list all known projects<br /><pre xml:space="preserve" id="code">gcloud projects list</pre>which will produce results similar to:<br /><pre xml:space="preserve" id="code">PROJECT_ID              NAME              PROJECT_NUMBER<br />accessgateway           accessgateway     840912134923<br />. . . </pre></li>
                                                                <li value="3">Add a new bucket using the <span class="code">gsutils mb </span><br /><pre id="code" xml:space="preserve">gsutil mb -p <i>&lt;project&gt;</i> -c <i>&lt;storage-class&gt;</i> -l <i>&lt;bucket-location&gt;</i> gs://<i>&lt;name&gt;</i>/</pre>Where:<ul><li value="1"><b>&lt;name&gt;</b> is the name of the bucket</li><li value="2"><b>&lt;project_name&gt;</b>&#160;is the name of a project from the projects list</li><li value="3"><b>&lt;storage-class&gt;</b> is a valid storage class identifier</li><li value="4"><b>&lt;bucket-location&gt;</b>&#160;is a valid bucket location identifier.</li></ul><p>For example</p><pre id="code" xml:space="preserve">gsutil mb -p accessgateway -c NEARLINE -l us-east1 gs://oagbucket</pre></li>
                                                            </ol>
                                                            <p>&#160;</p>
                                                        </div>
                                                    </div>
                                                    <h3><a name="Upload2Bucket"></a>Upload an image to a bucket</h3>
                                                    <p>To upload an ova image to a bucket</p>
                                                    <ol>
                                                        <li value="1">Login to the Google Cloud Portal at <a href="http://cloud.google.com/">cloud.google.com</a>. </li>
                                                        <li value="2">Navigate to the console.</li>
                                                        <li value="3">Using the console menu navigate to <b>Storage &gt; Storage</b>.</li>
                                                        <li value="4">In the <b>Storage Browse</b>r pane click the name of the bucket.<br /><img src="../../Resources/Images/access-gateway/setup-using-ovf-gpc.03.png" id="img_new" alt="Google Cloud storage browser with OAG Bucket high lighted." /><br /></li>
                                                        <li value="5">Click Upload files and navigate to the directory containing the exported OVA&#160;file. The file will begin uploading.<br /><br /><div class="noteOkta"><img src="../../Resources/Images/assets/Icons/Notes/Help.png" class="noteImgFloat" title="Info" alt="Info" /><p class="noteHeading">Note</p><p class="noteContent">Depending on upload speed the disk upload could take as much as an hour or more.</p></div></li>
                                                    </ol>
                                                    <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />To upload a disk image to a bucket using the command line</a></span>
                                                        <div class="MCDropDownBody dropDownBody">
                                                            <ol>
                                                                <li value="1">Copy the exported OVA&#160;bucket using <span class="code">gsutil cp &lt;<b style="font-style: italic;">file</b>&gt; gs://&lt;<b style="font-style: italic;">bucket</b>&gt;</span><br />Where:<ul><li value="1">&lt;<b style="font-style: italic;">file</b>&gt; is the fully qualified path to the local file</li><li value="2">&lt;<b style="font-style: italic;">bucket</b>&gt; is the previously created bucket.</li></ul><p>For example:</p><p><pre id="code" xml:space="preserve">gsutil cp ./oag-2020.1.0-export.ova gs://oagbucket</pre>Which will return results resembling:<br /><pre id="code" xml:space="preserve">Copying file://oag-2020.1.0-export.ova [Content-Type=application/octet-stream]<br />. . . \ [1 files][  1.47 GiB/  1.47 GiB]  556.3 KiB/s
Operation completed over 1 objects/1.47 GiB.</pre></p></li>
                                                            </ol>
                                                        </div>
                                                    </div>
                                                    <p>&#160;</p>
                                                </div>
                                                <div>
                                                    <hr width="100%" size="0" align="center" />
                                                    <h2><a name="CreateVM"></a>Create VM from imported OVA</h2>
                                                    <p>Google Cloud only supports converting OVA&#160;images to google cloud image using the command line. </p>
                                                    <p>To convert and make an OVA available</p>
                                                    <ul>
                                                        <li value="1"><a href="#ConvertOVA" class="MCXref xref">Convert an imported OVA </a>
                                                        </li>
                                                        <li value="2"><a href="#ConvertFW" class="MCXref xref">Configure Firewall</a>
                                                        </li>
                                                    </ul>
                                                    <div>
                                                        <h3><a name="ConvertOVA"></a>Convert an imported OVA </h3>
                                                        <ol>
                                                            <li value="1">Ensure that a compute zone has been set using gscloud config set compute/zone &lt;zone&gt;.<br />For example:<pre id="code">gcloud config set compute/zone useast-1</pre></li>
                                                            <li value="2">Convert the imported OVA&#160;into a Google Cloud VM using the <span class="code">gcloud compute instances import &lt;name&gt; --source-uri:&lt;uri-to-ova&gt; --os=centos-7</span> command. <br />For example:<pre id="code">gcloud compute instances import oagtwooh --source-uri=gs://oagbucket/oag-2020.1.0-export.ova  --os=centos-7</pre>Which should return results resembling:<pre id="code">WARNING: Importing OVF. This may take 40 minutes for smaller OVFs and up to a couple of hours for larger OVFs.
Created [https://cloudbuild.googleapis.com/v1/projects/accessgateway-264515/builds/5e2c4b8e-a9ba-413b-ab59-0643ea5475aa].
							. . . </pre></li>
                                                        </ol>
                                                    </div>
                                                    <div>
                                                        <h3><a name="ConvertFW"></a>Configure Firewall</h3>
                                                        <ol>
                                                            <li value="1">. . . </li>
                                                            <li value="2">. . . </li>
                                                        </ol>
                                                    </div>
                                                </div>
                                                <hr width="100%" size="0" align="center" />
                                                <div>
                                                    <h2><a name="Related_Topics"></a>Next Steps</h2>
                                                    <p>After Okta Access Gateway has been installed there are a number of common post installation tasks that should be performed. <br />		Including:
			</p>
                                                    <ul>
                                                        <li value="1"><a href="setup-post-install.htm#Determine_IPAddress">Determine the IP Address of the Okta Access Gateway virtual application.</a>
                                                        </li>
                                                        <li value="2"><a href="setup-post-install.htm#ConfigureLocal">Configure admin <span style="font-family: 'Courier New';">/etc/hosts</span> entry</a>
                                                        </li>
                                                        <li value="3"><a href="setup-post-install.htm#Initialize_Verify">Initialize the Command Line console</a>
                                                        </li>
                                                        <li value="4"><a href="setup-post-install.htm#Reset_Passwords">Reset Passwords</a>
                                                        </li>
                                                        <li value="5"><a href="setup-post-install.htm#InitializeUI">Initialize Access Gateway Admin UI&#160;Console</a>
                                                        </li>
                                                        <li value="6"><a href="setup-post-install.htm#ConfigureDNS">Configure DNS</a>
                                                        </li>
                                                        <li value="7"><a href="setup-post-install.htm#Add_Applications">Add Applications</a>
                                                        </li>
                                                    </ul>
                                                    <div>
                                                        <h2><a name="More_Information"></a>For More Information</h2>
                                                        <ul>
                                                            <li value="1">See <a href="setup-post-install.htm" class="MCXref xref">Okta Access Gateway Post Installation</a> for a complete task list.</li>
                                                            <li value="2">See  <a href="command-line-console-reference.htm" class="MCXref xref">Access Gateway Command Line Management Console Reference</a> for a complete list of management console commands.</li>
                                                            <li value="3">See <a href="admin-ui-console-overview.htm" class="MCXref xref">Access Gateway Admin UI Console Overview</a> for an overview of the Access Gateway UI&#160;console.</li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <!-- Back to Top button --><a href="#" class="sf-back-to-top"><span class="arrow"></span>Top</a>
                                            </div>
                                        </div>
                                        <!-- *** Col3: Right menu Col *** -->
                                        <div class="is-not-in-mobile">
                                        </div>
                                    </div>
                                    <!-- ***************************** Footer rows ********************************* -->
                                    <div class="footer-temp">
                                        <div class="is-not-in-mobile">
                                            <p> </p>
                                        </div>
                                        <div>
                                            <p class="copyright">©  <span class="okta-variablesYear">2020</span> <span class="okta-variablesCompanyName">Okta, Inc</span> All Rights Reserved. Various trademarks held by their respective owners.</p>
                                        </div>
                                    </div>
                                    <!-- ***************************** Scripts ************************************* -->
                                    <!-- Foundation -->
                                    <script src="../../Resources/Scripts/js/app.js">
                                    </script>
                                    <script src="../../Resources/Scripts/js/vendor/what-input.js">
                                    </script>
                                    <script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/6.4.4-rc1/js/foundation.min.js">
                                    </script>
                                    <!-- Ours -->
                                    <script type="text/javascript" src="../../Resources/Scripts/back-to-top.js">
                                    </script>
                                    <script type="text/javascript" src="../../Resources/Scripts/get-feedback.js">
                                    </script>
                                    <!-- Coveo -->
                                    <script src="https://static.cloud.coveo.com/searchui/v2.5395/js/CoveoJsSearch.Lazy.min.js">
                                    </script>
                                    <script src="../../Resources/Scripts/coveo-resources/js/cultures/en.js" id="coveoCultureScript">
                                    </script>
                                    <script src="../../Resources/Scripts/coveo-resources/js/Coveo.MadcapFlare.RequireJS.js" id="coveoRequireScript">
                                    </script>
                                    <script src="../../Resources/Scripts/coveo-resources/js/Coveo.MadcapFlare.Okta.js" id="coveoInitscript">
                                    </script>
                                </div>
                            </div>
                        </div>
                    </section><a data-close="true"></a>
                </div>
            </div>
            <script>/* <![CDATA[ */$(document).foundation();/* ]]> */</script>
        </div>
    </body>
</html>