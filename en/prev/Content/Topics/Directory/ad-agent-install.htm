<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_okta_html5_topnav" data-mc-search-type="Stem" data-mc-help-system-file-name="okta_help.xml" data-mc-path-to-help-system="../../../" data-mc-has-content-body="True" data-mc-searchable="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Documentation|Product documentation|Directory Integrations|Okta Active Directory">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="typeofcontent" content="documentation" />
        <meta name="audience" content="admin" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="description" content="To integrate Active Directory with Okta, install and configure the Okta Active Directory (AD) agent on one or more Windows servers in your network." /><title>Install and configure the Okta Active Directory agent | Okta</title>
        <meta charset="utf-8" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, height=device-height" />
        <link rel="shortcut icon" href="../../Resources/Images/favicon.ico" type="image/x-icon" />
        <!-- Google Tag Manager -->
        <script>
			/* <![CDATA[ */
			(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], 
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
			})(window,document,'script','dataLayer','GTM-TJ45R6');
			/* ]]> */
		</script>
        <!-- End Google Tag Manager -->
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/okta-main.css" rel="stylesheet" />
        <link href="https://static.cloud.coveo.com/searchui/v2.5395/css/CoveoFullSearchNewDesign.css" rel="stylesheet" />
        <style>/*&lt;meta /&gt;*/

.button.expand-all-button
{
	-pie-background: url('../../../Skins/Default/Stylesheets/Images/expand-all-non-hover-sm.png') no-repeat center center, linear-gradient(#fff, #fff);
}

.button.collapse-all-button
{
	-pie-background: url('../../../Skins/Default/Stylesheets/Images/collapse-all-non-hover-sm.png') no-repeat center center, linear-gradient(#fff, #fff);
}

.needs-pie
{
	behavior: url('../../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.6.2.3_custom.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="small" data-mc-ignore="true">
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <button class="menu-icon" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="https://support.okta.com/help/s/" alt="Okta"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="2" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" placeholder="Search" />
                                                <div class="search-filter-wrapper">
                                                    <div class="search-filter">
                                                        <div class="search-filter-content">
                                                            <ul>
                                                                <li>All Files</li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search">
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <section class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <div class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </div>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <!-- Google Tag Manager (noscript) -->
                                    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TJ45R6" height="0" width="0" style="display:none;visibility:hidden"></iframe>
                                    </noscript>
                                    <!-- End Google Tag Manager (noscript) -->
                                    <!-- Coveo config parameters -->
                                    <div id="coveo_org_id" style="Display:None"><span class="okta-coveo-configOrgId">oktaproduction9ounvcxa</span>
                                    </div>
                                    <div id="coveo_rest_uri" style="Display:None"><span class="okta-coveo-configPlatformRestUri">https://platform.cloud.coveo.com/rest/search</span>
                                    </div>
                                    <div id="coveo_search_url" style="Display:None"><span class="okta-coveo-configSearchPageUrl">https://support.okta.com/help/s/global-search/%40uri</span>
                                    </div>
                                    <div id="coveo_token_url" style="Display:None"><span class="okta-coveo-configSearchTokenServiceUrl">https://support.okta.com/help/services/apexrest/PublicSearchToken?site=help</span>
                                    </div>
                                    <!-- End Coveo config parameters -->
                                    <!-- ************************* Coveo Search bar ************************************* -->
                                    <div id="OLC_Coveo_Headline" class="coveo-headline-wrapper">
                                        <div class="slds-p-vertical_small">
                                            <!--Search Bar-->
                                            <div class="slds-grid slds-grid_align-center">
                                                <div id="customSelect" class="CoveoCustomSelect slds-float_right">
                                                </div>
                                                <div id="standaloneSearchbox">
                                                    <div class="CoveoAnalytics" data-search-hub="OktaCommunityFullSearch">
                                                    </div>
                                                    <div class="CoveoTab" data-id="Help" data-caption="Help" style="display:none">
                                                    </div>
                                                    <div class="CoveoSearchbox" data-enable-omnibox="true" data-enable-query-suggest-addon="true">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- **********************  Main content row  ********************** -->
                                    <div class="okta-topics">
                                        <!-- *** Col1: Left Nav Col *** -->
                                        <div class="is-not-in-mobile">
                                            <div data-sticky-container="" id="YMB9uOSTNEiLjYTRd6VXdQ">
                                                <div class="sticky sticky-menu" style="width:100%" data-sticky="" data-top-anchor="YMB9uOSTNEiLjYTRd6VXdQ:top" data-bottom-anchor="contentBody:bottom" data-sticky-on="small" data-scroll-container-on="small">
                                                    <ul class="nocontent menu _Skins_okta_left_menu mc-component" data-mc-linked-toc="Data/Tocs/left_nav_TOC.js" data-mc-side-menu="True" data-mc-max-depth="2" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- *** Col2: Body Col *** -->
                                        <div>
                                            <div class="is-not-in-mobile">
                                                <!-- Breadcrumbs -->
                                                <div class="nocontent">
                                                    <div class="MCBreadcrumbsBox_0 breadcrumbs" data-mc-breadcrumbs-divider="  &gt;  " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix"></span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="toolbar-main">
                                                <!-- Expand/Collapse All for drop-downs -->
                                                <div class="buttons popup-container clearfix topicToolbarProxy _Skins_okta_toolbar mc-component nocontent" style="mc-topic-toolbar-items: ;">
                                                    <div class="button-group-container-left">
                                                        <button class="button needs-pie expand-all-button" data-state1-class="expand-all-button" data-state2-class="collapse-all-button" data-state2-title="Collapse all" title="Expand all" data-state1-title="Expand all">
                                                            <img src="../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="expand all" />
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="body-main">
                                                <!-- Main content body -->
                                                <h1>Install and configure the <span class="okta-feature-namesAD agent">Okta Active Directory (AD) agent</span></h1>
                                                <p>This topic walks you through the install and initial configuration options for the <span class="okta-feature-namesAD agent short">Okta AD <a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">agent<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>A software agent is a lightweight program that runs as a service outside of Okta. It is typically installed behind a firewall and allows Okta to tunnel communication between an on-premises service and Okta's cloud service. Okta employs several agent types: Active Directory, LDAP, RADIUS, RSA, Active Directory Password Sync, and IWA. For example, users can install multiple Active Directory agents to ensure that the integration is robust and highly available across geographic locations.</span></a></span>. You can change these settings any time as you refine your Okta configuration.</p>
                                                <p>Before installing the <span class="okta-feature-namesAD agent short">Okta AD agent</span>, make sure your AD data is cleansed to avoid duplicates and bad formats, and to ensure that the import process is clean and that your Okta data is normalized.</p>
                                                <div class="noteOkta">
                                                    <img src="../../Resources/Images/assets/Icons/Notes/Help.png" class="noteImgFloat" title="Info" alt="Info" />
                                                    <p class="noteHeading">Note</p>
                                                    <p class="noteContent">The AD <a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">app<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>An abbreviation of application. Essentially, it is a web-based site used to perform any number of specific tasks, and requires authentication from end users by signing in.</span></a> user profile schema requires both the first and last name. Therefore, while you can create an Okta mastered user without first or last name, you cannot import an AD user into Okta without first and last name.</p>
                                                </div>
                                                <hr width="100%" size="0" align="center" />
                                                <h2>Known Issues</h2>
                                                <ul>
                                                    <li value="1">
                                                        <p>If you are using the Custom URL&#160;feature and integrating with one of the Okta agents, take note of the following:</p>
                                                        <ul>
                                                            <li value="1"><b>Agents</b> – Need to be installed against the actual <a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">domain<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>A domain is an attribute of an Okta organization. Okta uses a fully-qualified domain name, meaning it always includes the top-level domain (.com, .eu, etc.), but does not include the protocol (https).</span></a> (<i>example</i>.okta.com), not the custom domain (<i>example</i>.<i>customname</i>.com). This applies to all agents. </li>
                                                            <li value="2"><b>If using IWA <a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">SSO<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>An acronym for single sign-on. In a SSO system, a user logs in once to the system and can access multiple systems without being prompted to sign in for each one. Okta is a cloud-based SSO platform that allows users to enter one name and password to access multiple applications. Users can access all of their web applications, both behind the firewall and in the cloud, with a single sign in. Okta provides a seamless experience across PCs, laptops, tablets, and smartphones.</span></a></b> – You should modify the <span style="font-family: 'Courier New';">web.config</span> file to include the custom url. The configuration will continue to work without these modifications, but it could cause confusion for your end user if their sign-in attempt  fails and they end up on a different domain. <p style="font-family: 'Courier New';font-size: 11pt;">&lt;oktaSSOConfigGroup&gt;</p><p style="font-family: 'Courier New';font-size: 11pt;">&lt;oktaSSOConfig orgOktaAuthenticationURL="https://example.customname.com/login/sso_iwa_auth"</p><p style="font-family: 'Courier New';font-size: 11pt;">orgBackupOktaAuthenticationURL="https://example.customname.com/login/default"</p><p style="font-family: 'Courier New';font-size: 11pt;">oktaSSOWebAp<span style="font-size: 11pt;">pVersion="1.11.5.0"&gt;</span></p></li>
                                                            <li value="3"><b>If you are using Agentless DSSO</b> – Because you can only specify one SPN when setting up Agentless DSSO, you should ensure that all your sign-in flows and browser bookmarks use the URL you want ADSSO to use.</li>
                                                        </ul>
                                                    </li>
                                                    <li value="2">After a new attribute is added to an AD domain, each <span class="okta-feature-namesAD agent short">Okta AD agent</span> connected to the domain needs to be restarted. Otherwise, the AD agents will base-64 encode the new attribute's values. This is due to a restriction set by <a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">Active Directory<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>Active Directory (AD) is a directory service that Microsoft developed for the Windows domain networks. It is included in most Windows Server operating systems as a set of processes and services. Initially, Active Directory was only in charge of centralized domain management.</span></a>.</li>
                                                </ul>
                                                <hr width="100%" size="0" align="center" />
                                                <h2>Requirements<a name="Requirements"></a></h2>
                                                <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Hardware requirements</a></span>
                                                    <div class="MCDropDownBody dropDownBody">
                                                        <p>You need one or more Windows servers in your network to install the Okta AD Agent upon. We call these servers <i>host servers</i>. These host servers must be on at all times and have a continuous connection to the Internet so that they can communicate with Okta.	</p>
                                                        <ul>
                                                            <li value="1">The host server can be a physical or virtual server</li>
                                                            <li value="2">The server should have at least 2 CPUs and a minimum of 8GB RAM</li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />OS&#160;and software requirements			</a></span>
                                                    <div class="MCDropDownBody dropDownBody">
                                                        <p>To ensure that you have up-to-date&#160;functionality and get optimum performance from your Okta AD agent(s), we strongly recommend that you download and install the latest version of the agent&#160;on your designated host server(s). If you are running multiple Okta AD agents, make sure that all of them are the same version. <i style="font-weight: bold;">Running different versions within a domain can cause all agents in that domain to function at the level of the oldest agent</i>. This does not affect other domains. </p>
                                                        <ul>
                                                            <li value="1"><b>The host server should run Windows server 2008 R2 or later, including Server 2016 and Windows Server 2019</b>&#160;— You need access to a Windows server to install the Okta AD Agent. You do not need to install the agent on the domain controller itself. Your system must have&#160;20Mb memory for the AD Service Account that is created upon agent installation. <br /><b>Note:</b>&#160;You must be running IE 10 or later on your Windows Server.</li>
                                                            <li value="2">
                                                                <p><b>.NET 4.5.2</b> (minimum)&#160;up to&#160;&#160;<b>.NET&#160;4.6.x</b> &#160;If you have a lower version of .NET, please upgrade to 4.5.2 or higher.</p>
                                                            </li>
                                                            <li value="3">To improve the security of AD integrations, we now default to the TLS1.2 security protocol in orgs running .NET Framework 4.5 or later. For Windows 2008 R2 TLS 1.2 is disabled by default and needs to be enabled through the registry. For details, see <a href="#TLS12">AD agent does not connect at startup</a>.</li>
                                                            <li value="4"><b>AD domain/forest functional level</b>&#160;— Okta supports an AD domain/forest functional level of 2003 and higher. For additional information on AD domain functional levels, see:&#160;<a href="https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/active-directory-functional-levels">https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/plan/security-best-practices/understanding-active-directory-domain-services--ad-ds--functional-levels</a><ul><li value="1">If you are using the AD domain functional level of 2003, we are aware of the following issue:&#160;AD usernames must be in the domain name format. That is, users must have a UPN&#160;that contains the <b>@domain.name</b> format.</li></ul></li>
                                                            <li value="5"><b>Member server</b>&#160;— The host server can be a member server in your AD domain or a domain controller. We recommend using a member server.</li>
                                                            <li value="6">
                                                                <p><b>Run the setup wizard from the host server</b> –&#160;We recommend running the agent setup wizard in a web browser on the host server where you want to install the agent. Otherwise, you must transfer the agent installer to the host server, and then run the installer</p>
                                                            </li>
                                                            <li value="7"><b>Must be a member server within your active directory forest</b>&#160;— The host server can be in a different domain than the one that your domain users reside , but must be in the same Active Directory forest. Placing the agent on a different domain may cause performance issues.</li>
                                                            <li value="8"><b>AD&#160;Password History policy</b> &#160;— To enforce the AD Password History policy, you must use Okta AD Agent version 3.4.1 or later and your AD Domain functional level should be Windows server 2008 R2 or higher.</li>
                                                            <li value="9"><b>High &#160;Availability</b>  &#160;— In order to ensure high availability and redundancy, we strongly recommend installing the agent on two or more systems.</li>
                                                            <li value="10"><b>Number of agents</b>  &#160;— If there are 30K or more users, we recommend deploying at least 3 AD agents.</li>
                                                        </ul>
                                                        <p>You will also be asked to decide:</p>
                                                        <ul>
                                                            <li value="1">the username format to use when importing AD users into Okta (Choose one from the options:&#160;email, samAccountName, UPN or custom). </li>
                                                            <li value="2">which OUs to import users and <a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">groups<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>Groups allow you to organize your end users and the apps they can access. Assigning apps to large sets of end users is made easier with groups.</span></a> from.</li>
                                                            <li value="3">which AD attributes to import to the Okta user profile.</li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <p><a name="AccountReqs"></a>
                                                </p>
                                                <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" /></a><a name="Accountsrequired"></a><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_">Accounts required for AD agent installation</a></span>
                                                    <div class="MCDropDownBody dropDownBody">
                                                        <ul>
                                                            <li value="1"><a href="#Oktaadmin">Okta admin account</a> — Used when you install the AD agent to allow the AD agent to connect to Okta. This account should be Okta-mastered, not AD-mastered.
The minimum <a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">admin<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>An abbreviation of administrator. This is the individual(s) who have access to the Okta Administrator Dashboard. They control the provisioning and deprovisioning of end users, the assigning of apps, the resetting of passwords, and the overall end user experience. Only administrators have the Administration button on the upper right side of the My Applications page.</span></a> role required for this account is <b><a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">Super admin<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>The super admin receives full access to every item in the Administrative Console and is the only role that can assign administrator roles to other user accounts. Accounts with other administrator role assignments have reduced functionalities to different permission sets. Contact Okta support to create an Okta Mastered account with Super Admin rights.</span></a></b>.          </li>
                                                            <li value="2"><a href="#ADuseraccount">AD user account to run the agent installer </a>— Used to sign in to host server and start the AD agent installer.</li>
                                                            <li value="3"><a href="#OktaService">Okta service account to run Okta AD Agent service</a> — This is an AD domain service or user account. It can be created by the installer (called OktaService by default)&#160;or you can select an existing account.</li>
                                                        </ul>
                                                        <h4><a name="Oktaadmin"></a>Create an Okta admin account</h4>
                                                        <p class="noteindent">For installation, you will need an Okta account, not an AD account, to connect the AD agent to Okta. To create this account, you must be a Super admin. </p>
                                                        <p class="noteindent">Okta recommends that you use a dedicated Okta admin account for the AD agent. If you use an individual's Super admin account to install and run the AD agent, and that individual later has their admin privileges lowered, revoked, or leaves the company and is deactivated, the Okta AD integration will stop working. If this occurs, you will need to uninstall the existing AD agent and reinstall the AD agent with a new Super admin account to reconnect Okta to AD.</p>
                                                        <p class="noteindent">To create an Okta admin account:</p>
                                                        <ol>
                                                            <li value="1">Sign in to your Okta Super admin account.</li>
                                                            <li value="2">Click <b>Admin</b> to open the Okta admin dashboard.</li>
                                                            <li value="3">Navigate to <b>Directory &gt; People</b> and click <b>Add Person</b>. Fill in the fields and click <b>Save</b>.</li>
                                                            <li value="4">Navigate to <b>Security &gt;&#160;Administrators</b> and click <b>Add Administrator</b>. <ol style="list-style-type: lower-alpha;"><li value="1">In the <b>Grant Administrator role to field</b>, begin typing the name of the user you added in step 3. Select the user from the list.</li><li value="2">Select the type of administrator role you want to assign to that person. The <b>Super Administrator</b> role is the minimum permission level needed for these agent install. For details on admin permissions, see <a href="../Security/Administrators.htm" class="MCXref xref">Administrators</a>.<br /></li></ol></li>
                                                        </ol>
                                                        <p>Okta recommends that the admin accounts used by the Okta AD agent be Okta-mastered and not AD-mastered. This does not affect existing administrators you have created who are AD mastered. We encourage you to disconnect your admins from AD (select&#160;<b>Directory &gt;&#160;People&#160;&gt; More Actions &gt;&#160;Disconnect from AD</b>, select the admin users who you want to disconnect, and then click the appropriate <b>Disconnect</b> button).</p>
                                                        <h4><a name="ADuseraccount"></a>AD user account to run the AD agent installer</h4>
                                                        <p>During agent installation, you are asked if you want the installer create the Okta service account. You need one of the following based on your choice:</p>
                                                        <ul>
                                                            <li value="1">An AD domain admin account if you want to let the installer create the Okta service account.</li>
                                                            <li value="2">An AD user account that has local administrator privilege on the host server if you want to use an existing domain user account as the Okta service account.</li>
                                                        </ul>
                                                        <h4><a name="OktaService"></a>Okta service account to run Okta AD agent service</h4>
                                                        <p>The Okta  service account can be created by the installer. By default it is called <b>OktaService</b>. If you choose to use an existing domain user account, be sure to set the account password to never expire. Managed Service accounts are not supported.</p>
                                                        <p>During installation, you are asked if you want to let the installer create the Okta service account. To do so, you must have the following permissions:</p>
                                                        <ul>
                                                            <li value="1">Be a member of the domain admins group. This is required because you must be able to create a new AD user in AD that will act as the AD agent service account.</li>
                                                            <li value="2">Have local administrator privileges. If you are installing the AD agent but using an existing user account to run as the service account, you only need local administrator privileges.</li>
                                                        </ul>
                                                        <p>With either option, the installer grants <b>logon as a service</b> to the domain user you select.</p>
                                                        <h5>Okta service account permissions</h5>
                                                        <p>The AD agent runs under the Okta account you specified (either the Okta service account the installer creates or the domain user you select during the agent install). Depending on the configuration of your integration, the agent performs the following actions:</p>
                                                        <ul>
                                                            <li value="1"><b>Read users, OUs, and groups</b> — Requires read access on the accessed objects. By default, a domain user has sufficient permission to do this. We recommend read access on the entire domain, but it is not required.</li>
                                                            <li value="2"><b>Authenticate users</b> — No special permissions are required.</li>
                                                            <li value="3"><b>Change user passwords (by supplying the current password)</b> — No special permissions are required.</li>
                                                            <li value="4"><b>Set user passwords (administratively, without the current password)</b> — Requires permissions to set passwords for users.</li>
                                                            <li value="5"><b>Create and update users, attributes, and memberships in AD with values pushed from Okta</b> — Requires permissions to read and write to the attribute(s) you&#160;are updating.</li>
                                                        </ul>
                                                        <h5>Configure delegation for the OktaService account</h5>
                                                        <p><a name="Okta_Svc_Acct_Permisions"></a>On your Windows server you need to configure delegation to Okta service account in your AD domain based on your needs. </p>
                                                        <ol>
                                                            <li value="1">On your AD Domain controller, open the <b>Active Directory Users and Computers</b> snap-in.</li>
                                                            <li value="2"> Right click the <b><a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">OU<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>An acronym of Organizational Unit. Organizational units are Active Directory containers into which you can place users, groups, computers, and other organizational units.  It is the smallest scope or unit to which you can assign Group Policy settings or delegate administrative authority.</span></a></b> or <b>domain name</b>, and select <b>Delegate Control</b> which will open the Delegation of Control Wizard. </li>
                                                            <li value="3">Add the Okta service account and select the appropriate tasks to delegate:<ul><li value="1"><p><b>Create, delete, and manage user accounts</b>&#160;— For create and update user flows.</p></li><li value="2"><p><b>Reset user passwords and force password change at next logon</b>&#160;— For syncing passwords.</p></li><li value="3"><p><b>Read all user information</b>&#160;— For import and create user flows.</p></li><li value="4"><p><b>Modify the membership of a group</b>&#160;— For Group Push.</p></li></ul></li>
                                                        </ol>
                                                    </div>
                                                </div>
                                                <div><a name="MinServReqts"></a>
                                                </div>
                                                <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Minimum Okta Service Account permission requirements</a><a name="MinServiceReqts"></a></span>
                                                    <div class="MCDropDownBody dropDownBody">
                                                        <p>Before adjusting the permissions on your directory make sure you understand how Active Directory permissions are set and  plan how to manage this within your environment.</p>
                                                        <p>By default the AD Agent installer creates a new Okta service account if you do not choose an existing account. The newly created OktaService account inherits the permissions of the Domain Users group. OktaService is also considered to be a member of Authenticated Users and Everyone special identity groups when the agent is running.</p>
                                                        <p>The Okta AD Agent Management Utility also includes the option of adding the OktaService account to the Domain Admins group. If you require functionality listed below but don't want to make your service account a full admin, make sure the following permissions are set.</p>
                                                        <p>
                                                            <h4>Provision User</h4>
                                                        </p>
                                                        <ul>
                                                            <li value="1">Requires create child permission for user objects on the target OU.</li>
                                                            <li value="2">Requires Reset Password Control Access Right permission for user objects within your target OU.</li>
                                                            <li value="3">Requires write property permissions on user objects within your target OU for the following attributes:<ul><li value="1">mail</li><li value="2">userPrincipalName</li><li value="3">SAMaccountName</li><li value="4">givenName</li><li value="5">sn</li><li value="6">userAccountControl</li><li value="7">pwdLastSet</li><li value="8">lockoutTime</li><li value="9">cn</li><li value="10">name</li></ul></li>
                                                            <li value="4">Requires write property permission on user objects within your target OU for all other attributes mapped on the AD user profile within Okta <span style="font-family: 'Courier New';">https://&lt;<a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup" style="font-family: 'Courier New';">org<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>The Okta container that represents a real-world organization.</span></a>&gt;/admin/universaldirectory</span></li>
                                                        </ul>
                                                        <p>
                                                            <h4>Update User Attributes</h4>
                                                        </p>
                                                        <ul>
                                                            <li value="1">Requires write property permissions on user objects within your target OU for the following attributes:<ul><li value="1">mail</li><li value="2">userPrincipalName</li><li value="3">SAMaccountName</li><li value="4">givenName</li><li value="5">sn</li><li value="6">userAccountControl</li><li value="7">pwdLastSet</li><li value="8">lockoutTime</li><li value="9">cn</li><li value="10">name</li></ul></li>
                                                            <li value="2">Requires write property permission on user objects within your target OU for all other attributes mapped on the AD user profile within Okta <span style="font-family: 'Courier New';">https://&lt;org&gt;/admin/universaldirectory</span></li>
                                                        </ul>
                                                        <p>
                                                            <h4>Group Push</h4>
                                                        </p>
                                                        <ul>
                                                            <li value="1">Requires create child permissions for group objects on the target OU.</li>
                                                            <li value="2">Requires delete child permissions for group objects on the target OU.</li>
                                                            <li value="3">Requires write property permissions on group objects within your target OU for the following attributes:<ul><li value="1">sAMAccountName</li><li value="2">description</li><li value="3">groupType</li><li value="4">member</li><li value="5">cn</li><li value="6">name</li></ul></li>
                                                        </ul>
                                                        <p>
                                                            <h4>Reset Password, Forgot Password , and Sync Password</h4>
                                                        </p>
                                                        <ul>
                                                            <li value="1">Requires write property permissions on user objects within your target OU for the following attributes:<ul><li value="1">lockoutTime</li><li value="2">pwdLastSet</li></ul></li>
                                                            <li value="2">Requires Reset Password Control Access Right permission for user objects within your target OU.</li>
                                                        </ul>
                                                        <p>
                                                            <h4>Activate and Deactivate User</h4>
                                                        </p>
                                                        <ul>
                                                            <li value="1">Requires write property permissions on user objects within your target OU for the following attributes:<ul><li value="1">userAccountControl</li></ul></li>
                                                        </ul>
                                                        <p>
                                                            <h4>Reference commands:</h4>
                                                        </p>
                                                        <p>You can add the permissions listed here using the commands below. Save them to a batch file and change the target OU and service account info to be correct for your environment. Remember to remove permissions you do not need and add any attributes you have mapped for provisioning within Okta. You can get the complete list of user attributes from your Directory user profile on <span style="font-family: 'Courier New'; font-size: 11pt;">https://&lt;org&gt;/admin/universaldirectory</span>.</p>
                                                        <blockquote>
                                                            <p style="font-family: 'Courier New';font-size: 11pt;"># Create User</p>
                                                        </blockquote>
                                                        <blockquote>
                                                            <p style="font-family: 'Courier New';font-size: 11pt;">dsacls "OU=targetOU,DC=domain" /G domain\agentserviceaccount:CC;user</p>
                                                            <p style="font-family: 'Courier New';font-size: 11pt;"># Create or Update user</p>
                                                            <p style="font-family: 'Courier New';font-size: 11pt;"># include additional attributes that are mapped in your org within Okta</p>
                                                            <p style="font-family: 'Courier New';font-size: 11pt;">dsacls "OU=targetOU,DC=domain" /I:S /G domain\agentserviceaccount:WP;mail;user</p>
                                                            <p style="font-family: 'Courier New';font-size: 11pt;">dsacls "OU=targetOU,DC=domain" /I:S /G domain\agentserviceaccount:WP;userPrincipalName;user</p>
                                                            <p style="font-family: 'Courier New';font-size: 11pt;">dsacls "OU=targetOU,DC=domain" /I:S /G domain\agentserviceaccount:WP;sAMAccountName;user</p>
                                                            <p style="font-family: 'Courier New';font-size: 11pt;">dsacls "OU=targetOU,DC=domain" /I:S /G domain\agentserviceaccount:WP;givenName;user</p>
                                                            <p style="font-family: 'Courier New';font-size: 11pt;">dsacls "OU=targetOU,DC=domain" /I:S /G domain\agentserviceaccount:WP;sn;user</p>
                                                            <p style="font-family: 'Courier New';font-size: 11pt;">dsacls "OU=targetOU,DC=domain" /I:S /G domain\agentserviceaccount:WP;userAccountControl;user</p>
                                                            <p style="font-family: 'Courier New';font-size: 11pt;">dsacls "OU=targetOU,DC=domain" /I:S /G domain\agentserviceaccount:WP;pwdLastSet;user</p>
                                                            <p style="font-family: 'Courier New';font-size: 11pt;">dsacls "OU=targetOU,DC=domain" /I:S /G domain\agentserviceaccount:WP;lockoutTime;user</p>
                                                            <p style="font-family: 'Courier New';font-size: 11pt;">dsacls "OU=targetOU,DC=domain" /I:S /G domain\agentserviceaccount:WP;cn;user</p>
                                                            <p style="font-family: 'Courier New';font-size: 11pt;">dsacls "OU=targetOU,DC=domain" /I:S /G domain\agentserviceaccount:WP;name;user</p>
                                                            <p style="font-family: 'Courier New';font-size: 11pt;"># Create user/Password Reset</p>
                                                            <p style="font-family: 'Courier New';font-size: 11pt;">dsacls "OU=targetOU,DC=domain" /I:S /G "domain\agentserviceaccount:CA;Reset Password;user"</p>
                                                            <p style="font-family: 'Courier New';font-size: 11pt;">#Group Push</p>
                                                            <p style="font-family: 'Courier New';font-size: 11pt;">dsacls "OU=targetOU,DC=domain" /G domain\agentserviceaccount:CCDC;group</p>
                                                            <p style="font-family: 'Courier New';font-size: 11pt;">dsacls "OU=targetOU,DC=domain" /I:S /G domain\agentserviceaccount:WP;sAMAccountName;group</p>
                                                            <p style="font-family: 'Courier New';font-size: 11pt;">dsacls "OU=targetOU,DC=domain" /I:S /G domain\agentserviceaccount:WP;description;group</p>
                                                            <p style="font-family: 'Courier New';font-size: 11pt;">dsacls "OU=targetOU,DC=domain" /I:S /G domain\agentserviceaccount:WP;groupType;group</p>
                                                            <p style="font-family: 'Courier New';font-size: 11pt;">dsacls "OU=targetOU,DC=domain" /I:S /G domain\agentserviceaccount:WP;member;group</p>
                                                            <p style="font-family: 'Courier New';font-size: 11pt;">dsacls "OU=targetOU,DC=domain" /I:S /G domain\agentserviceaccount:WP;cn;group</p>
                                                            <p style="font-family: 'Courier New';font-size: 11pt;">dsacls "OU=targetOU,DC=domain" /I:S /G domain\agentserviceaccount:WP;name;group</p>
                                                        </blockquote>
                                                        <p>
                                                            <h4>Additional Reference information</h4>
                                                        </p>
                                                        <p>You may find these additional references helpful in setting permissions:</p>
                                                        <ul>
                                                            <li value="1"><b>Delegating Authority in Active Directory:</b><a href="https://technet.microsoft.com/en-us/library/2007.02.activedirectory.aspx">https://technet.microsoft.com/en-us/library/2007.02.activedirectory.aspx</a>
                                                            </li>
                                                            <li value="2"><b>Domain Users group:</b><a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/dn579255(v=ws.11)">https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/dn579255(v=ws.11)</a>
                                                            </li>
                                                            <li value="3"><b>Special Identity groups</b>: <a href="https://technet.microsoft.com/en-us/library/dn617202(v=ws.11).aspx#BKMK_AuthenticatedUser">https://technet.microsoft.com/en-us/library/dn617202(v=ws.11).aspx#BKMK_AuthenticatedUser</a></li>
                                                            <li value="4"><b>DSACLS:</b><a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/cc771151(v=ws.11)">https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/cc771151(v=ws.11)</a>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <p>&#160;</p>
                                                <hr width="100%" size="0" align="center" />
                                                <h2>Procedure</h2>
                                                <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" /></a><a name="Installi"></a><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_">STEP 1: Install the Active Directory agent on the host server</a></span>
                                                    <div class="MCDropDownBody dropDownBody">
                                                        <div>
                                                            <p><b>Important:</b> To ensure that you have up-to-date&#160;functionality and get optimum performance from your Okta AD agent(s), we strongly recommend that you download and install the <a href="../Settings/Version_Histories/Ver_History_AD_Agent.htm">latest version</a> of the agent&#160;on your designated host server(s). If you are running multiple Okta AD agents, make sure that all of them are the same version. <i style="font-weight: bold;">Running different versions within a domain can cause all agents in that domain to function at the level of the oldest agent</i>. This does not affect other domains. </p>
                                                            <p><b>Note</b>:&#160;If you want to download the agent from another computer, you will need to copy the AD Agent installer to the host server.</p>
                                                            <p>To install the AD agent:</p>
                                                            <ol>
                                                                <li value="1">On the host server, sign in to Okta with your Okta admin account that has a minimum role of <b>Super Admin</b> and click <b>Admin</b> to access the Admin dashboard.</li>
                                                                <li value="2">Select&#160;<b>Directory &gt; Directory Integrations</b>.<ol style="list-style-type: lower-alpha;"><li value="1">Click <b>Add Directory</b> and then select <b>Add Active Directory</b>.</li><li value="2">Click&#160;<b>Set Up Active Directory</b>.&#160;</li><li value="3">Click&#160;<b>Download Agent</b>.<br /></li></ol></li>
                                                                <li value="3">On the host server locate the downloaded file and double click the file to launch&#160;the installer.<ol style="list-style-type: lower-alpha;"><li value="1">Click <b>Yes</b> at the message <b>Do you want to allow the following program to make changes to this computer?</b>.</li><li value="2">Choose an installation destination. Click <b>Next</b>.</li><li value="3">Select the AD domain you want to manage with this agent. Click <b>Next</b>.</li><li value="4">Select a domain user for the Okta AD&#160;agent to run as and click <b>Next</b>:<ul><li value="1">Select&#160;<b>Create or use the Okta Service account (recommended)</b>&#160;and complete the prompt to set a password.
Okta recommends using a complex password for security. </li><li value="2">Select&#160;<b>Use an alternate account that I specify</b>&#160;if you want to assign the Okta AD Agent to run as an existing domain user.                </li></ul></li><li value="5"><b>Optional</b> — If appropriate for your environment, specify a proxy server through which your AD agent will connect. Click <b>Next</b>.<br /><b>Note</b>:&#160;If you are installing an AD agent version 3.4.11 or later, in environments where internet traffic is required to go through a proxy, the sign-in flow for the AD agent installer uses the proxy settings specified within the installer. If no proxy settings are specified, the machine defaults are used.<br /></li><li value="6"> To register the AD Agent with the Okta service, enter your Okta subdomain name. This is the &lt;<i>mycompany</i>&gt;&#160;part of the example:&#160;&lt;<i>mycompany</i>&gt;.okta.com. Click <b>Next</b>.</li><li value="7"> On the <b>Okta Sign In</b> page, enter your admin username and password, and then click&#160;<b>Sign in</b>.</li><li value="8">The Okta AD agent requires several permissions. Click&#160;<b>Allow Access</b>.
The agent installation completes.				<p><b>Note:</b> If the error message displays <i>The underlying connection was closed. Could not establish trust relationship for the SSL/TLS service channel</i>,&#160;see <a href="#TROUBLES">Troubleshooting</a>.</p></li><li value="9">Click <b>Finish</b>.</li></ol></li>
                                                                <li value="4">When the Active Directory agent has started, return to the browser and click <b>Next</b>. On the following screens you will select some basic configuration options. You can change these and other settings at a later time.<ol style="list-style-type: lower-alpha;" data-mc-continue="true"><li value="1"><b>(First time installations for this domain only)</b>&#160;At the <b>Connect an Organization Unit to Okta</b> screen, select the OUs from which you&#160;want to import users and groups. </li><li value="2">Select the&#160;<b>Okta Username format</b> that you want AD-imported&#160;<a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">end users<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>In Okta literature, we generally refer to "end users" as the people who have their own Okta home page (My Applications), using apps to authenticate into all of their apps. End users do not have any administrative control. When we refer to "users" we are generally referring to the individual(s) who have administrative control.</span></a> to use when logging in to&#160;Okta and then click <b>Next</b>.<br />Choose from:<ul data-mc-continue="true"><li value="1">Email address</li><li value="2">SAM&#160;Account Name</li><li value="3">User Principal Name (UPN)</li></ul><p><b>Important</b>:&#160;It is critical that the username format selected here be the correct format when you first import users. Changing the value can cause errors for existing users. </p></li><li value="3">On the <b>Import AD&#160;Users and Group</b> dialog, click <b>Next</b>.</li></ol><p><b>Note</b>:&#160;To reconfigure OU and&#160;import settings, as well as other settings, return to the&#160;<b>Settings</b> tab (<b>Directory &gt; Directory Integrations&#160;&gt;&#160;Active Directory &gt; Settings</b>). For details, see <a href="#ADimportprov">Configure import and account settings</a>.</p></li>
                                                                <li value="5">
                                                                    <p>On the <b>Build User Profile</b> tab, select the attributes that you want to use to build your Okta user profiles. You can modify these attributes at a later time if you want to accept the defaults at this time. Click <b>Next</b>. <p>To learn more about how Okta uses profiles and attributes, see <a href="directory-UD-profile-editor-con.htm" class="MCXref xref">About Universal Directory and user profiles</a> and <a href="directory-AD-attribute-mapping.htm" class="MCXref xref">Work with Active Directory user profiles and attributes</a></p></p>
                                                                </li>
                                                                <li value="6"> Click <b>Done</b>. Agent setup is complete. Your AD domain is now integrated with Okta. You are taken to the Settings tab where you can configure your import and provisioning settings as described in <a href="#ADimportprov" class="MCXref xref">STEP 2: Configure import and account settings</a></li>
                                                            </ol>
                                                            <p>If you installed the <span class="okta-feature-namesAD agent short">Okta AD agent</span> on a DMZ server, you must open specific ports. For details, see <a href="ad-agent-install-dmzports.htm" class="MCXref xref">Active Directory integration:&#160;DMZ server ports</a></p>
                                                        </div>
                                                        <p><b>Note</b>:&#160;If you have enabled the <a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ #text">Early Access<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>Early Access (EA) features are opt-in features that you can try out in your org by asking Okta Support to enable them. Additionally, the Features page in the Okta Admin Console (Settings &amp;gt; Features) allows Super Admins to enable and disable some EA features themselves.</span></a> feature for the new AD import and provisioning user interface, continue your configuration by following the steps in&#160;<a href="ad-agent-install-new.htm" class="MCXref xref">Configure the Okta Active Directory (AD) agent: new user interface</a></p>
                                                    </div>
                                                </div>
                                                <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" /></a><a name="ADimportprov"></a><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_">STEP 2: Configure import and account settings</a></span>
                                                    <div class="MCDropDownBody dropDownBody">
                                                        <div>
                                                            <p>After the AD agent is installed, you are taken to the <b>Settings</b> page for the AD app to make  initial configuration choices. You can come back to the <b>Settings</b> page at any time to update your configuration choices by navigating to  <b>Directory &gt; Directory Integration &gt; Active Directory &gt;&#160;Settings</b>. </p>
                                                            <p>This involves making decisions about:</p>
                                                            <ul>
                                                                <li value="1"><b>Import settings</b> — To add users and groups from a designated Active Directory domain into Okta. This includes which user and group OUs to import from, whether to use Just-in-Time (JIT) provisioning to import users into Okta, how often to schedule imports from AD to Okta, and whether to send activation emails to new end users.<br /></li>
                                                                <div style="width: 100%;padding-left: 8px;padding-right: 8px;padding-top: 4px;padding-bottom: 6px;border-left-style: solid;border-left-width: 1px;border-right-style: solid;border-right-width: 1px;border-top-style: solid;border-top-width: 1px;border-bottom-style: solid;border-bottom-width: 1px;">
                                                                    <p><b>User name format notes:</b>
                                                                    </p>
                                                                    <ul>
                                                                        <li value="1">During import Okta presents you with options for the username format. This value is used to associate the user in AD&#160;to Okta, therefore it's important to choose the correct value as this affects how your users sign in to Okta. By default Okta uses the Okta user profile username during delegated authentication. For example, if the AD app-user username is <i>samAccountName</i> and the Okta user profile username (login field) is <i>UPN</i>, then Okta will use <i>UPN</i> to log in the user. </li>
                                                                        <p> You can keep it consistent with device sign-in by standardizing on the format  your users use to sign into their devices.</p>
                                                                        <li value="2">If you are on AD domain functional level of 2003, your AD usernames must in the domain name format. Users must have a UPN that contains a <b>domain.name</b> format.      </li>
                                                                    </ul>
                                                                </div>
                                                                <li value="2"><b>Automatic matching of AD to Okta user accounts</b> — To establish matching criteria (or rules)  to specify how an imported user should be mapped to an existing Okta user. Clearly defining rules for matching helps to prevent multiple instances for the same user from being created.</li>
                                                                <li value="3"><b><a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">Provisioning<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>Provisioning is the enterprise-wide configuration, deployment, and management of multiple types of IT system resources. Specifically, provisioning provides users access to equipment, software, or services. This involves creating, maintaining and deactivating required business process automation objects and attributes in systems, directories, and applications.</span></a></b>  &#160;—  To create users in Okta or assign users to apps. For an overview of how provisioning works in Okta, see <a href="../Apps/Provisioning_Deprovisioning_Overview.htm" class="MCXref xref">Provisioning and Deprovisioning </a>.</li>
                                                            </ul>
                                                            <p>To configure import and account settings:</p>
                                                            <ol>
                                                                <li value="1">If you are not on the <b>Settings</b> page, navigate to <b>Directory &gt; Directory Integration &gt; Active Directory &gt;&#160;Settings</b>.</li>
                                                                <li value="2">Scroll to <b>Delegated <a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">Authentication<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>Authentication is distinct from authorization, which is the process of giving individuals access to system objects based on their identity. Authentication merely ensures that the individual is who he or she claims to be, but says nothing about the access rights of the individual.

Authentication methods and protocols include direct auth, delegated auth, SAML, SWA, WS-Fed, and OpenID Connect.</span></a></b>. 
							<ol style="list-style-type: lower-alpha;"><li value="1">Enable delegated authentication if you want Active Directory to authenticate your users when they sign in to Okta. A user's Okta credentials are the same as their Active Directory credentials when delegated authentication is on. 
									<p><a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ #text">Instance<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>An instance, or computer instance, is a virtual machine (VM) or individual physical computer, used to host a software appliance.</span></a>-level Del Auth is optimized for use in environments with multiple AD instances. It allows admins to delegate authentication on a per AD-instance level to support more granular authentication scenarios such as the following:
									<ul><li value="1">Configure Okta to be the authentication master for users in some AD instances.</li><li value="2">Configure AD to be the authentication master for users in the remaining AD instances (meaning users sign-in using their Windows credentials).</li><li value="3">Continue to rely on Okta to provision to all AD instances</li></ul></p><li value="2">Click <b>Save Settings</b>.</li></li></ol></li>
                                                                <li value="3">Scroll to the <b>Import and Provisioning &gt;&#160;Import and Account Settings</b> section and make selections from the following options:
						<ol style="list-style-type: lower-alpha;"><li value="1"><b>User OUs connected to Okta</b> &#160;— The agent can only access the OUs you select to import end users. If you need to modify the OU selection made during the agent install, make the changes here.</li><li value="2"><b>Group OUs connected to Okta</b> &#160;— The agent can only access the OUs you select to import groups. If you need to modify the OU selection made during the agent install, make the changes here.</li><li value="3"><p class="earlyaccess">This is an Early Access feature. To enable it, please contact <a href="https://support.okta.com/">Okta Support</a>.</p><p><i>Optional</i> &#160;—  Define <b>user and group filters</b>  to perform granular imports from Active Directory. Create <a href="https://docs.microsoft.com/en-us/windows/desktop/adsi/search-filter-syntax">syntax queries</a> to selectively import users matching the criteria that you specify.</p><p><b>Caution:</b> Changing the default filter queries can result in deprovisioning users. To avoid unintended results, Okta strongly recommends that you test these filters in your directory environment to make sure that the results match your expectations. </p><p>Default queries:</p><ul><li value="1"><b>User filter</b> – <span style="font-family: 'Courier New';">sAMAccountType=805306368</span></li><li value="2"><b>Group filter</b> – <span style="font-family: 'Courier New';">objectCategory=group</span></li></ul><div class="note_cautionOkta"><img src="../../Resources/Images/assets/Icons/Notes/Alert.png" class="noteImgFloat" title="Info" alt="Info" /><p class="noteHeading">Caution</p><p class="noteContent">Back-linked attributes, such as memberOf are computed attributes and are not actually stored in your Active Directory database. As a result, Okta will not see changes to the user object and perform an import operation when these changes occur. It is recommended not to use computed attributes as mapped attributes into Okta, especially if you require changes in downstream systems as a result of a change in the attribute. This may lead to inconsistent data between your on-premises Active Directory and Universal Directory. More information is available from <a href="https://msdn.microsoft.com/en-us/library/cc223384.aspx">https://msdn.microsoft.com/en-us/library/cc223384.aspx</a></p></div></li><li value="4"><b>JIT&#160;Provisioning</b>  &#160;—  Just In Time (JIT) provisioning enables automatic user account creation in Okta the first time a user authenticates with AD Delegated Authentication, as well as updates to existing user profiles.<p>The security groups to which the user&#160;belongs are also imported if the group belongs to a selected OU. If a user signing in does not belong to a selected OU, the sign in fails. If you enable JIT, Delegated Authentication must also be enabled.This option can be used with or without scheduled imports. For details about JIT and AD domain scenarios, see <a href="Directory_FAQ_Okta_and_AD_Groups.htm" class="MCXref xref">FAQ: Okta and AD Groups</a>.</p><p><b>Note</b>:&#160;There are membership&#160;inconsistencies that can occur between “regular” imports and JIT provisioning. These membership&#160;anomalies&#160;may occur when using nested groups.
During regular imports, a child group that is outside the <a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">scope<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>A scope is an indication by the client that it wants to access some resource.</span></a> of an AD OU or <a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">LDAP<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>Lightweight Directory Access Protocol (LDAP) is a lightweight client-server protocol for accessing directory services, specifically X.500-based directory services. LDAP runs over TCP/IP or other connection oriented transfer services.</span></a> object filter cannot be detected. If a parent group is within an OU/object filter scope but its child groups are not, the parent group membership is incorrectly resolved during import. JIT provisioning would correctly resolve these memberships to the parent group because its function only detects "flat" memberships.&#160;</p></li><li value="5"><b>Schedule Import</b>   &#160;— Determine how often you want Okta to import users from AD. 
									<p>Select <b>Do not import new users</b>&#160;to leverage scheduled imports to keep user profiles and groups in sync without importing new users from your directory. Use it when you only want to  create new users in Okta via&#160;JIT, not via imports, yet continue to use imports to sync groups.</p><p class="note"><b>Note:</b> Following a successful import, under specific conditions Okta automatically&#160;sends an email to designated administrators. The email&#160;details the number of users and groups scanned, added, updated, or removed during the import. Okta only sends the email if the scan detects&#160;any new users or groups, or changes to any existing user profile or group membership.</p></li><li value="6"><p class="earlyaccess">This is an Early Access feature. To enable it, please contact <a href="https://support.okta.com/">Okta Support</a>.</p><div><b>Note:</b>&#160;Orgs created after October 19th (Preview) or October 25th, 2017 (Production)&#160;may see slightly different import and provisioning options in the user interface elements described below. These changes will be rolled out to orgs created before these dates at a later date, which will be announced in the Release Notes. For details about the import and provisioning changes, see <a href="Okta_Active_Directory_Agent_UDMappingchanges.htm">AD Updated Profile Mapping options</a>.</div><b>Okta username format</b>    &#160;— Choose from one of the following options:
								<br /><b>Important</b>:&#160;It is critical that the username format selected here be the correct format when you first import users. Changing the value can cause errors for existing users. 
								<ul><li value="1"><b>Email address</b>     &#160;— End users will sign in with their email addresses as their Okta username.</li><li value="2"><b>SAM&#160;Account name</b>     &#160;— Okta combines the <b>SAM Account Name</b> with the AD domain to generate the Okta username. For example, if the SAM Account Name is&#160;<b>jdoe</b>&#160;and the AD domain is&#160;<b>mycompany.okta.com</b>, then the Okta username is&#160;<b>jdoe@mycompany.okta.com</b>.</li><li value="3"><b>SAM Account name +&#160;Configurable Suffix</b>     &#160;— When using this option, do not include the @ character before the Configurable Domain. </li><li value="4"><b>User Principal Name (UPN)</b>     &#160;— Use the UPN from AD.</li><li value="5"><b>Custom</b>     &#160;— If you wish to use a custom username to sign in to Okta, use the <b>Custom</b> option and the Okta Expression language to map the Okta&#160;username format. You can preview your changes to validate your mapping expression. Enter the name of a user to preview the mapping.<a href="javascript:void(0);" class="MCToggler MCTogglerHead MCTogglerHotSpot MCToggler_Open toggler MCTogglerHotSpot_ MCHotSpotImage" data-mc-targets="usernameSettingsnew"><img class="MCToggler_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Screenshot</a><img src="../../Resources/Images/AD_UDmapping_settingspg_import_new.png" style="display: none;" data-mc-target-name="usernameSettingsnew" /></li></ul><p><b>Note:</b>&#160;All Okta users can sign in by entering the alias part of their user names as long as it maps to a single user in your organization. For example,&#160;<b>jdoe@mycompany.okta.com</b>&#160;could sign in using&#160;<b>jdoe</b>.<br /></p></li><li value="7"><b>Activation emails</b>     &#160;— Check this option to prevent Okta from sending activation email to new users. Admins can activate users.<p><b>Tip</b>:&#160;We recommend that you select <i>not</i> to send activation emails while you are doing the initial AD integration and configuration in your Preview environment. This prevents end users from receiving activation emails before you are ready for them to begin enrolling in and using Okta.</p></li><li value="8"><b>USG&#160;support</b>      &#160;— Enable this to ignore domain boundaries when importing&#160;group memberships for your end users. This assumes that the relevant&#160;domains are connected in Okta.
You must also deploy an AD agent for every domain in your forest&#160;that contains the USG&#160;object that you want to sync with Okta. Each connected&#160;domain then imports its groups. When a user’s group memberships match any groups that were imported (from any connected domain in the forest), Okta syncs the memberships for the user to each group.&#160; Only groups from connected domains are imported. This setting requires JIT provisioning.           </li><li value="9"><b>Max Import Unassignment</b>       &#160;— Accept the default 20% or choose a custom per cent. Halts any import which exceeds this number of app unassignments. This action prevents accidental loss of user accounts. This setting affects all apps with imports enabled. For details, see <a href="eu-import-safeguard.htm" class="MCXref xref">Import safeguard</a>.</li></ol></li>
                                                                <li value="4"><a name="Matching"></a>In the <b>Match Settings</b> section, select the conditions under which imported users will be identified as matching existing Okta users.<p>Matching rules are used in the import of users from all apps and directories that allow importing.  If there is an existing Okta account, AD allows you to import and confirm users automatically. Active Directory, OPP, and all provisioning-enabled apps support automatic importation and confirmation of users into Okta. &#160;Establishing matching criteria (or rules)&#160;allows you to specify how an imported user should be mapped to an existing Okta user. Clearly defining rules for matching helps to prevent&#160;multiple instances for the same user from being created.</p><p><b class="note">Note:</b> This feature does not apply to CSV-imported user lists.</p><ol style="list-style-type: lower-alpha;"><li value="1"><b>Imported user is an exact match to an Okta user if</b>:<ul><li value="1">Okta username format matches</li><li value="2">Email matches</li><li value="3">The following attributes match        &#160;— Select from the list of options.</li></ul><p>Choose any combination from the list of options to establish your criteria. For the new imported user to be considered an exact match, each option that you select must be true.</p></li><li value="2"><b>Allow partial matches</b>        &#160;—  Partial matching means that the first and last name of an imported user matches that of an existing Okta user, but the user’s username or email address do not. Choosing this option legitimizes this scenario. </li></ol></li>
                                                                <li value="5"><a name="Confirmation"></a>In the <b>Confirmation Settings</b> section, select the automatic confirmation option that matches the policies of your organization. If you do not select an auto-match option, all user imports must be confirmed manually.<ul><li value="1"><p><b>Matched users</b>         &#160;—  Check  to  automatically confirm exact or partial matches. Leaving them unchecked requires that matches are confirmed manually; once the matching status is established. If manually confirmed, users are activated on the <b>People</b> page (<b>Directory &gt; People</b>).</p></li><li value="2"><b>New users</b>         &#160;—  Check these boxes to specify that&#160;once the matching status signifying a new user is established, they are confirmed or activated automatically. Leaving them unchecked requires that new users are confirmed or activated manually on the <b>People</b> page (<b>Directory</b> &gt; <b>People</b>).</li></ul></li>
                                                                <li value="6">Scroll to the bottom of the page and click <b>Save Settings</b>.</li>
                                                            </ol>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" /></a><a name="Provisioning"></a><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_">STEP 3: Configure  Provisioning settings</a></span>
                                                    <div class="MCDropDownBody dropDownBody">
                                                        <div>
                                                            <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" /></a><a name="CreateUser"></a><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_">Allow Okta to create users in Active Directory — Used if Okta is the profile master or will be pushing user updates to AD from another app such as Workday.</a></span>
                                                                <div class="MCDropDownBody dropDownBody">
                                                                    <p>The <b>Settings&#160;&gt;&#160;Create User</b> section  gives Okta the ability to create users in AD. This allows you, for example, to import users from an HR system, create the users in Okta, and then have Okta create the users in AD. The HR system is the master, with Okta and AD being updated based on changes in the HR master. Or, another use case may include Okta being the source of truth for all user information and pushing those updates into AD.</p>
                                                                    <p>To implement this functionality, you first need to create a group in Okta and then assign that group to your AD instance. When users are added to the group, they are also created in AD. A common scenario is to use group rules in this kind of flow to add users to the AD provisioning group automatically.</p>
                                                                    <p>To configure Okta to create users in AD:</p>
                                                                    <ol>
                                                                        <li value="1">If you are not on the <b>Settings</b> page, navigate to <b>Directory &gt; Directory Integration &gt; Active Directory &gt;&#160;Settings</b>.</li>
                                                                        <li value="2">Scroll to the <b>Provisioning Features &gt;&#160;Create Users</b> section.</li>
                                                                        <li value="3">Click <b>Enable</b>.</li>
                                                                        <li value="4">For <b>Activation email recipient</b>, enter the email address of the Okta admin who should receive the activation email with the Okta end user's password. The admin is responsible for giving the end user their Okta password.</li>
                                                                        <li value="5">Select the <b>AD username format</b>. This is the format in which AD expects to Okta to create the username in AD. The <b>Custom</b> option allows you to format the AD username using a custom expression language. For details, see <a href="About_Universal_Directory.htm#Expressions" class="MCXref xref">Using Expressions (Transformations)</a>.</li>
                                                                        <li value="6"><b>AD common name format</b>&#160;–&#160;Specify a default AD common name format. </li>
                                                                        <li value="7">
                                                                            <p><b>Exclude AD username update</b>&#160;–&#160;If you select this option, Okta does not update the user names of existing AD accounts that are Okta mastered when you change the default username format. You can still provision new AD accounts from Okta.</p>
                                                                        </li>
                                                                        <li value="8">
                                                                            <p>Scroll to the bottom of the page and click <b>Save Settings</b>.</p>
                                                                        </li>
                                                                    </ol>
                                                                </div>
                                                            </div>
                                                            <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" /></a><a name="UpdateUserattributes"></a><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_">Update User Attributes — If Okta is the master, changes to the Okta user profile are pushed down to AD.</a></span>
                                                                <div class="MCDropDownBody dropDownBody">
                                                                    <p>Enable this to allow Okta to update user attributes in Active Directory when the app is assigned. Future attribute changes made to the Okta user profile automatically overwrite the corresponding attribute value in Active Directory. For details, see <a href="AD_Move_user_across_OU.htm" class="MCXref xref">Enable Okta-mastered user OU changes</a>.</p>
                                                                    <p class="earlyaccess">This is an Early Access feature. To enable it, please contact <a href="https://support.okta.com/">Okta Support</a>.</p>
                                                                    <p><b>Update OU</b>:&#160;Select this option to update an Okta-mastered user's OU when the group that provisions a user to AD changes. </p>
                                                                    <p><b>Note</b>:&#160;If an Okta-mastered user's OU changes in AD, that change will not be reflected in Okta since Okta is the master for that user. The next time the user is update in Okta, they will be provisioned back to the OU as set in Okta.</p>
                                                                    <p><b>Warning</b>:When Profile Push is enabled, Okta will update the CN attribute in AD. If there is a mapping defined for the cn property in the Profile Editor that mapping is applied. If there is no mapping or if the behavior for the CN mapping is set to <b>Do not map</b> then the CN is set to <span style="font-family: 'Courier New';">First Name + " " +&#160;Last Name</span>.</p>
                                                                </div>
                                                            </div>
                                                            <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" /></a><a name="Deprovision"></a><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_">Deprovision users in AD automatically — Deactivate user accounts in AD if the user is unassigned or deactivated in Okta.</a></span>
                                                                <div class="MCDropDownBody dropDownBody">
                                                                    <p>This setting is used when Okta is the source of truth for user profiles.</p>
                                                                    <p>Enable this option to deactivate users' Active Directory account when they are unassigned in Okta or their Okta account is deactivated. Accounts can be reactivated if the app is reassigned to a user in Okta.</p>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <hr width="100%" size="0" align="center" />
                                                <h2>Optional Tasks</h2>
                                                <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" /></a><a name="ProfileMaster"></a><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_">Configure Profile Master and Lifecycle settings — Makes Active Directory the source of truth for end users. (Optional)</a></span>
                                                    <div class="MCDropDownBody dropDownBody">
                                                        <p><a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">Profile mastering<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>Mastering is a more sophisticated version of read (import) users. Mastering defines the flow and maintenance of user-object attributes and their lifecycle state. When a profile is mastered from a given resource (application or directory), the Okta user profile’s attributes and lifecycle state are derived exclusively from that resource. In other words, an Okta user mastered by Active Directory (or HR system) has an Okta profile. However, the profile isn’t editable in Okta by the user or Okta admin, and derives its information exclusively from Active Directory. If the lifecycle state of the user in Active Directory moves to Disabled, the linked Okta user also switches to the corresponding lifecycle state of Deactivated on the next the read (import).</span></a> makes Active Directory the source of truth for connected users. When enabled, user profiles are not editable in Okta and changes are synced to Okta during provisioning events. Active Directory defaults as a <a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">profile master<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>A profile master is an application (usually a directory service such as Active Directory, or human capital management system such as Workday) that acts as a source of truth for user profile attributes. A user can only be mastered by a single application or directory at any one time. For more details, see the Profile Master page.

When users are mastered by attribute, we call this attribute-level mastery (ALM). ALM delivers finer grain control over how profiles are mastered by allowing admins to specify different profile masters for individual attributes. Profile mastering only applies to Okta user profiles, not app user profiles. For more details, see Attribute Level Mastering.</span></a>, you can disable this option to have AD treated as a normal application. For details about Profile Masters, see <a href="eu-profile-masters.htm" class="MCXref xref">Profile mastering</a>.</p>
                                                        <p>Enable this option if you want Active Directory to be the source of truth for all user profiles assigned to AD.</p>
                                                        <p>There are additional lifecycle settings you can set to determine what happens to the corresponding Okta user profiles when they are deactivated or reactivated in AD.</p>
                                                        <ol>
                                                            <li value="1">
                                                                <p>Go to <b>Directory &gt;&#160;Directory instance &gt;&#160;Settings</b></p>
                                                            </li>
                                                            <li value="2">
                                                                <p>Scroll to <b>Profile Master</b></p>
                                                            </li>
                                                            <li value="3">
                                                                <p>Select what should happen to the Okta user when the <b>AD user is deactivated</b>:</p>
                                                                <ul>
                                                                    <li value="1"><b>Do Nothing</b>:
 Prevents activity in the app from controlling the user life cycle. This still allows profile master control of attributes and mappings. </li>
                                                                    <li value="2"><b>Deactivate Okta user</b>: This default setting allows the user to be automatically deactivated when deactivated in the target app.</li>
                                                                    <li value="3"><b>Suspend Okta user</b>:
This setting allows the user to be automatically suspended when deactivated in the target app.</li>
                                                                </ul>
                                                            </li>
                                                            <li value="4">Select what should happen to the Okta user when the <b>AD user is reactivated</b>:<ul><li value="1"><b>Reactivate suspended users</b>:
Allows an admin to choose if a <i>suspended</i> Okta user should be reactivated when they have been reactivated in the app.

</li><li value="2"><b>Reactivate deactivated users</b>:
Allows an admin to choose if a <i>deactivated</i> Okta user should be reactivated when they have been reactivated in the app.
</li></ul></li>
                                                            <li value="5">Scroll the bottom of the page and click <b>Save Settings</b>.</li>
                                                        </ol>
                                                    </div>
                                                </div>
                                                <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" /></a><a name="SyncPassword"></a><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_">Configure Sync Password — Syncs users' AD password with their Okta password. (Optional)</a></span>
                                                    <div class="MCDropDownBody dropDownBody">
                                                        <p>Enable this option if you want&#160;each user's&#160;AD password to be&#160;synced to their <span class="okta-variablesProductName">Okta</span> password. Any subsequent password changes users&#160;make are pushed to their user profile in AD. To enable the&#160;<b>Sync Password</b> option, <b>Delegated Authentication</b> must be disabled. For more information, see <a href="../Security/Security_Using_Sync_Password.htm">Using Sync Password</a>.</p>
                                                    </div>
                                                </div>
                                                <hr width="100%" size="0" align="center" />
                                                <h2>What's next?</h2>
                                                <p>After you have installed the <span class="okta-feature-namesAD agent short">Okta AD agent</span> and completed the basic configuration steps above, your next steps are to:</p>
                                                <ul>
                                                    <li value="1"><a href="directory-AD-importusers.htm" class="MCXref xref">Import Active Directory users</a> and <a href="directory-AD-importusers.htm#Confirm" class="MCXref xref">Confirm imported user assignments</a> &#160;— Users imported from Active Directory are not activated until you confirm your import results. Once confirmed, you can send activation emails that direct your users to create their Okta account.</li>
                                                    <li value="2"><a href="directory-AD-attribute-mapping.htm" class="MCXref xref">Work with Active Directory user profiles and attributes</a> — Customize the attribute mappings between AD and Okta. </li>
                                                    <li value="3"><a href="eu-profile-editor.htm" class="MCXref xref">About Universal Directory and user profiles</a> — Edit your Okta user profile.</li>
                                                    <li value="4">&#160;Optionally, depending on your environment:<ul><li value="1"><b><a href="Configuring_Desktop_SSO.htm" class="MCXref xref">Install and configure the Okta IWA&#160;Web agent for Desktop SSO</a></b>  &#160;— Desktop SSO allows your users to be automatically signed into their Okta apps whenever they are signed into your Windows network. When users aren't on the Windows network they sign in through the normal Okta sign-in page.</li><li value="2"><a href="Configuring_Agentless_SSO.htm" class="MCXref xref">Configure Agentless Desktop SSO - new implementations</a></li><li value="3"><a href="Installing_Configuring_Active_Directory_Password_Sync_Agent.htm" class="MCXref xref">Install and Configure the Active Directory Password Sync Agent</a></li></ul></li>
                                                </ul>
                                                <hr width="100%" size="0" align="center" />
                                                <h2><a name="TROUBLES"></a>Troubleshooting</h2>
                                                <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Error when resetting a Windows password</a></span>
                                                    <div class="MCDropDownBody dropDownBody">
                                                        <p>If the following error displays when your end users try to reset their Windows password in Okta,</p>
                                                        <p><i>New Windows password: Unexpected error when changing password, please try again</i>
                                                        </p>
                                                        <p>. . . and the following description was written to <b>Reports &gt; System Log</b> at the same time,</p>
                                                        <p style="font-weight: normal;font-style: italic;">UnavailableCriticalExtension</p>
                                                        <p>. . . then&#160;you are probably not enforcing Active Directory's <b>Password History policy</b>. To enforce the policy, make sure that your&#160;Okta AD Agent is&#160;<b>version 3.4.1</b>&#160;or later and your Domain Controllers are running&#160;<b>Windows Server 2008 R2</b> or later.</p>
                                                    </div>
                                                </div>
                                                <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Error when installing the agent</a></span>
                                                    <div class="MCDropDownBody dropDownBody">
                                                        <p>During agent installation, if the error message displays,</p>
                                                        <p style="font-style: italic;">The underlying connection was closed. Could not establish trust relationship for the SSL/TLS service channel</p>
                                                        <p>. . . then you are probably attempting to install a version of the AD agent&#160;in which SSL&#160;pinning is enabled by default and your environment is one in which the agent's support for SSL certificate pinning prevents communication with the Okta server. This is most likely to occur in environments that rely on SSL proxies. To allow installation to complete in this case, Okta recommends that you <b>bypass SSL proxy processing</b> by adding the domain <i>okta.com</i> to a whitelist.</p>
                                                        <p>Alternatively, if SSL certificate pinning is enabled you can choose to disable it as described below.</p>
                                                    </div>
                                                </div>
                                                <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />To disable SSL certificate pinning if it is enabled</a></span>
                                                    <div class="MCDropDownBody dropDownBody">
                                                        <ol>
                                                            <li value="1">Perform steps 1 through 4 of the procedure <a href="#Installi" class="MCXref xref">STEP 1: Install the Active Directory agent on the host server</a>.</li>
                                                            <li value="2">Instead of double-clicking the file as directed in step 5, open a command line terminal and enter the following:</li>
                                                        </ol>
                                                        <p style="font-family: 'Courier New';">OktaADAgentSetup.exe OktaDisableSslPinning=1</p>
                                                        <ol data-mc-continue="true">
                                                            <li value="3">Press Enter.</li>
                                                            <li value="4">Complete the installation as described in Installing and Configuring the Agent.</li>
                                                        </ol>
                                                    </div>
                                                </div>
                                                <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />To re-enable support for SSL certificate pinning if it is disabled</a></span>
                                                    <div class="MCDropDownBody dropDownBody">
                                                        <ol>
                                                            <li value="1">Locate and open the AD agent configuration file:
               
							<p style="font-family: 'Courier New';">C:\Program Files (x86)\Okta\Okta AD Agent\OktaADAgentSetup.exe.config</p></li>
                                                            <li value="2">Change the SSL&#160;pinning enabled&#160;setting to True:
                
							<p style="font-family: 'Courier New';">"SslPinningEnabled" value="True"</p></li>
                                                            <li value="3">Save the configuration file and restart the agent.</li>
                                                        </ol>
                                                        <p class="bodyindent">For more information about SSL certificate pinning, see the article by the <a href="https://www.owasp.org/index.php/Certificate_and_Public_Key_Pinning">Open Web Application Security Project</a>.</p>
                                                    </div>
                                                </div>
                                                <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" /> The AD agent does </a><a name="TLS12"></a><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_">not connect after startup
                </a></span>
                                                    <div class="MCDropDownBody dropDownBody">
                                                        <p>If the AD Agent does not connect after startup and the agent logs contain an exception:</p>
                                                        <p><i>The <a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">client<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>Essentially, a client is anything that talks to the Okta service. Within the traditional client-server model, Okta is the server. The client might be an agent, an Okta mobile app, or a browser plugin. </span></a> and server cannot communicate, because they do not possess a common algorithm</i>
                                                        </p>
                                                        <p>Make sure that TLS 1.2 is enabled on your OS. For Windows 2008 R2 TLS 1.2 is disabled by default and needs to be enabled through the registry. Ensure the following regkeys are set correctly:</p>
                                                        <p style="font-family: 'Courier New';">[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.2\Server] "<span style="color: #ff0000;">Enabled</span>"=dword:00000001</p>
                                                        <p><span style="font-family: 'Courier New';">[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.2\Server] <span style="color: #ff0000;">"DisabledByDefault</span>"=dword:00000000</span>
                                                        </p>
                                                        <p style="font-family: 'Courier New';">[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.2\Client] "<span style="color: #ff0000;">Enabled</span>"=dword:00000001</p>
                                                        <p><span style="font-family: 'Courier New';">[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.2\Client] "<span style="color: #ff0000;">DisabledByDefault</span>"=dword:00000000</span>
                                                        </p>
                                                    </div>
                                                </div>
                                                <!-- Back to Top button --><a href="#" class="sf-back-to-top"><span class="arrow"></span>Top</a>
                                            </div>
                                        </div>
                                        <!-- *** Col3: Right menu Col *** -->
                                        <div class="is-not-in-mobile">
                                            <div data-sticky-container="" id="zGmth8nAtUitmV2mttxrSg">
                                                <div class="sticky sticky-menu" style="width:100%" data-sticky="" data-top-anchor="zGmth8nAtUitmV2mttxrSg:top" data-bottom-anchor="contentBody:bottom" data-sticky-on="small" data-scroll-container-on="small">
                                                    <ul class="nocontent menu _Skins_okta_right_menu mc-component" data-mc-is-context-sensitive="True" data-mc-linked-toc="Data/Tocs/okta_TOC.js" data-mc-side-menu="True" data-mc-max-depth="1" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="False" data-mc-include-parent="True" data-mc-toc="True">
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- ***************************** Footer rows ********************************* -->
                                    <div class="footer-temp">
                                        <div class="is-not-in-mobile">
                                            <p> </p>
                                        </div>
                                        <div>
                                            <p class="copyright">©  <span class="okta-variablesYear">2019</span> <span class="okta-variablesCompanyName">Okta, Inc</span> All Rights Reserved. Various trademarks held by their respective owners.</p>
                                        </div>
                                    </div>
                                    <!-- ***************************** Scripts ************************************* -->
                                    <!-- Foundation -->
                                    <script src="../../Resources/Scripts/js/app.js">
                                    </script>
                                    <script src="../../Resources/Scripts/js/vendor/what-input.js">
                                    </script>
                                    <script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/6.4.4-rc1/js/foundation.min.js">
                                    </script>
                                    <!-- Ours -->
                                    <script type="text/javascript" src="../../Resources/Scripts/back-to-top.js">
                                    </script>
                                    <script type="text/javascript" src="../../Resources/Scripts/get-feedback.js">
                                    </script>
                                    <!-- Coveo -->
                                    <script src="https://static.cloud.coveo.com/searchui/v2.5395/js/CoveoJsSearch.Lazy.min.js">
                                    </script>
                                    <script src="../../Resources/Scripts/coveo-resources/js/cultures/en.js" id="coveoCultureScript">
                                    </script>
                                    <script src="../../Resources/Scripts/coveo-resources/js/Coveo.MadcapFlare.RequireJS.js" id="coveoRequireScript">
                                    </script>
                                    <script src="../../Resources/Scripts/coveo-resources/js/Coveo.MadcapFlare.Okta.js" id="coveoInitscript">
                                    </script>
                                </div>
                            </div>
                        </div>
                    </section><a data-close="true"></a>
                </div>
            </div>
            <script>/* <![CDATA[ */$(document).foundation();/* ]]> */</script>
        </div>
    </body>
</html>